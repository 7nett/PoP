!function(t){popCDN={localStorageKey:"PoP:cdn-thumbprints",thumbprintValues:{},documentInitialized:function(){var e=this,r=popManager.getTopLevelFeedback()[M.CDN_THUMBPRINTVALUES];e.thumbprintValues=popManager.getStoredData(e.localStorageKey,!1),e.thumbprintValues?e.updateThumbprintValues(r):(e.thumbprintValues=t.extend({},r),e.storeData())},pageSectionFetchSuccess:function(t){var e=this,r=t.response;e.fetchSuccess(r)},blockFetchSuccess:function(t){var e=this,r=t.response;e.fetchSuccess(r)},modifyFetchArgs:function(t){var e=this,r=t.options,a=t.url;if(e.useCDN(a)){t.url=e.getCDNUrl(a);var n=e.getThumbprintValue(a);n&&(r.params=r.params||{},r.params[M.CDN_URLPARAM_THUMBPRINT]=n)}},modifyFetchBlockArgs:function(t){var e=this,r=t.options,a=t.url,n=t.type;if("GET"==n&&e.useCDN(a)){t.url=e.getCDNUrl(a);var o=e.getThumbprintValue(a);o&&(r["onetime-post-data"]=r["onetime-post-data"]?r["onetime-post-data"]+"&":"",r["onetime-post-data"]+=M.CDN_URLPARAM_THUMBPRINT+"="+o)}},fetchSuccess:function(t){var e=this;e.updateThumbprintValues(t.feedback.toplevel[M.CDN_THUMBPRINTVALUES])},updateThumbprintValues:function(t){var e=this,r=!1;for(var a in t)t[a]>e.thumbprintValues[a]&&(e.thumbprintValues[a]=t[a],r=!0);r&&e.storeData()},storeData:function(){var t=this;popManager.storeData(t.localStorageKey,t.thumbprintValues)},useCDN:function(t){return M.CDN_CONTENT_URI&&t.startsWith(M.HOME_URL)&&popCDNThumbprints.canUseCDN(t)},getCDNUrl:function(t){return M.CDN_CONTENT_URI+t.substr(M.HOME_URL.length)},getThumbprintValue:function(e){var r=this,a=popCDNThumbprints.getThumbprints(e),n=[];return t.each(a,function(t,e){n.push(r.thumbprintValues[e])}),n.join(M.CDN_SEPARATOR_THUMBPRINT)},convertURL:function(t){var e=this;if(e.useCDN(t)){var r=e.getThumbprintValue(t);t=e.getCDNUrl(t),r&&(t=add_query_arg(M.CDN_URLPARAM_THUMBPRINT,r,t))}return t}}}(jQuery),popJSLibraryManager.register(popCDN,["documentInitialized","pageSectionFetchSuccess","blockFetchSuccess"],!0),popJSLibraryManager.register(popCDN,["modifyFetchArgs","modifyFetchBlockArgs"]),function(t){popCDNThumbprints={canUseCDN:function(t){var e=this;return!!popCDNConfig&&!e.evalCriteria(t,popCDNConfig.criteria.rejected)},getThumbprints:function(e){var r=this;if(!popCDNConfig)return[];var a=[];return t.each(popCDNConfig.thumbprints,function(t,n){r.evalCriteria(e,popCDNConfig.criteria.thumbprints[n])&&a.push(n)}),a},isHome:function(t){var e=removeParams(t),r=[M.HOME_URL,M.HOME_URL+"/",M.HOMELOCALE_URL,M.HOMELOCALE_URL+"/"];return r.indexOf(e)>-1},evalCriteria:function(e,r){var a=this,n=function(t){var r=t[0],a=t[1],n=getParam(r,e);return"object"==typeof n?searchInObject(n,a):n==a},o=[{isHome:r.isHome&&a.isHome(e),startsWith:r.startsWith.full.some(function(t){return e.startsWith(t)}),pageStartsWith:r.startsWith.partial.some(function(t){return e.startsWith(M.HOMELOCALE_URL+t)}),hasParamValues:r.hasParamValues.some(n)},{noParamValues:!r.noParamValues.some(n)}],i=0;return t.each(o,function(t,e){var r=Object.keys(e).filter(function(t){return e[t]});r.length&&i++}),i==o.length}}}(jQuery),function(t){popCDNCoreHooks={mentionsSource:function(t){t.url=popCDN.convertURL(t.url)},typeaheadPrefetchURL:function(t){t.url=popCDN.convertURL(t.url)},typeaheadRemoteURL:function(t){t.url=popCDN.convertURL(t.url)}}}(jQuery),popJSLibraryManager.register(popCDNCoreHooks,["mentionsSource","typeaheadPrefetchURL","typeaheadRemoteURL"]);