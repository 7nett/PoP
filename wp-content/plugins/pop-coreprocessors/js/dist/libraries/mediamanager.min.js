!function(e){window.popMediaManager={domain:null,initialized:{},needsRefresh:{},documentInitialized:function(){var i=this;e(document).on("uploader:start:settings",function(e,t){i.setUploadSettings(t)}),e(document.body).on("click.add-media-button",".insert-media",function(t){var a=e(t.currentTarget),n=e("#"+a.data("editor")),r=popManager.getBlock(n);i.domain=popManager.getBlockTopLevelDomain(r)}),e(document).on("user:loggedout",function(e){i.needsRefresh={featuredImage:!0,"editor-gallery":!0,"editor-insert":!0}}),e(document).ready(function(e){e(document.body).on("click.add-media-button",".insert-media,.media-menu-item",function(e){var t=wp.media.frame.state();["gallery","insert"].indexOf(t.id)>-1&&(i.initialized["editor-"+t.id]&&i.needsRefresh["editor-"+t.id]&&i.refresh(t),i.initialized["editor-"+t.id]=!0,i.needsRefresh["editor-"+t.id]=!1)}),popFeaturedImage.getFrame().on("open",function(){i.initialized.featuredImage&&i.needsRefresh.featuredImage&&i.refresh(wp.media.frame.state()),i.initialized.featuredImage=!0,i.needsRefresh.featuredImage=!1})})},featuredImageSet:function(e){var i=this,t=e.domain;e.targets.click(function(e){i.domain=t})},getDomain:function(){return this.domain},refresh:function(e){e.get("library")._requery(!0)},setUploadSettings:function(e){e.multipart_params.post_id&&delete e.multipart_params.post_id}}}(jQuery),popJSLibraryManager.register(popMediaManager,["documentInitialized"]),popJSLibraryManager.register(popMediaManager,["featuredImageSet"],!0);