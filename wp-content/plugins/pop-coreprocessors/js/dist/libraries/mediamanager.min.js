"use strict";!function(e){window.popMediaManager={domain:null,initialized:{},needsRefresh:{},init:function(){var i=this;e(document.body).on("click.add-media-button",".insert-media",function(t){var n=e(t.currentTarget),a=e("#"+n.data("editor")),d=popManager.getBlock(a);i.domain=popManager.getBlockTopLevelDomain(d)})},documentInitializedIndependent:function(){var i=this;e(document).on("uploader:start:settings",function(e,t){i.setUploadSettings(t)}),e(document).on("user:loggedout",function(e){i.needsRefresh={featuredImage:!0,"editor-gallery":!0,"editor-insert":!0}}),e(document).ready(function(e){e(document.body).on("click.add-media-button",".insert-media,.media-menu-item",function(e){var t=wp.media.frame.state();["gallery","insert"].indexOf(t.id)>-1&&(i.initialized["editor-"+t.id]&&i.needsRefresh["editor-"+t.id]&&i.refresh(t),i.initialized["editor-"+t.id]=!0,i.needsRefresh["editor-"+t.id]=!1)}),"undefined"!=typeof popFeaturedImage?i.initFeaturedImage():e(document).on("initialized.featuredImage",function(){i.initFeaturedImage()})})},featuredImageSet:function(e){var i=this,t=e.domain;e.targets.click(function(e){i.domain=t})},initFeaturedImage:function(){var e=this;popFeaturedImage.getFrame().on("open",function(){e.initialized.featuredImage&&e.needsRefresh.featuredImage&&e.refresh(wp.media.frame.state()),e.initialized.featuredImage=!0,e.needsRefresh.featuredImage=!1})},getDomain:function(){return this.domain},refresh:function(e){e.get("library")._requery(!0)},setUploadSettings:function(e){e.multipart_params.post_id&&delete e.multipart_params.post_id}}}(jQuery),popJSLibraryManager.register(popMediaManager,["documentInitializedIndependent"]),popJSLibraryManager.register(popMediaManager,["featuredImageSet"],!0),popMediaManager.init();