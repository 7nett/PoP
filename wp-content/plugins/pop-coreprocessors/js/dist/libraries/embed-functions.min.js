!function(e){window.popEmbedFunctions={modalReloadEmbedPreview:function(a){var t=this,r=a.domain,n=a.pageSection;a.targets.each(function(){var a=e(this),o=popManager.getBlock(a),i=popManager.getJsSettings(r,n,o,a)["url-type"]||"embed";o.closest(".modal").on("show.bs.modal",function(d){o.data("embed-iframe")&&(a=e(o.data("embed-iframe")));var p=e(d.relatedTarget),g=popFunctions.getUrl(r,p,!0);"embed"==i?g=popManager.getEmbedUrl(g):"api"==i&&(g=popManager.getAPIUrl(g)),t.embedPreview(r,n,o,a,g)})})},reloadEmbedPreview:function(a){var t=this,r=a.domain,n=a.pageSection,o=a.block;a.targets.each(function(){var a=e(this);e(a.data("input-target")).change(function(){e(this);t.embedPreviewFromInput(r,n,o,a)}),t.embedPreviewFromInput(r,n,o,a)})},replaceCode:function(a){var t=this,r=a.domain,n=a.pageSection;a.targets.each(function(){var a=e(this),o=popManager.getBlock(a),i=popManager.getJsSettings(r,n,o,a)["url-type"]||"";a.closest(".modal").on("show.bs.modal",function(n){var o=e(n.relatedTarget),d=popFunctions.getUrl(r,o);"embed"==i?d=popManager.getEmbedUrl(d):"api"==i&&(d=popManager.getAPIUrl(d)),t.execReplaceCode(a,d)})})},embedPreviewFromInput:function(a,t,r,n){var o=this,i=e(n.data("input-target")).val();if(i&&isUrlValid(i)){var d=e(n.data("iframe-target")),p=o.embedPreview(a,t,r,d,i);n.data("iframe-target","#"+p.targetContainer.attr("id"))}},embedPreview:function(e,a,t,r,n){var o={operation:M.URLPARAM_OPERATION_REPLACEINLINE,extendContext:{src:n},"merge-target":"#"+r.attr("id")},i=r.data("templateid");popJSRuntimeManager.setBlockURL(t);var d=popManager.mergeTargetTemplate(e,a,t,i,o);popManager.runJSMethods(e,a,t,i,"full");var p=popJSRuntimeManager.getLastGeneratedId(e,popManager.getSettingsId(a),popManager.getSettingsId(t),i);return t.data("embed-iframe","#"+p),d},execReplaceCode:function(e,a){var t=e.data("code-placeholder").format(a);e.val(t)}}}(jQuery),popJSLibraryManager.register(popEmbedFunctions,["replaceCode","modalReloadEmbedPreview","reloadEmbedPreview"]);