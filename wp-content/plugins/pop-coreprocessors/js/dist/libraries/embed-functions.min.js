"use strict";!function(e){window.popEmbedFunctions={modalReloadEmbedPreview:function(t){var a=this,r=t.domain,n=t.pageSection;t.targets.each(function(){var t=e(this),o=popManager.getBlock(t),i=popManager.getJsSettings(r,n,o,t)["url-type"]||"embed";o.closest(".modal").on("show.bs.modal",function(d){o.data("embed-iframe")&&(t=e(o.data("embed-iframe")));var p=e(d.relatedTarget),g=popFunctions.getUrl(r,p,!0);"embed"==i?g=a.getEmbedUrl(g):"api"==i&&(g=popManager.getAPIUrl(g)),a.embedPreview(r,n,o,t,g)})})},reloadEmbedPreview:function(t){var a=this,r=t.domain,n=t.pageSection,o=t.block;t.targets.each(function(){var t=e(this);e(t.data("input-target")).change(function(){e(this);a.embedPreviewFromInput(r,n,o,t)}),a.embedPreviewFromInput(r,n,o,t)})},replaceCode:function(t){var a=this,r=t.domain,n=t.pageSection;t.targets.each(function(){var t=e(this),o=popManager.getBlock(t),i=popManager.getJsSettings(r,n,o,t)["url-type"]||"";t.closest(".modal").on("show.bs.modal",function(n){var o=e(n.relatedTarget),d=popFunctions.getUrl(r,o);"embed"==i?d=a.getEmbedUrl(d):"api"==i&&(d=popManager.getAPIUrl(d)),a.execReplaceCode(t,d)})})},getUnembedUrl:function(t){var a=popJSLibraryManager.execute("getUnembedUrl",{url:t});return e.each(a,function(e,a){if(a)return t=a,-1}),t},getEmbedUrl:function(t){var a=popJSLibraryManager.execute("getEmbedUrl",{url:t});return e.each(a,function(e,a){if(a)return t=a,-1}),t},getPrintUrl:function(t){var a=popJSLibraryManager.execute("getPrintUrl",{url:t});return e.each(a,function(e,a){if(a)return t=a,-1}),t},embedPreviewFromInput:function(t,a,r,n){var o=this,i=e(n.data("input-target")).val();if(i&&isUrlValid(i)){var d=e(n.data("iframe-target")),p=o.embedPreview(t,a,r,d,i);n.data("iframe-target","#"+p.targetContainer.attr("id"))}},embedPreview:function(e,t,a,r,n){var o={operation:M.URLPARAM_OPERATION_REPLACEINLINE,extendContext:{src:n},"merge-target":"#"+r.attr("id")},i=r.data("templateid");popJSRuntimeManager.setBlockURL(a);var d=popManager.mergeTargetTemplate(e,t,a,i,o);popManager.runJSMethods(e,t,a,i,"full");var p=popJSRuntimeManager.getLastGeneratedId(e,popManager.getSettingsId(t),popManager.getSettingsId(a),i);return a.data("embed-iframe","#"+p),d},execReplaceCode:function(e,t){var a=e.data("code-placeholder").format(t);e.val(a)}}}(jQuery),popJSLibraryManager.register(popEmbedFunctions,["replaceCode","modalReloadEmbedPreview","reloadEmbedPreview"]);