Handlebars.registerHelper('latestCountTargets',function(itemObject,options){var targets=[];var selector='.pop-block.'+M.JS_INITIALIZED+' > .blocksection-latestcount > .pop-latestcount';var post_type=itemObject['post-type'];var cats=itemObject['cats'];if(cats&&cats.length){targets.push(selector+'.'+post_type+'-'+cats.join('.'+post_type+'-'));}
jQuery.each(itemObject['tags'],function(index,tag){var target=selector+'.tag'+tag;targets.push(target);});jQuery.each(itemObject['authors'],function(index,author){var target=selector+'.author'+author;if(cats&&cats.length){target+='.author-'+post_type+'-'+cats.join('.author-'+post_type+'-');}
targets.push(target);});jQuery.each(itemObject['references'],function(index,post_id){var target=selector+'.single'+post_id;if(cats&&cats.length){target+='.single-'+post_type+'-'+cats.join('.single-'+post_type+'-');}
targets.push(target);});return new Handlebars.SafeString(targets.join(','));});;(function($){popCustomBootstrap={initDocument:function(){var t=this;$(document).on('focusin',function(e){if($(e.target).closest(".mce-window").length){e.stopImmediatePropagation();}});},runScriptsBefore:function(args){var t=this;var pageSection=args.pageSection,newDOMs=args.newDOMs;newDOMs.find('.collapse').addBack('.collapse').on('show.bs.collapse',function(){t.addBubblingFlag($(this),'.collapse','show');}).on('shown.bs.collapse',function(){t.addBubblingFlag($(this),'.collapse','shown');}).on('hide.bs.collapse',function(){t.addBubblingFlag($(this),'.collapse','hide');}).on('hidden.bs.collapse',function(){t.addBubblingFlag($(this),'.collapse','hidden');});},pageSectionNewDOMsInitialized:function(args){var t=this;var pageSection=args.pageSection,newDOMs=args.newDOMs;t.activateNestedComponents(pageSection,newDOMs);t.showComponentInitializeJS(pageSection,newDOMs);t.triggerTabPaneEvents(newDOMs);},isHidden:function(args){var t=this;var targets=args.targets;if(targets.parents('.collapse,.modal').not('.in').length){return true;}
if(targets.parents('.tab-pane').not('.active').length){return true;}
return false;},isActive:function(args){var t=this;var targets=args.targets;if(targets.hasClass('tab-pane')&&!targets.hasClass('active')){return false;}
return true;},activeTabLink:function(args){var t=this;var targets=args.targets;targets.click(function(e){var link=$(this);link.parent('li').addClass('active').siblings('li').removeClass('active');})},activatePageTab:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.click(function(){var interceptor=$(this);var pageTabBtn=$(interceptor.data('target'));t.clickPageTab(pageSection,pageTabBtn);});targets.each(function(){var target=$(this);if(target.closest('.pop-pagesection-page').find('.pop-pagetab-btn').not('.pop-inactive').length){target.trigger('click');}});},customQuickView:function(args){var t=this;var pageSection=args.pageSection;var modal=pageSection.closest('.modal');pageSection.on('fetched',function(){if(!popBootstrap.showingModal(modal)){popBootstrap.closeModals();modal.modal('show');}});popManager.getPageSectionGroup(pageSection).on('on.bs.pagesection-group:pagesection-'+pageSection.attr('id')+':closed',function(){modal.modal('hide');});},destroyPageOnModalClose:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var link=$(this);link.closest('.modal').on('hidden.bs.modal',function(){link.trigger('click');});});},customCloseModals:function(args){var t=this;var pageSection=args.pageSection;pageSection.on('destroy',function(){popBootstrap.closeModals();});},showComponentInitializeJS:function(pageSection,newDOMs){var t=this;var collapses=newDOMs.find('.collapse.pop-bscomponent').addBack('.collapse.pop-bscomponent');if(collapses.length){t.initComponentHandlers(pageSection,collapses,'shown.bs.collapse');}
var modals=newDOMs.find('.modal.pop-bscomponent').addBack('.modal.pop-bscomponent');if(modals.length){t.initComponentHandlers(pageSection,modals,'shown.bs.modal');}
var tabPanes=newDOMs.find('.tab-pane.pop-bscomponent').addBack('.tab-pane.pop-bscomponent');if(tabPanes.length){t.initComponentHandlers(pageSection,tabPanes,'shown.bs.tabpane');}
var carousels=newDOMs.find('.carousel.pop-bscomponent').addBack('.carousel.pop-bscomponent');if(carousels.length){t.initComponentHandlers(pageSection,carousels,'slid.bs.carousel',true);}},initComponentHandlers:function(pageSection,targets,handler,useRelatedTarget){var t=this;targets.on(handler,function(e){var component=useRelatedTarget?$(e.relatedTarget):$(this);var blocks=$(component.data('initjs-targets'));var block_data={'post-data':component.data('post-data'),}
t.recursiveSetBlockData(pageSection,blocks,block_data);});targets.on(handler,function(e){var component=useRelatedTarget?$(e.relatedTarget):$(this);var blocks=$(component.data('initjs-targets')).not('.'+M.JS_INITIALIZED);if(!blocks.length){return;}
var options={'force-init':true};var url=component.data('intercept-url');if(url){options.url=url;}
popManager.initBlockBranches(pageSection,blocks,options);});targets.on(handler,function(e){var component=useRelatedTarget?$(e.relatedTarget):$(this);var blocks=$(component.data('initjs-targets'));if(component.data('onetime-refetch')){t.recursiveOneTimeRefetch(pageSection,blocks);}
t.triggerBlocksVisible(pageSection,blocks);});},recursiveSetBlockData:function(pageSection,blocks,block_data){var t=this;blocks.each(function(){var block=$(this);$.each(block_data,function(key,value){block.data(key,value);});var jsSettings=popManager.getJsSettings(pageSection,block);var blockBranches=jsSettings['initjs-blockbranches'];if(blockBranches){t.recursiveSetBlockData(pageSection,$(blockBranches.join(', ')),block_data);}});},recursiveOneTimeRefetch:function(pageSection,blocks){var t=this;blocks.each(function(){var block=$(this);popSystem.makeOneTimeRefetch(pageSection,block);var jsSettings=popManager.getJsSettings(pageSection,block);var blockBranches=jsSettings['initjs-blockbranches'];if(blockBranches){t.recursiveOneTimeRefetch(pageSection,$(blockBranches.join(', ')));}});},triggerBlocksVisible:function(pageSection,blocks){var t=this;blocks.each(function(){var block=$(this);block.triggerHandler('visible');var jsSettings=popManager.getJsSettings(pageSection,block);var blockBranches=jsSettings['initjs-blockbranches'];if(blockBranches){t.triggerBlocksVisible(pageSection,$(blockBranches.join(', ')));}});},activateNestedComponents:function(pageSection,newDOMs){var t=this;newDOMs.find('div.tab-pane div.tab-pane').addBack('div.tab-pane div.tab-pane').on('shown.bs.tabpane',function(){t.activateOuterTabPanes($(this));});newDOMs.find('div.tab-pane div.collapse').addBack('div.tab-pane div.collapse').on('shown.bs.collapse',function(){t.activateOuterTabPanes($(this));});newDOMs.find('div.carousel div.collapse').addBack('div.carousel div.collapse').on('shown.bs.collapse',function(){t.activateOuterCarousel($(this));});newDOMs.find('div.carousel div.tab-pane').addBack('div.carousel div.tab-pane').on('shown.bs.tabpane',function(){t.activateOuterCarousel($(this));});},activateOuterTabPanes:function(component){var t=this;var outerTabPanes=component.parents('.tab-pane').not('.active');if(outerTabPanes.length){$('a[href="#'+outerTabPanes.attr('id')+'"]').tab('show');}},activateOuterCarousel:function(component){var t=this;var outerCarousel=component.closest('.carousel');popBootstrapCarousel.showElement(outerCarousel,component);},triggerTabPaneEvents:function(elem){var t=this;elem.find('a[data-toggle="tab"]').addBack('a[data-toggle="tab"]').on('show.bs.tab',function(e){t.triggerTabPaneEvent($(this),e,'show.bs.tabpane');}).on('shown.bs.tab',function(e){t.triggerTabPaneEvent($(this),e,'shown.bs.tabpane');}).on('hide.bs.tab',function(e){t.triggerTabPaneEvent($(this),e,'hide.bs.tabpane');}).on('hidden.bs.tab',function(e){t.triggerTabPaneEvent($(this),e,'hidden.bs.tabpane');});},triggerTabPaneEvent:function(link,e,event){var t=this;var tabPane=$($(e.target).attr('href'));tabPane.data('post-data',link.data('post-data'));tabPane.data('onetime-refetch',link.data('onetime-refetch'));tabPane.data('intercept-url',link.data('intercept-url'));tabPane.data('original-url',link.data('original-url'));tabPane.triggerHandler(event,[e]);},resetBubbling:function(){$('[data-bubbling]').attr('data-bubbling',null);$('[data-bubbling-origin]').attr('data-bubbling-origin',null);},bubbling:function(elem,selector){var t=this;if(elem.is(selector)){var bubblingId=elem.attr('data-bubbling');if(bubblingId&&elem.find('[data-bubbling-origin="'+bubblingId+'"]').length){return true;}}
return false;},addBubblingFlag:function(elem,parentSelector,type){var t=this;if(elem.parents(parentSelector).length){var ran=getRandomInt(1,10000000000);var bubblingId=elem.attr('id')+'-'+type+'-'+ran;elem.attr('data-bubbling-origin',bubblingId);elem.parents(parentSelector).attr('data-bubbling',bubblingId);}},activatePageTabs:function(pageSection,newDOMs,inactivePane){var t=this;if(inactivePane){newDOMs.filter('.pop-pagesection-page').find('.pop-pagetab-btn').addClass('pop-inactive');}},activateSideTabpanes:function(pageSection,newDOMs,inactivePane){var t=this;var tabPane=newDOMs.filter('.tab-pane');if(tabPane.length){var firstLoad=popManager.isFirstLoad(pageSection);if(!inactivePane){if(!firstLoad){newDOMs.siblings('.tab-pane').removeClass('active');}
tabPane.addClass('active');}
tabPane.on('shown.bs.tabpane',function(){var openmode=popPageSectionManager.getOpenMode(pageSection);if(openmode=='automatic'){popPageSectionManager.open(pageSection);popManager.scrollTop(pageSection);}});if(!inactivePane&&!firstLoad){popManager.scrollTop(pageSection);}}},activateQuickviewTabpanes:function(pageSection,newDOMs,inactivePane){var t=this;var tabPane=newDOMs.filter('.tab-pane');if(tabPane.length){tabPane.addClass('active').siblings('.tab-pane').removeClass('active');}},activateModals:function(pageSection,newDOMs){var t=this;var modal=newDOMs.filter('.modal');if(modal.length){popBootstrap.closeModals();modal.modal('show');modal.on('show.bs.modal',function(e){popManager.closeMessageFeedback(modal);});modal.on('shown.bs.modal',function(e){windowResize();});}},activateTabPanes:function(pageSection,newDOMs,inactivePane,removeTheather,sides){var t=this;var tabPane=newDOMs.filter('.tab-pane');if(tabPane.length){var firstLoad=popManager.isFirstLoad(pageSection);if(!inactivePane){if(!firstLoad){var previousTabPane=newDOMs.siblings('.tab-pane.active');t.savePosition(pageSection,previousTabPane);previousTabPane.removeClass('active');}
tabPane.addClass('active');}
tabPane.on('show.bs.tabpane',function(){var tabPane=$(this);var previousTabPane=tabPane.siblings('.active');t.savePosition(pageSection,previousTabPane);}).on('shown.bs.tabpane',function(){var tabPane=$(this);popPageSectionManager.open(pageSection);t.newPageSectionJS(pageSection,removeTheather,sides,tabPane);});if(!inactivePane&&!firstLoad){t.newPageSectionJS(pageSection,removeTheather,sides);}}},clickPageTab:function(pageSection,pageTabBtn){var t=this;pageSection.find('.pop-pagetab-btn').removeClass('active');pageTabBtn.addClass('active');},savePosition:function(pageSection,tabPane){var t=this;tabPane.data('lastposition',popManager.getPosition(pageSection));tabPane.data('theater',popPageSectionManager.isTheater());},newPageSectionJS:function(pageSection,removeTheather,sides,tabPane){var t=this;sides.each(function(){var sidePageSection=$(this);popPageSectionManager.close(sidePageSection,'xs');})
popBootstrap.closeModals();var pos=0,theater;if(tabPane){pos=tabPane.data('lastposition')||0;theater=tabPane.data('theater')||false;}
popManager.scrollTop(pageSection,pos);if(removeTheather&&!theater){popPageSectionManager.theater(false);}
if(theater){popPageSectionManager.theater(true);}
windowResize();},};})(jQuery);popJSLibraryManager.register(popCustomBootstrap,['initDocument','runScriptsBefore','pageSectionNewDOMsInitialized','activeTabLink','isHidden','isActive'],true);popJSLibraryManager.register(popCustomBootstrap,['customQuickView','destroyPageOnModalClose','customCloseModals','activatePageTab']);;(function($){popSystem={documentInitialized:function(){var t=this;t.links();},activeLinks:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;var settings=popManager.getFetchPageSectionSettings(pageSection);if(settings.activeLinks){var feedback=popManager.getTopLevelFeedback();var parentPageId=feedback[M.URLPARAM_PARENTPAGEID];if(parentPageId){targets.find('.menu-item-object-id-'+parentPageId).each(function(){var menuItem=$(this);menuItem.addClass('active');menuItem.parents('.menu-item').addClass('active');});}}},fullscreen:function(args){var t=this;var targets=args.targets;$(document).bind("fullscreenchange",function(){var glyphicon=targets.find('.glyphicon');if($(document).fullScreen()){glyphicon.removeClass('glyphicon-fullscreen').addClass('glyphicon-resize-small');}
else{glyphicon.addClass('glyphicon-fullscreen').removeClass('glyphicon-resize-small');}});targets.click(function(e){e.preventDefault();var button=$(this);var fullScreen=button.closest('.pop-fullscreen');fullScreen.toggleFullScreen();});},newWindow:function(args){var t=this;var targets=args.targets;targets.click(function(e){e.preventDefault();window.open(popManager.getUnembedUrl(window.location.href),'_blank');});},clickURLParam:function(args){var t=this;var url=getParam(M.URLPARAM_URL);if(url){$(document).ready(function($){popManager.click(decodeURIComponent(url));});}},initDelegatorFilter:function(args){var t=this;var delegatorPageSection=args.pageSection,targets=args.targets;targets.submit(function(e){e.preventDefault();var form=$(this);if(form.data('blocktarget')){var block=$(form.data('blocktarget'));var pageSection=popManager.getPageSection(block);if(popManager.isBlockGroup(block)){t.filterBlockGroup(pageSection,block,form);}
else{popManager.filter(pageSection,block,form);}
popPageSectionManager.close(delegatorPageSection,'xs');}});},initBlockFilter:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.submit(function(e){e.preventDefault();var form=$(this);if(form.data('blocktarget')){block=$(form.data('blocktarget'));pageSection=popManager.getPageSection(block);}
popManager.filter(pageSection,block,form);});},initBlockGroupFilter:function(args){var t=this;var pageSection=args.pageSection,blockGroup=args.block,targets=args.targets;targets.each(function(e){var filter=$(this);blocks.each(function(){var block=$(this);popManager.setFilterBlockParams(pageSection,block,filter);});});targets.submit(function(e){e.preventDefault();var filter=$(this);t.filterBlockGroup(pageSection,blockGroup,filter);});},reloadBlockGroup:function(args){var t=this;var pageSection=args.pageSection,blockGroup=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();var activeBlock=popManager.getBlockGroupActiveBlock(blockGroup);popManager.reload(pageSection,activeBlock);});},reloadBlock:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();popManager.reload(pageSection,block);});},loadLatestBlock:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();popManager.loadLatest(pageSection,block);});},timeoutLoadLatestBlock:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.each(function(){var target=$(this);var time=target.data('clicktime')||30000;t.execTimeoutLoadLatestBlock(pageSection,block,target,time);});},displayBlockDatasetCount:function(args){var t=this;var pageSection=args.pageSection,block=args.block;if(block.data('datasetcount-target')){var jsSettings=popManager.getJsSettings(pageSection,block);var when=jsSettings['display-datasetcount-when']||['oncreated'];var updateTitle=jsSettings['datasetcount-updatetitle'];if(when.indexOf('oncreated')>-1){$(document).ready(function($){var target=$(block.data('datasetcount-target'));popManager.displayDatasetCount(pageSection,block,target,updateTitle);});}
if(when.indexOf('onrendered')>-1){block.on('rendered',function(e){var target=$(block.data('datasetcount-target'));popManager.displayDatasetCount(pageSection,block,target,updateTitle);});}}},clearDatasetCount:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.each(function(){var link=$(this);var target=$(link.data('datasetcount-target'));var updateTitle=link.data('datasetcount-updatetitle')?true:false;link.click(function(e){e.preventDefault();t.execClearDatasetCount(target,updateTitle);});link.hover(function(){t.execClearDatasetCount(target,updateTitle);});});},clearDatasetCountOnUserLoggedOut:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.each(function(){var link=$(this);var target=$(link.data('datasetcount-target'));var updateTitle=link.data('datasetcount-updatetitle')?true:false;$(document).on('user:loggedout',function(e){t.execClearDatasetCount(target,updateTitle);});});},onDestroyPageSwitchTab:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var link=$(this);var pageSectionPage=popManager.getPageSectionPage(link);pageSectionPage.on('destroy',function(){t.switchTab(link);})})},closePageTab:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.click(function(e){e.preventDefault();var link=$(this);var url=link.data('url')||popManager.getBlock(link).data('paramsscope-url');var target=link.attr('target')||popManager.getFrameTarget(pageSection);popManager.triggerDestroyTarget(url,target);});},resetOnSuccess:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;var pssId=popManager.getSettingsId(pageSection);targets.on('fetched',function(e,response){var block=$(this);var bsId=popManager.getSettingsId(block);var blockFeedback=response.feedback.block[pssId][bsId];if(blockFeedback.result===true){popManager.reset(pageSection,block,{'skip-restore':true});}});},resetOnUserLogout:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;$(document).on('user:loggedout',function(e,source){targets.each(function(){var block=$('#'+$(this).attr('id'));if(block.length){popManager.reset(pageSection,block);}});});},destroyPageOnSuccess:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;var pssId=popManager.getSettingsId(pageSection);targets.on('fetched',function(e,response){var block=$(this);var bsId=popManager.getSettingsId(block);var blockFeedback=response.feedback.block[pssId][bsId];var target=popManager.getFrameTarget(pageSection);if(blockFeedback.result===true){var destroyTime=block.data('destroytime')||0;setTimeout(function(){popManager.triggerDestroyTarget(block.data('paramsscope-url'),target);},destroyTime);}});},destroyPageOnUserLoggedOut:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;pageSection.one('completed',function(){t.execDestroyPageOnUserLoggedOut(targets);});},destroyPageOnUserNoRole:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;pageSection.one('completed',function(){t.execDestroyPageOnUserNoRole(pageSection,targets);});},refetchBlockOnUserLoggedIn:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;$(document).one('user:loggedin',function(e,source){if(source=='initialfeedback'){return;}
t.execRefetchBlock(pageSection,targets);});},nonendingRefetchBlockOnUserLoggedIn:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;t.execNonendingRefetchBlockOnUserEvent(pageSection,targets,'user:loggedin');},nonendingRefetchBlockOnUserLoggedInOut:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;t.execNonendingRefetchBlockOnUserEvent(pageSection,targets,'user:loggedinout');},deleteBlockFeedbackValueOnUserLoggedInOut:function(args){var t=this;var pageSection=args.pageSection,block=args.block;$(document).on('user:loggedinout',function(e,source){if(source=='initialfeedback'||source=='initialuserdata'){return;}
var jsSettings=popManager.getJsSettings(pageSection,block);var keys=jsSettings['user:loggedinout-deletefeedbackvalue']||[];if(keys.length){var blockFeedback=popManager.getBlockFeedback(pageSection,block);$.each(keys,function(index,keyLevels){var feedbackLevel=blockFeedback;for(i=0;i<(keyLevels.length)-1;i++){feedbackLevel=feedbackLevel[keyLevels[i]];}
delete feedbackLevel[keyLevels[(keyLevels.length)-1]];});}});},scrollTopOnUserLoggedInOut:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;$(document).on('user:loggedinout',function(e,source){if(source=='initialfeedback'||source=='initialuserdata'){return;}
targets.each(function(){var target=$(this);var jsSettings=popManager.getJsSettings(pageSection,block,target);var animate=jsSettings['scrolltop-animate']||false;popManager.scrollToElem(target,target,animate);});});},refetchBlockGroupOnUserLoggedIn:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;$(document).one('user:loggedin',function(e,source){if(source=='initialfeedback'){return;}
targets.each(function(){var blockGroup=$('#'+$(this).attr('id'));if(blockGroup.length){var blocks=popManager.getBlockGroupBlocks(blockGroup);var activeBlock=popManager.getBlockGroupActiveBlock(blockGroup);blocks.each(function(){var block=$(this);if(block.attr('id')==activeBlock.attr('id')){t.refetchBlock(pageSection,block);}
else{t.makeOneTimeRefetch(pageSection,block);}});}});});},closeMessageFeedbacksOnPageSectionOpen:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;popPageSectionManager.getGroup(pageSection).on('on.bs.pagesection-group:pagesection-'+pageSection.attr('id')+':opened',function(){popManager.closeMessageFeedbacks(pageSection);});},closePageSectionOnSuccess:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;var pssId=popManager.getSettingsId(pageSection);targets.on('fetched',function(e,response){var block=$(this);var bsId=popManager.getSettingsId(block);var blockFeedback=response.feedback.block[pssId][bsId];if(blockFeedback.result===true){var closeTime=block.data('closetime')||0;t.timeoutClosePageSection(pageSection,closeTime);}});},destroyPage:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.click(function(e){e.preventDefault();var link=$(this);var pageSectionPage=$(link.data('target'));popManager.destroyPageSectionPage(pageSection,pageSectionPage);});},replicateTopLevel:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var link=$(this);var type=link.data('replicate-type');if(type==M.REPLICATETYPES.MULTIPLE){t.replicateMultipleTopLevel(pageSection,link);}
else if(type==M.REPLICATETYPES.SINGLE){t.replicateSingleTopLevel(pageSection,link);}});},replicatePageSection:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var link=$(this);var type=link.data('replicate-type');if(type==M.REPLICATETYPES.MULTIPLE){t.replicateMultiplePageSection(pageSection,link);}
else if(type==M.REPLICATETYPES.SINGLE){t.replicateSinglePageSection(pageSection,link);}});},closePageSection:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.click(function(e){e.preventDefault();popPageSectionManager.close(pageSection);});},closePageSectionOnTabShown:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var block=$(this);var pageSectionPage=popManager.getPageSectionPage(block);pageSectionPage.on('shown.bs.tabpane',function(){popPageSectionManager.close(pageSection);});popPageSectionManager.close(pageSection);});},initFilter:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.each(function(){var filter=$(this);popManager.setFilterBlockParams(pageSection,block,filter);});},interceptForm:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.click(function(e){e.preventDefault();var link=$(this);var form=$(link.data('target'));var params=splitParams(link.data('post-data'));$.each(params,function(key,value){form.find('input[name="'+key+'"]').val(value);});form.submit();});},forms:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;var pssId=popManager.getSettingsId(pageSection);var bsId=popManager.getSettingsId(block);targets.submit(function(e){e.preventDefault();var form=$(this);form.triggerHandler('beforeSubmit');popManager.fetchBlock(pageSection,block,{type:'POST',"post-data":form.serialize()});popManager.blockScrollTop(pageSection,block);});block.on('fetched',function(e,response){var blockFeedback=response.feedback.block[pssId][bsId];if(blockFeedback.result===true){targets.triggerHandler('clear');}
popManager.maybeRedirect(blockFeedback);});},clearInput:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var input=$(this);input.closest('form').on('clear',function(){input.val('');});});},makeAlwaysRefetchBlock:function(args){var t=this;var pageSection=args.pageSection,block=args.block;block.on('visible',function(){var block=$(this);t.refetchBlock(pageSection,block);});},filterBlockGroup:function(pageSection,blockGroup,filter){var t=this;var activeBlock=popManager.getBlockGroupActiveBlock(blockGroup);var blocks=popManager.getBlockGroupBlocks(blockGroup);blocks.each(function(){var block=$(this);popManager.setFilterBlockParams(pageSection,block,filter);if(block.attr('id')==activeBlock.attr('id')){popManager.reload(pageSection,block);}
else{t.makeOneTimeRefetch(pageSection,block);}});},execClearDatasetCount:function(target,updateTitle){var t=this;target.html('').addClass('hidden');if(updateTitle){document.title=popManager.documentTitle;}},execTimeoutLoadLatestBlock:function(pageSection,block,target,time){var t=this;var jsSettings=popManager.getJsSettings(pageSection,block,target);var options={'skip-status':true,'datasetcount-target':jsSettings['datasetcount-target'],'datasetcount-updatetitle':jsSettings['datasetcount-updatetitle'],};var onlyLoggedIn=jsSettings['only-loggedin']||false;if(onlyLoggedIn&&!popUserAccount.isLoggedIn()){$(document).one('user:loggedin',function(e,source){t.execTimeoutLoadLatestBlock(pageSection,block,target,time);});return;}
setTimeout(function(){if($('#'+target.attr('id')).length){popManager.loadLatest(pageSection,block,options);t.execTimeoutLoadLatestBlock(pageSection,block,target,time);}},time);},timeoutClosePageSection:function(pageSection,closeTime){var t=this;setTimeout(function(){popPageSectionManager.close(pageSection);popManager.closeMessageFeedbacks(pageSection);},closeTime);},execNonendingRefetchBlockOnUserEvent:function(pageSection,targets,handler){var t=this;$(document).on(handler,function(e,source){if(source=='initialfeedback'||source=='initialuserdata'){return;}
t.execRefetchBlock(pageSection,targets);});},execRefetchBlock:function(pageSection,blocks){var t=this;blocks.each(function(){var block=$('#'+$(this).attr('id'));if(block.length){t.refetchBlock(pageSection,block);}});},execDestroyPageOnUserLoggedOut:function(targets){var t=this;$(document).one('user:loggedout',function(e,source){targets.each(function(){var block=$('#'+$(this).attr('id'));if(block.length){var pageSection=popManager.getPageSection(block);var target=popManager.getFrameTarget(pageSection);popManager.triggerDestroyTarget(block.data('paramsscope-url'),target);}});});},execDestroyPageOnUserNoRole:function(pageSection,block){var t=this;var neededRole=block.data('neededrole');$(document).one('user:updated',function(e,updates){block=$('#'+block.attr('id'));if(block.length){if(updates.roles&&updates.roles.indexOf(neededRole)==-1){var target=popManager.getFrameTarget(pageSection);popManager.triggerDestroyTarget(block.data('paramsscope-url'),target);}
else{t.execDestroyPageOnUserNoRole(pageSection,block);}}});},switchTab:function(link){var t=this;if(link.prev('a.pop-pagetab-btn').hasClass('active')){var current=popManager.getPageSectionPage(link);var next=current.nextAll('.pop-pagesection-page').first();if(!next.length){next=current.prevAll('.pop-pagesection-page').first();}
if(next.length){next.find('a.pop-pagetab-btn').trigger('click');}}},replicateMultipleTopLevel:function(pageSection,targets){var t=this;targets.click(function(e){e.preventDefault();var link=$(this);var addUniqueId=link.data('unique-url')||false;t.execReplicateTopLevel(pageSection,link,true,addUniqueId);});},replicateSingleTopLevel:function(pageSection,targets){var t=this;targets.one('click',function(e){e.preventDefault();var link=$(this);t.execReplicateTopLevel(pageSection,link,false,false);});},execReplicateTopLevel:function(pageSection,link,generateUniqueId,addUniqueId){var t=this;var memory=popManager.getMemory();var interceptUrl=link.data('intercept-url');var target=popManager.getFrameTarget(pageSection);var replicableMemory=popManager.getReplicableMemory(interceptUrl,target);memory.feedback.toplevel=$.extend({},replicableMemory.feedback.toplevel);var url=link.data('original-url');if(generateUniqueId){popManager.generateUniqueId();if(addUniqueId){url=popManager.addUniqueId(url);}}
var title=link.data('title');var tlFeedback=popManager.getTopLevelFeedback();tlFeedback[M.URLPARAM_TITLE]=title;tlFeedback[M.URLPARAM_PARENTPAGEID]=null;tlFeedback[M.URLPARAM_URL]=url;popManager.maybeUpdateDocument(pageSection);},replicateMultiplePageSection:function(pageSection,targets){var t=this;targets.click(function(e){e.preventDefault();var link=$(this);t.execReplicatePageSection(pageSection,link);});},replicateSinglePageSection:function(pageSection,targets){var t=this;targets.one('click',function(e){e.preventDefault();var link=$(this);t.execReplicatePageSection(pageSection,link);});},execReplicatePageSection:function(pageSection,link){var t=this;var bsId=link.data('block-settingsid');var pssId=popManager.getSettingsId(pageSection);var template=link.data('templateid');var memory=popManager.getMemory();var interceptUrl=link.data('intercept-url');var target=popManager.getFrameTarget(pageSection);var replicableMemory=popManager.getReplicableMemory(interceptUrl,target);$.extend(memory.feedback.pagesection,replicableMemory.feedback.pagesection);$.each(replicableMemory.feedback.block,function(ipssId,ipsFeedback){$.extend(memory.feedback.block[ipssId],ipsFeedback);$.extend(memory.dataset[ipssId],replicableMemory.dataset[ipssId]);$.extend(memory.params[ipssId],replicableMemory.params[ipssId]);});var tlFeedback=popManager.getTopLevelFeedback();var psFeedback=popManager.getPageSectionFeedback(pageSection);var psConfiguration=popManager.getPageSectionConfiguration(pageSection);if(!psFeedback['intercept-urls'][template]){psFeedback['intercept-urls'][template]={};}
psFeedback['intercept-urls'][template][template]=tlFeedback[M.URLPARAM_URL];psConfiguration[M.JS_TEMPLATE]=template;var blockSettingsIds={};link.next('.pop-interceptor-blocksettingsids').children().each(function(){var settingElem=$(this);var val=settingElem.data('value');if(settingElem.data('value')){val=[settingElem.data('value')];}
else{val=[];}
blockSettingsIds[settingElem.data('key')]=val;});psConfiguration[M.JS_BLOCKSETTINGSIDS]=blockSettingsIds;popManager.initPageSectionSettings(pageSection,psConfiguration);var options={'js-args':{relatedTarget:link},url:tlFeedback[M.URLPARAM_URL]}
popManager.renderPageSection(pageSection,options);},refetchBlock:function(pageSection,block){var t=this;var options={'post-data':block.data('post-data'),'show-disabled-layer':true};popManager.refetch(pageSection,block,options);},makeOneTimeRefetch:function(pageSection,block){var t=this;if(!popManager.jsInitialized(block)||!popManager.isContentLoaded(pageSection,block)){return;}
block.one('visible',function(){var block=$(this);t.refetchBlock(pageSection,block);});},linkBlankTarget:function(anchor){var t=this;if(!anchor.attr('target')){anchor.attr('target','_blank');}},maybeaddspinner:function(anchor,url){var t=this;var addspinner=!anchor.hasClass('hidden')&&((M.ADDANCHORSPINNER&&(typeof anchor.data('addspinner')=='undefined')||anchor.data('addspinner')));if(addspinner){var spinner=$('<span class="pop-spinner">'+M.SPINNER+'</span>');if(anchor.find('img').length){spinner.addClass('spinner-img');}
$(document).one('urlfetched:'+escape(url),function(){anchor.removeClass('loading').children('.pop-spinner').remove();});anchor.trigger('blur').addClass('loading').prepend(spinner);}
return addspinner;},links:function(){var t=this;var imgRegex=new RegExp(/\.(gif|jpg|jpeg|tiff|png)$/i);var otherRegex=new RegExp(/\.(pdf|css|js|zip|tar|ppt|pptx|doc|docx|xls|xlsx)$/i);var allowedAnchors=[];$.each(M.ALLOWED_URLS,function(index,domain){allowedAnchors.push('a[href^="'+domain+'"]');});$(document).on('click',allowedAnchors.join(','),function(e){var anchor=$(this);var url=anchor.attr('href');if(imgRegex.test(url)){var method='linksImage';if(popJSLibraryManager.getLibraries(method).length){e.preventDefault();var args={anchor:anchor}
popJSLibraryManager.execute(method,args);}
else{t.linkBlankTarget(anchor);}}
else if(otherRegex.test(url)){t.linkBlankTarget(anchor);}
else{popCustomBootstrap.resetBubbling();var pageSection=popManager.getPageSection(anchor);var target=anchor.attr('target')||M.URLPARAM_TARGET_MAIN;if(target==M.URLPARAM_TARGET_FULL){e.preventDefault();t.maybeaddspinner(anchor,url);window.location=url;return;}
if(target==M.URLPARAM_TARGET_PRINT){e.preventDefault();t.openPrint(url);return;}
if(popManager.targetExists(target)){e.preventDefault();if(url==M.HOME_URL){url=M.HOME_URL+'/';}
var intercept=false,options={},interceptOptions={};if(anchor.data('reloadurl')){options.reloadurl=true;}
else{var interceptTarget=anchor.attr('target')||popManager.getClickFrameTarget(pageSection);interceptOptions={event:e,relatedTarget:anchor,target:interceptTarget,};var interceptUrl=url;if(anchor.data('append-intercepturl')){interceptUrl+=anchor.data('append-intercepturl');}
intercept=popURLInterceptors.getInterceptors(interceptUrl,interceptOptions).length;}
if(intercept){popURLInterceptors.intercept(interceptUrl,interceptOptions);}
else{options.target=target;options['js-args']={relatedTarget:anchor};var addspinner=t.maybeaddspinner(anchor,url);var loadingmsg_target=addspinner?'':null;if(typeof anchor.data('loadingmsg-target')!='undefined'){loadingmsg_target=anchor.data('loadingmsg-target');}
if(loadingmsg_target!=null){options['loadingmsg-target']=loadingmsg_target;}
if(e.metaKey){options.silentDocument=true;options['js-args'].inactivePane=true;}
popManager.fetch(url,options);}}}});$(document).on('click','a[target="'+M.URLPARAM_TARGET_SOCIALMEDIA+'"]',function(e){e.preventDefault();var anchor=$(this);var url=anchor.attr('href');t.openSocialMedia(url);});$(document).on('click','a[href^="#"]',function(e){var anchor=$(this);var url=anchor.attr('href');if(url.length>1){var elem=$(url);var bootstrap=typeof anchor.data('toggle')!=='undefined'||typeof anchor.data('slide')!=='undefined';if(elem.length&&!bootstrap){e.preventDefault();popManager.scrollToElem(popManager.getPageSection(elem),elem,true);}}});$(document).on('click','a[href^="http://"],a[href^="https://"]',function(e){var anchor=$(this);var url=anchor.attr('href');var openblank=true;$.each(M.ALLOWED_URLS,function(index,domain){if(url.startsWith(domain)){openblank=false;return-1;}});if(openblank){t.linkBlankTarget(anchor);}});},openPrint:function(url){window.open(url,'_blank');},openSocialMedia:function(url){window.open(url,'_blank','left=20,top=20,width=500,height=400,toolbar=1,resizable=0');},scrollHandler:function(args){var t=this;var pageSection=args.pageSection;var lastScrollTop=0,delta=200;pageSection.scroll(function(){var nowScrollTop=$(this).scrollTop();if(Math.abs(lastScrollTop-nowScrollTop)>=delta){if(nowScrollTop>lastScrollTop){$(window).triggerHandler('scroll:down');}
else{$(window).triggerHandler('scroll:up');}
lastScrollTop=nowScrollTop;}});},};})(jQuery);popJSLibraryManager.register(popSystem,['documentInitialized','activeLinks','newWindow','fullscreen','clickURLParam','initDelegatorFilter','initBlockGroupFilter','initBlockFilter','reloadBlockGroup','reloadBlock','loadLatestBlock','timeoutLoadLatestBlock','displayBlockDatasetCount','clearDatasetCount','clearDatasetCountOnUserLoggedOut','replicateTopLevel','replicatePageSection','closePageSection','closePageSectionOnTabShown','onDestroyPageSwitchTab','closePageTab','resetOnSuccess','resetOnUserLogout','closeMessageFeedbacksOnPageSectionOpen','closePageSectionOnSuccess','destroyPageOnUserLoggedOut','destroyPageOnUserNoRole','refetchBlockOnUserLoggedIn','nonendingRefetchBlockOnUserLoggedIn','nonendingRefetchBlockOnUserLoggedInOut','deleteBlockFeedbackValueOnUserLoggedInOut','scrollTopOnUserLoggedInOut','refetchBlockGroupOnUserLoggedIn','destroyPageOnSuccess','destroyPage','initFilter','interceptForm','forms','clearInput','makeAlwaysRefetchBlock','scrollHandler']);;(function($){popForms={formCreatePostBlock:function(args){var t=this;var pageSection=args.pageSection,block=args.block;var pssId=popManager.getSettingsId(pageSection);var bsId=popManager.getSettingsId(block);block.one('fetched',function(e,response){t.execFormCreatePostBlock(pageSection,block,response);});},manageStatus:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;t.execManageStatus(targets);var pssId=popManager.getSettingsId(pageSection);var bsId=popManager.getSettingsId(block);block.on('fetched',function(e,response){var blockFeedback=response.feedback.block[pssId][bsId];if(blockFeedback.result===true){t.execManageStatus(targets);}});},execFormCreatePostBlock:function(pageSection,block,response){var t=this;var pssId=popManager.getSettingsId(pageSection);var bsId=popManager.getSettingsId(block);var blockFeedback=response.feedback.block[pssId][bsId];if(blockFeedback.result===true){popSystem.execDestroyPageOnUserLoggedOut(block);}
else{block.one('fetched',function(e,response){t.execFormCreatePostBlock(pageSection,block,response);});}},execManageStatus:function(targets){var t=this;targets.each(function(){var input_status=$(this);if(input_status.val()==M.POSTSTATUS.PUBLISH){input_status.find('option[value="'+M.POSTSTATUS.PENDING+'"]').attr('disabled','disabled');input_status.find('option[value="'+M.POSTSTATUS.PUBLISH+'"]').attr('disabled',false);}
else{input_status.find('option[value="'+M.POSTSTATUS.PUBLISH+'"]').attr('disabled','disabled');input_status.find('option[value="'+M.POSTSTATUS.PENDING+'"]').attr('disabled',false);}});},};})(jQuery);popJSLibraryManager.register(popForms,['formCreatePostBlock','manageStatus']);;(function($){popEditor={editor:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;block.one('rerender',function(action){t.destroy(targets);});var pageSectionPage=popManager.getPageSectionPage(block);pageSectionPage.one('destroy',function(){t.destroy(targets);});targets.each(function(){var editor=$(this).find('.pop-editor');var editorId=editor.attr('id');editor.closest('form').on('beforeSubmit',function(){if(tinymce.get(editorId)){tinymce.get(editorId).save();}});});targets.filter('.pop-editor-form-clear').each(function(){var editor=$(this).find('.pop-editor');var editorId=editor.attr('id');editor.closest('form').on('clear',function(){if(tinymce.get(editorId)){tinymce.get(editorId).setContent('');}});});if(!POP_CACHED_SETTINGS&&popManager.isFirstLoad(pageSection)){return;}
$(document).ready(function($){targets.each(function(){var editor=$(this).find('.pop-editor');var editorId=editor.attr('id');var settings=tinyMCEPreInit.mceInit[M.TEMPLATE_EDITOR_NAME];if(editor.hasClass('pop-editor-autofocus')){settings=$.extend({},settings,{auto_focus:editorId});}
tinyMCE.init(settings);tinymce.execCommand('mceAddEditor',true,editorId);var qtOptions=$.extend({},tinyMCEPreInit.qtInit[M.TEMPLATE_EDITOR_NAME],{id:editorId});quicktags(qtOptions);if(!window.wpActiveEditor){window.wpActiveEditor=editorId;}
if(typeof jQuery!=='undefined'){editor.closest('.wp-editor-wrap').on('click.wp-editor',function(){if(this.id){window.wpActiveEditor=this.id.slice(3,-5);}});}else{document.getElementById('wp-'+editorId+'-wrap').onclick=function(){window.wpActiveEditor=this.id.slice(3,-5);}}});});},destroy:function(targets){var t=this;targets.each(function(){var editor=$(this).find('.pop-editor');var editorId=editor.attr('id');tinymce.execCommand('mceRemoveEditor',false,editorId);});}};})(jQuery);popJSLibraryManager.register(popEditor,['editor']);;(function($){popMentions={previousData:{},documentInitialized:function(){var t=this;t.prefetch();},prefetch:function(){var t=this;$.each(M.MENTIONS.TYPES,function(delimiter,settings){t.fetchData(delimiter,settings.baseline);});},fetchData:function(delimiter,url,process){var t=this;var stored=popManager.getStoredData(url);if(stored){t.processData(delimiter,stored,process);}
else{$.getJSON(url,function(data){var ttl=86400000;popManager.storeData(url,data,ttl);t.processData(delimiter,data,process);});}},processData:function(delimiter,data,process){var t=this;t.previousData[delimiter]=data;if(process){process(data);}},source:function(query,process,delimiter){var t=this;if(M.MENTIONS.TYPES[delimiter]){var url;if(query){url=M.MENTIONS.TYPES[delimiter].url.replace(M.MENTIONS.QUERYWILDCARD,query);}
else{url=M.MENTIONS.TYPES[delimiter].baseline;}
if(url){var previousData=t.previousData[delimiter]||[];process(previousData);t.fetchData(delimiter,url,process);}}},render:function(item){var t=this;var delimiter=t.infereDelimiter(item);var html=popManager.getHtml(M.MENTIONS.TYPES[delimiter].template,item);return'<li><a href="javascript:;"><span>'+html+'</span></a></li>';},insert:function(item){var t=this;var delimiter=t.infereDelimiter(item);return'<span>'+delimiter+item[M.MENTIONS.TYPES[delimiter].key]+'</span>&nbsp;';},infereDelimiter:function(item){var t=this;var ret='';$.each(M.MENTIONS.TYPES,function(delimiter,settings){if(typeof item[settings.key]!='undefined'){ret=delimiter;return-1;}});return ret;},};})(jQuery);popJSLibraryManager.register(popMentions,['documentInitialized']);function mentions_source(query,process,delimiter){popMentions.source(query,process,delimiter);}
function mentions_insert(item){return popMentions.insert(item);}
function mentions_render(item){return popMentions.render(item);};(function($){popFeaturedImage={frame:null,documentInitialized:function(){var t=this;t.frame=wp.media({title:M.LABELS.MEDIA_FEATUREDIMAGE_TITLE,multiple:false,library:{type:'image'},button:{text:M.LABELS.MEDIA_FEATUREDIMAGE_BTN}});t.frame.on('open',function(){var featuredImage=$('.pop-featuredimage.open');var selected=featuredImage.find('input[type="hidden"]');if(selected.val()){var selection=t.frame.state().get('selection');attachment=wp.media.attachment(selected.val());attachment.fetch();selection.add(attachment?[attachment]:[]);}});t.frame.on('close',function(){var featuredImage=$('.pop-featuredimage.open');var configuration={};var selection=t.frame.state().get('selection');if(selection.length){var value,imgsrc;var imgSize=featuredImage.data('img-size');selection.map(function(attachment){attachment=attachment.toJSON();var imgData=attachment.sizes[imgSize]||attachment.sizes['medium']||attachment.sizes['thumbnail'];value=attachment.id;imgsrc={src:imgData.url,width:imgData.width,height:imgData.height};});var block=popManager.getBlock(featuredImage);var pageSection=popManager.getPageSection(block);t.merge(pageSection,block,featuredImage,value,imgsrc);}
featuredImage.removeClass('open');});},featuredImageSet:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();var button=$(this);var featuredImage=button.closest('.pop-featuredimage');featuredImage.addClass('open');t.frame.open();});},featuredImageRemove:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();var button=$(this);var featuredImage=button.closest('.pop-featuredimage');t.remove(pageSection,block,featuredImage);});},merge:function(pageSection,block,featuredImage,value,imgsrc){var t=this;var options={extendContext:{value:value,img:imgsrc}}
var template=featuredImage.data('merge-template');popManager.mergeTargetTemplate(pageSection,block,template,options);popManager.runJSMethods(pageSection,block,template,'full');},remove:function(pageSection,block,featuredImage){var t=this;t.merge(pageSection,block,featuredImage,'','');}};})(jQuery);popJSLibraryManager.register(popFeaturedImage,['documentInitialized','featuredImageSet','featuredImageRemove']);;(function($){popUserAccount={initialuserdata:false,loggedin:false,id:null,name:'',avatar:'',url:'',roles:[],userattributes:[],documentInitialized:function(){var t=this;t.checkpointInvalidateBlocks();if(t.initialuserdata){t.fetchLoggedInUserData();}},pageSectionInitialized:function(args){var t=this;var pageSection=args.pageSection;pageSection.on('fetched',function(e,options,url){t.feedbackLoginOut(false);});},blockInitialized:function(args){var t=this;var pageSection=args.pageSection,block=args.block;block.on('fetched',function(e){t.feedbackLoginOut(false);});},loadAvatar:function(args){var t=this;var targets=args.targets;targets.attr('src',t.avatar);},initialLogin:function(){var t=this;feedbackAvailable=t.feedbackLoginOut(true);t.initialuserdata=!feedbackAvailable;},fetchLoggedInUserData:function(options){var t=this;options=options||{};options['loadingmsg-target']=M.USERLOGGEDIN_LOADINGMSG_TARGET;options.silentDocument=true;popManager.fetch(M.USERLOGGEDIN_DATA_PAGEURL,options);},isLoggedIn:function(){var t=this;return t.loggedin;},updateUserInfo:function(id,name,avatar,url,roles,userattributes){var t=this;var updates={};if(t.name!=name){t.name=name;$('.pop-user-name').text(t.name);updates.name=t.name;}
if(t.id!=id||t.avatar!=avatar){t.id=id;t.avatar=avatar;$('.pop-user-avatar').attr('src',t.avatar);updates.avatar=t.avatar;}
if(t.url!=url){t.url=url;$('.pop-user-url').attr('href',t.url);updates.url=t.url;}
var eq_roles=$(t.roles).not(roles).length===0&&$(roles).not(t.roles).length===0;if(!eq_roles){t.roles=roles;$.each(M.ROLES,function(index,role){$('body').removeClass(role);});$.each(t.roles,function(index,role){$('body').addClass(role);});updates.roles=t.roles;}
var eq_userattributes=$(t.userattributes).not(userattributes).length===0&&$(userattributes).not(t.userattributes).length===0;if(!eq_userattributes){t.userattributes=userattributes;$.each(M.USERATTRIBUTES,function(index,userattribute){$('body').removeClass(userattribute);});$.each(t.userattributes,function(index,userattribute){$('body').addClass(userattribute);});updates.userattributes=t.userattributes;}
if(!$.isEmptyObject(updates)){updates.id=id;$(document).triggerHandler('user:updated',[updates]);}},loginout:function(source,loggedin,id,name,avatar,url,roles,userattributes){var t=this;t.updateUserInfo(id,name,avatar,url,roles,userattributes);if(t.loggedin!=loggedin){t.loggedin=loggedin;var name,body=$('body');if(t.loggedin){body.data('loggedinuser-id',id).addClass('loggedin user-'+id);name='user:loggedin';}
else{body.removeClass('loggedin').removeClass('user-'+body.data('loggedinuser-id')).data('loggedinuser-id','');name='user:loggedout';}
if(source!='initialfeedback'){t.closeCheckpointMessages();}
$(document).triggerHandler(name,[source]);$(document).triggerHandler('user:loggedinout',[source]);}},feedbackLoginOut:function(initial){var t=this;var topLevelFeedback=popManager.getTopLevelFeedback();var userInfo=topLevelFeedback[M.DATALOAD_USER];if(typeof userInfo!='undefined'){var loggedin,id,name,avatar,url;loggedin=userInfo[M.DATALOAD_USER_LOGGEDIN];id=userInfo[M.DATALOAD_USER_ID];name=userInfo[M.DATALOAD_USER_NAME];avatar=userInfo[M.DATALOAD_USER_AVATAR];url=userInfo[M.DATALOAD_USER_URL];roles=userInfo[M.DATALOAD_USER_ROLES];userattributes=userInfo[M.DATALOAD_USER_ATTRIBUTES];var source='feedback';if(initial){source='initialfeedback';}
else if(t.initialuserdata){source='initialuserdata';t.initialuserdata=false;}
t.loginout(source,loggedin,id,name,avatar,url,roles,userattributes);return true;}
return false;},checkpointInvalidateBlocks:function(){var t=this;$(document).on('user:loggedin',function(e,source){if(source=='initialfeedback'||source=='initialuserdata'){return;}
t.closeCheckpointMessages();});},closeCheckpointMessages:function(){var t=this;jQuery(document).ready(function($){$('.alert.in.pop-messagefeedback.checkpoint').removeClass('fade').alert('close');});},};})(jQuery);popJSLibraryManager.register(popUserAccount,['documentInitialized','pageSectionInitialized','blockInitialized','loadAvatar']);;(function($){popBootstrap={modal:function(args){var t=this;var targets=args.targets;targets.on('show.bs.modal',function(e){var modal=$(this);var link=$(e.relatedTarget);link=popManager.getOriginalLink(link);var modalHeader=link.data('header')||'';modal.find('.modal-header .pop-box').html(modalHeader);});},closeModals:function(){var t=this;$('.modal.in').modal('hide');},showingModal:function(modal){var t=this;return modal.hasClass('in');},popover:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;t.execPopover(pageSection,block,targets);},contentPopover:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;t.execPopover(pageSection,block,targets.find('a[data-popover-target]'));},tooltip:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;jQuery(document).ready(function($){var pageSectionPage=popManager.getPageSectionPage(targets);pageSectionPage.one('destroy',function(){targets.tooltip('destroy');});targets.each(function(){var tooltip=$(this);var container=popManager.getDOMContainer(pageSection,tooltip);var containerTarget='#'+container.attr('id');var options={placement:tooltip.data('tooltip-placement')||"top",title:tooltip.attr('title'),container:containerTarget,};tooltip.tooltip(options);});});},openParentCollapse:function(args){var t=this;var targets=args.targets;t.execOpenParentCollapse(targets);},alertCloseOnTimeout:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;var closeTime=targets.data('closetime')||3000;targets.data('close',true);targets.mouseenter(function(){targets.data('close',null);targets.addClass('hover');})
targets.mouseleave(function(){targets.data('close',true);t.execAlertCloseOnTimeout(targets,closeTime);targets.removeClass('hover');})
t.execAlertCloseOnTimeout(targets,closeTime);},execOpenParentCollapse:function(targets){var t=this;targets.closest('.collapse').not('.in').collapse('show');},execPopover:function(pageSection,block,targets){var t=this;jQuery(document).ready(function($){var pageSectionPage=popManager.getPageSectionPage(block);pageSectionPage.one('destroy',function(){targets.popover('destroy');});var container=popManager.getDOMContainer(pageSection,block);var containerTarget='#'+container.attr('id');var options={animation:false,html:true,trigger:'manual focus',placement:'auto',delay:{hide:100},container:containerTarget,};targets.each(function(){var popover=$(this);var popoverTarget=$(popover.data('popover-target')).first();if(popoverTarget.length){var content=popoverTarget.html();var blockTarget='#'+popManager.getBlock(popover).attr('id');content='<span data-block="'+blockTarget+'">'+content+'</span>';var popoverOptions=$.extend({},options,{content:content});popover.popover(popoverOptions).on("mouseenter",function(){var _this=this;$(this).popover("show");$(".popover").on("mouseleave",function(){$(_this).popover('hide');});}).on("mouseleave",function(){var _this=this;setTimeout(function(){if(!$(".popover:hover").length){$(_this).popover("hide")}},popoverOptions.delay.hide);});}});});},execAlertCloseOnTimeout:function(targets,closeTime){var t=this;setTimeout(function(){if(targets.data('close')){targets.alert('close');}},closeTime);},scrollTop:function(elem){var t=this;var modal=elem.closest('.modal').addBack('.modal');if(modal.length){modal.animate({scrollTop:0},'fast');return true;}
return false;},};})(jQuery);popJSLibraryManager.register(popBootstrap,['modal','closeModals','popover','contentPopover','tooltip','openParentCollapse','alertCloseOnTimeout']);;(function($){popBootstrapCarousel={carouselStatic:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;t.prepareCarousel(pageSection,block,targets);targets.carousel({interval:false,wrap:false});},carouselAutomatic:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;block.on('beforeReload',function(e){targets.carousel('pause');});t.prepareCarousel(pageSection,block,targets);if(carousel.find('.item.active').length){if(gdBootstrapCarousel.numberSlides(carousel)>=2){if($(window).width()>=768){carousel.carousel();}
else{carousel.carousel({interval:false,wrap:false});}
carousel.find('.pop-carousel-controls').removeClass('hidden');}
else{carousel.find('.pop-carousel-controls').addClass('hidden');}}},prepareCarousel:function(pageSection,block,targets){var t=this;block.on('rendered',function(){t.targetsAddActive(targets);});t.targetsAddActive(targets);},targetsAddActive:function(targets){var t=this;targets.each(function(){var carousel=$(this);t.addActive(carousel);});},addActive:function(carousel){var t=this;if(carousel.find('.item.active').length==0){carousel.find('.item:first-child').addClass('active');}},showElement:function(carousel,elem){var t=this;var slide=elem.closest('.item');var slideNumber=slide.parent().children().index(slide);t.slideTo(carousel,slideNumber);},slideTo:function(carousel,number){var t=this;carousel.carousel(number);},next:function(carousel){var t=this;carousel.carousel('next');},prev:function(carousel){var t=this;carousel.carousel('prev');},isFirstSlide:function(carousel){var t=this;return carousel.find('.item:first-child').hasClass('active');},isLastSlide:function(carousel){var t=this;return carousel.find('.item:last-child').hasClass('active');},isNthSlide:function(carousel,position){var t=this;return carousel.find('.item:nth-child('+position+')').hasClass('active');},isNthLastSlide:function(carousel,position){var t=this;return carousel.find('.item:nth-last-child('+position+')').hasClass('active');},numberSlides:function(carousel){var t=this;return carousel.find('.item').length;},};})(jQuery);(function($){popBootstrapCarouselControls={initBlockRuntimeMemory:function(args){var t=this;var pageSection=args.pageSection,block=args.block,mempage=args.runtimeMempage;mempage.carouselControls={};t.resetBlockRuntimeMemory(pageSection,block);},carouselControls:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;var carousel=t.getCarousel(targets);var controlNext=targets.children('.pop-carousel-control.right');t.controlCarouselNext(pageSection,block,carousel,targets,controlNext);var controlPrev=targets.children('.pop-carousel-control.left');t.controlCarouselPrev(pageSection,block,carousel,targets,controlPrev);block.on('fetchCompleted',function(e){t.handleReload(pageSection,block,targets);});t.setEnabledDisabled(pageSection,block,targets);},getRuntimeMemoryPage:function(pageSection,targetOrId){var t=this;return popManager.getRuntimeMemoryPage(pageSection,targetOrId).carouselControls;},resetBlockRuntimeMemory:function(pageSection,targetOrId){var t=this;var mempage=t.getRuntimeMemoryPage(pageSection,targetOrId);var empty={state:'',};$.extend(mempage,empty);},slideNext:function(pageSection,block,carousel,controlNext){var t=this;var blockParams=popManager.getBlockParams(pageSection,block);if(popBootstrapCarousel.isNthLastSlide(carousel,2)&&blockParams[M.URLPARAM_STOPFETCHING]){t.disable(controlNext);}
t.enable(controlNext.siblings('.pop-carousel-control.left'));popBootstrapCarousel.next(carousel);},controlCarouselNext:function(pageSection,block,carousel,carouselControls,control){var t=this;var blockParams=popManager.getBlockParams(pageSection,block);control.click(function(e){e.preventDefault();var control=$(this);if(t.disabled(control))return;if(popBootstrapCarousel.isLastSlide(carousel)){if(blockParams.loading.length||blockParams[M.URLPARAM_STOPFETCHING]){return;}
popManager.fetchBlock(pageSection,block,{operation:M.URLPARAM_OPERATION_APPEND});t.setControlState(pageSection,block,'loading');}
else{t.slideNext(pageSection,block,carousel,control);}});},controlCarouselPrev:function(pageSection,block,carousel,carouselControls,control){var t=this;control.click(function(e){e.preventDefault();var control=$(this);if(t.disabled(control))return;if(popBootstrapCarousel.isNthSlide(carousel,2)){t.disable(control);}
if(popBootstrapCarousel.numberSlides(carousel)>1){t.enable(control.siblings('.pop-carousel-control.right'));}
popBootstrapCarousel.prev(carousel);});},handleReload:function(pageSection,block,carouselControls){var t=this;var dataset=popManager.getBlockDataset(pageSection,block);t.setEnabledDisabled(pageSection,block,carouselControls);if(dataset&&dataset.length&&t.getControlState(pageSection,block)=='loading'){var carousel=t.getCarousel(carouselControls);var controlNext=carouselControls.children('.pop-carousel-control.right');t.slideNext(pageSection,block,carousel,controlNext);}
t.setControlState(pageSection,block,'');},getControlState:function(pageSection,block){var t=this;var mempage=t.getRuntimeMemoryPage(pageSection,block);return mempage.state;},setControlState:function(pageSection,block,state){var t=this;var mempage=t.getRuntimeMemoryPage(pageSection,block);mempage.state=state;},getCarousel:function(carouselControls){var t=this;return $(carouselControls.data('target'));},setEnabledDisabled:function(pageSection,block,carouselControls){var t=this;var carousel=t.getCarousel(carouselControls);var controlPrev=carouselControls.children('.pop-carousel-control.left');var controlNext=carouselControls.children('.pop-carousel-control.right');if(popBootstrapCarousel.numberSlides(carousel)==0){t.disable(controlPrev);t.disable(controlNext);}
else{if(popBootstrapCarousel.isFirstSlide(carousel)){t.disable(controlPrev);}
else{t.enable(controlPrev);}
var blockParams=popManager.getBlockParams(pageSection,block);if(popBootstrapCarousel.isLastSlide(carousel)&&blockParams[M.URLPARAM_STOPFETCHING]){t.disable(controlNext);}
else{t.enable(controlNext);}}},disable:function(control){var t=this;control.addClass('disabled');control.attr('disabled',true);},enable:function(control){var t=this;control.removeClass('disabled');control.attr('disabled',false);},disabled:function(control){var t=this;return control.hasClass('disabled');}};})(jQuery);popJSLibraryManager.register(popBootstrapCarousel,['carouselStatic','carouselAutomatic']);popJSLibraryManager.register(popBootstrapCarouselControls,['initBlockRuntimeMemory','controlCarouselPrev','controlCarouselNext','carouselControls']);;(function($){popWaypoints={documentInitialized:function(){var t=this;$(window).on('resized',function(){Waypoint.refreshAll();});},waypointsHistoryStateNew:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;jQuery(document).ready(function($){targets.each(function(){var target=$(this);var opts=t.getOptions(pageSection,target);var waypointUp=new Waypoint({element:target,handler:function(direction){var waypoint=this;var target=this.element;if(popManager.isHidden(target)){return;}
if(direction=='up'){popManager.historyReplaceState($(this));}},context:opts.context,offset:'bottom-in-view'});var waypointDown=new Waypoint({element:target,handler:function(direction){var waypoint=this;var target=this.element;if(popManager.isHidden(target)){return;}
if(direction=='down'){popManager.historyReplaceState($(this));}},context:opts.context});t.destroy(pageSection,block,waypointUp);t.destroy(pageSection,block,waypointDown);});});},waypointsHistoryStateOriginal:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;jQuery(document).ready(function($){targets.each(function(){var target=$(this);var opts=t.getOptions(pageSection,target);var waypoint=new Waypoint({element:target,handler:function(direction){var waypoint=this;var target=this.element;if(popManager.isHidden(target)){return;}
if(direction=='up'){popManager.historyReplaceState(target);}},context:opts.context});t.destroy(pageSection,block,waypoint);});});},waypointsToggleCollapse:function(args){var t=this;var targets=args.targets;jQuery(document).ready(function($){targets.each(function(){var collapse=$(this);var target=$(collapse.data('collapse-target'));if(target.length){var block=popManager.getBlock(target);var pageSection=popManager.getBlock(block);t.execWaypointsToggleCollapse(pageSection,block,target,collapse);}});});},waypointsTheater:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;jQuery(document).ready(function($){targets.each(function(){var target=$(this);var opts=t.getOptions(pageSection,target);var waypoint=new Waypoint({element:target,handler:function(direction){var waypoint=this;var target=this.element;if(popManager.isHidden(target)){return;}
if(direction=='down'){popPageSectionManager.theater(true);}
else if(direction=='up'){popPageSectionManager.theater(false);}},context:opts.context});t.destroy(pageSection,block,waypoint);});});},waypointsFetchMore:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;jQuery(document).ready(function($){var waypoints=[];var contentLoaded=popManager.isContentLoaded(pageSection,block);targets.each(function(){var target=$(this);var opts=t.getOptions(pageSection,target);var waypoint=new Waypoint({element:target,handler:function(direction){var waypoint=this;var target=this.element;if(direction=='down'){if(popManager.isHidden(target)){return;}
target.trigger('click');}},context:opts.context,enabled:contentLoaded,offset:'bottom-in-view'});t.destroy(pageSection,block,waypoint);waypoints.push(waypoint);});block.on('fetchCompleted',function(e){var block=$(this);var blockParams=popManager.getBlockParams(pageSection,block);if(blockParams[M.URLPARAM_STOPFETCHING]){$.each(waypoints,function(index,waypoint){if(waypoint.enabled){waypoint.disable();t.reEnable(pageSection,block,waypoint);}});}
else{$.each(waypoints,function(index,waypoint){if(!waypoint.enabled){waypoint.enable();}
waypoint.context.refresh();});}});});},reEnable:function(pageSection,block,waypoint){var t=this;block.one('beforeReload',function(){block.one('fetchCompleted',function(){var blockParams=popManager.getBlockParams(pageSection,block);if(!blockParams[M.URLPARAM_STOPFETCHING]){waypoint.enable();}
else{t.reEnable(pageSection,block,waypoint);}});});},execWaypointsToggleCollapse:function(pageSection,block,target,collapse){var t=this;var opts=t.getOptions(pageSection,target);var waypoint=new Waypoint({element:target,handler:function(direction){var waypoint=this;var target=this.element;if(popManager.isHidden(target)){return;}
if(direction=='down'){collapse.collapse('show');}
else if(direction=='up'){collapse.collapse('hide');}},context:opts.context});t.destroy(pageSection,block,waypoint);},getOptions:function(pageSection,waypoint){var t=this;var options={};var context=pageSection.filter('.pop-waypoints-context');if(context.length){options.context=context;}
else{context=waypoint.closest('.pop-waypoints-context');if(context.length){options.context=context;}}
return options;},destroy:function(pageSection,block,waypoint){var t=this;var pageSectionPage=popManager.getPageSectionPage(block);pageSectionPage.one('destroy',function(){waypoint.destroy();});},};})(jQuery);popJSLibraryManager.register(popWaypoints,['documentInitialized','waypointsFetchMore','waypointsToggleCollapse','waypointsTheater','waypointsHistoryStateOriginal','waypointsHistoryStateNew']);;(function($){popWindow={windowSize:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.click(function(e){e.preventDefault();var control=$(this);var target=$(control.data('target'));if(target.length){var action=control.data('toggle');if(action=='window-fullsize'){t.fullsize(target);}
else if(action=='window-maximize'){t.maximize(target);}
else if(action=='window-minimize'){t.minimize(target);}}});},getSize:function(target){var t=this;if(target.hasClass('fullsize')){return'fullsize';}
else if(target.hasClass('maximized')){return'maximized';}
else if(target.hasClass('minimized')){return'minimized';}
return null;},fullsize:function(target){var t=this;target.removeClass('maximized minimized').addClass('fullsize');target.triggerHandler('fullsize.bs.window');},maximize:function(target){var t=this;target.removeClass('fullsize minimized').addClass('maximized');target.triggerHandler('maximized.bs.window');},minimize:function(target){var t=this;target.removeClass('fullsize maximized').addClass('minimized');target.triggerHandler('minimized.bs.window');},};})(jQuery);popJSLibraryManager.register(popWindow,['windowSize']);;(function($){popMultiselect={multiselect:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;var pageSectionPage=popManager.getPageSectionPage(block);pageSectionPage.one('destroy',function(){targets.multiselect('destroy');});var options={buttonClass:'btn btn-default',buttonContainer:'<div class="btn-group multiselect-btn-group" />',enableHTML:true,nonSelectedText:M.MULTISELECT_NONSELECTEDTEXT,nSelectedText:M.MULTISELECT_NSELECTEDTEXT,allSelectedText:M.MULTISELECT_ALLSELECTEDTEXT};targets.each(function(){var multiselect=$(this);var customOptions=$.extend({},options);if(multiselect.attr('title')){customOptions['nonSelectedText']=multiselect.attr('title');}
if(multiselect.hasClass('input-sm')){customOptions['buttonClass']+=' btn-sm';}
if(multiselect.hasClass('input-lg')){customOptions['buttonClass']+=' btn-lg';}
multiselect.multiselect(customOptions);});}};})(jQuery);popJSLibraryManager.register(popMultiselect,['multiselect']);;(function($){popDynamicMaxHeight={dynamicMaxHeight:function(args){var t=this;var targets=args.targets;targets.dynamicMaxHeight();}};})(jQuery);popJSLibraryManager.register(popDynamicMaxHeight,['dynamicMaxHeight']);;(function($){popDateRange={dateRange:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;var format=M.DATERANGE_FORMAT||'DD/MM/YYYY';var settings={autoUpdateInput:false,autoApply:true,linkedCalendars:true,showWeekNumbers:false,timePicker:false,buttonClasses:['btn'],applyClass:'btn-success',cancelClass:'btn-warning',format:format,separator:M.DATERANGE_SEPARATOR,locale:{applyLabel:M.DATERANGE_APPLY,cancelLabel:M.DATERANGE_CANCEL,fromLabel:M.DATERANGE_FROM,toLabel:M.DATERANGE_TO,customRangeLabel:M.DATERANGE_CUSTOMRANGE,daysOfWeek:M.DATERANGE_DAYSOFWEEK,monthNames:M.DATERANGE_MONTHNAMES,firstDay:1}};var daterange_past={maxDate:moment().add(1,'days')};var daterange_future={minDate:moment().subtract(1,'days')};var opens_right={opens:'right'};var opens_left={opens:'left'};targets.each(function(){var daterange=$(this);var settings_opens=daterange.hasClass('opens-left')?opens_left:opens_right;var container_settings={parentEl:'#'+popManager.getDOMContainer(pageSection,daterange).attr('id')};var daterange_settings=$.extend({},settings,settings_opens,container_settings);if(daterange.hasClass('daterange-future')&&!daterange.hasClass('daterange-past')){$.extend(daterange_settings,daterange_future);}
else if(daterange.hasClass('daterange-past')&&!daterange.hasClass('daterange-future')){$.extend(daterange_settings,daterange_past);}
if(daterange.hasClass('timepicker')){var timeformat=M.DATERANGE_TIMEFORMAT||'h:mm A';daterange_settings.locale.format=format+' '+timeformat;var timePicker={autoApply:false,timePicker:true,timePicker24Hour:(timeformat!='h:mm A'),timePickerIncrement:15};$.extend(daterange_settings,timePicker);}
daterange.on('apply.daterangepicker',function(ev,picker){$(this).val(picker.startDate.format(picker.locale.format)+' - '+picker.endDate.format(picker.locale.format));});daterange.daterangepicker(daterange_settings,t.callback);});},callback:function(start,end){var t=this;var dateinput=t.element;dateinput.siblings('.from').val(start.format('YYYY-MM-DD'));dateinput.siblings('.to').val(end.format('YYYY-MM-DD'));if(dateinput.siblings('.fromtime').length){dateinput.siblings('.fromtime').val(start.format('HH:mm'));dateinput.siblings('.totime').val(end.format('HH:mm'));}}};})(jQuery);popJSLibraryManager.register(popDateRange,['dateRange']);;(function($){popTypeahead={typeaheadSearchBtn:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(){var control=$(this);var typeahead=control.closest('.pop-typeahead');t.executeTypeaheadSearch(pageSection,block,typeahead);});},typeaheadSearchInput:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.keypress(function(e){if(event.which==13){event.preventDefault();var searchbox=$(this);var typeahead=searchbox.closest('.pop-typeahead');var input=typeahead.find('input[type="text"].tt-input');input.typeahead('close');t.executeTypeaheadSearch(pageSection,block,typeahead);}});},fillTypeahead:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.each(function(){var typeahead=$(this);var urlparam=typeahead.data('urlparam');if(urlparam){var url=block.data('paramsscope-url');var values=getParam(urlparam,url);if(values){var database_key=typeahead.data('database-key');$.each(values,function(key,value){var datum=popManager.getItemObject(database_key,value);t.selectTypeahead(pageSection,block,typeahead,datum);});popBootstrap.execOpenParentCollapse(typeahead);}}});},selectDatum:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();var link=$(this);var typeahead=$(link.data('target'));var value=link.data('objectid');var database_key=link.data('db-key');var datum=popManager.getItemObject(database_key,value);t.selectTypeahead(pageSection,block,typeahead,datum);});},selectableTypeahead:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;t.typeahead(pageSection,block,targets);targets.each(function(){var typeahead=$(this);t.validateMaxSelected(pageSection,block,typeahead);typeahead.bind('typeahead:selected',function(obj,datum,name){var typeahead=$(this);t.selectTypeahead(pageSection,block,typeahead,datum);});});},fetchlinkTypeahead:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;t.typeahead(pageSection,block,targets);targets.each(function(){var typeahead=$(this);typeahead.bind('typeahead:selected',function(obj,datum,name){var selected=$(this);var typeahead=selected.closest('.pop-typeahead');popManager.click(datum.url,typeahead);});});},selectableTypeaheadTrigger:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.on('close.bs.alert',function(){var alert=$(this);var typeahead=alert.closest('.pop-typeahead');var disable=t.getElementsToDisable(typeahead);disable.attr('disabled',false);disable.removeClass('disabled');var val=alert.children('input[type="hidden"]').val();typeahead.triggerHandler('close',[alert,val]);});},selectTypeahead:function(pageSection,block,typeahead,datum){var t=this;var input=typeahead.find('input[type="text"].tt-input');t.triggerSelect(pageSection,block,typeahead,datum);input.typeahead('val','');},executeTypeaheadSearch:function(pageSection,block,typeahead){var t=this;var input=typeahead.find('input[type="text"].tt-input');var url=popManager.getQueryUrl(pageSection,block);var val=input.typeahead('val');if(val){url=url.replace('%QUERY',input.typeahead('val'));popManager.click(url,typeahead);}},getElementsToDisable:function(typeahead){var t=this;return typeahead.children('div.pop-operation').find('a, button, input');},typeahead:function(pageSection,block,targets){var t=this;var pageSectionPage=popManager.getPageSectionPage(block);pageSectionPage.one('destroy',function(){t.destroy(targets);});block.one('rerender',function(action){t.destroy(targets);});targets.each(function(){var typeahead=$(this);var input=typeahead.find('input[type="text"]');var jsSettings=popManager.getJsSettings(pageSection,block,typeahead);var dataset=[];$.each(jsSettings['dataset-components'],function(index,component){var datasetJsSettings=popManager.getJsSettings(pageSection,block,component);dataset.push(datasetJsSettings['dataset']);});$.each(dataset,function(index,datasetunit){var layout=datasetunit['layout'];datasetunit.template=popManager.getScriptTemplate(layout);});var bloodhounds=[];var settings=[];var search;$.each(dataset,function(index,datasetunit){var limit=datasetunit.limit;if(dataset.length>1){if(limit>3){limit=3;}}
var options={datumTokenizer:function(d){var tokens=[];$.each(datasetunit.tokenizerKeys,function(index,tokenizerKey){tokens=tokens.concat(Bloodhound.tokenizers.whitespace(d[tokenizerKey]));});return tokens;},queryTokenizer:Bloodhound.tokenizers.whitespace,};if(datasetunit.local){options.local=datasetunit.local;}
if(datasetunit.prefetch){options.prefetch={url:datasetunit.prefetch,thumbprint:datasetunit.thumbprint};}
if(datasetunit.remote){options.remote={url:datasetunit.remote,wildcard:'%QUERY'};}
var bloodhound=new Bloodhound(options);bloodhounds.push(bloodhound);var source;if(datasetunit.staticSuggestions){source=function(query,cb){var result=[];$.each(datasetunit.staticSuggestions,function(index,staticSuggestion){var suggestion={};$.each(staticSuggestion,function(key,value){if(typeof value=='string'){value=value.replace('%QUERY',query);}
suggestion[key]=value;});result.push(suggestion);});cb(result);};}
else{source=bloodhound.ttAdapter();}
settings.push({source:source,name:datasetunit.name,display:datasetunit.valueKey,limit:limit,templates:{suggestion:datasetunit.template,header:datasetunit.header,pending:datasetunit.pending,notFound:datasetunit.notFound,}});});$.each(bloodhounds,function(index,bloodhound){bloodhound.initialize();});if(settings.length==1){input.typeahead({highlight:true},settings[0]);}
else if(settings.length==2){input.typeahead({highlight:true},settings[0],settings[1]);}
else if(settings.length==3){input.typeahead({highlight:true},settings[0],settings[1],settings[2]);}
else if(settings.length==4){input.typeahead({highlight:true},settings[0],settings[1],settings[2],settings[3]);}});},triggerSelect:function(pageSection,block,typeahead,datum){var t=this;if(typeahead.find('input[type="hidden"][value="'+datum.id+'"]').length==0){var jsSettings=popManager.getJsSettings(pageSection,block,typeahead);var template=jsSettings['trigger-layout'];var pssId=popManager.getSettingsId(pageSection);var bsId=popManager.getSettingsId(block);var context=$.extend({itemObject:datum},jsSettings['datum-context']);var options={extendContext:context}
var html=popManager.getTemplateHtml(pageSection,block,template,options);popManager.mergeHtml(html,typeahead.find('.pop-box'));popManager.runJSMethods(pageSection,block,template,'last');popJSRuntimeManager.deleteBlockLastSessionIds(pageSection,block,template);t.validateMaxSelected(pageSection,block,typeahead);typeahead.triggerHandler('selected',[datum]);}},validateMaxSelected:function(pageSection,block,typeahead){var t=this;if(typeahead.data('max-selected')){var numSelected=typeahead.find('input[type="hidden"]').length;if(numSelected==typeahead.data('max-selected')){var disable=t.getElementsToDisable(typeahead);disable.attr('disabled','disabled');disable.addClass('disabled');}}},removeSelected:function(typeahead,id){var t=this;var selected=typeahead.find('input[type="hidden"][value="'+id+'"]');var alert=selected.closest('.alert');alert.alert('close');},destroy:function(targets){var t=this;targets.find('input[type="text"].tt-input').typeahead('destroy');}};})(jQuery);popJSLibraryManager.register(popTypeahead,['selectableTypeahead','fillTypeahead','selectDatum','fetchlinkTypeahead','selectableTypeaheadTrigger','typeaheadSearchBtn','typeaheadSearchInput']);;(function($){popModals={modalForm:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.on('show.bs.modal',function(e){var modal=$(this);var link=$(e.relatedTarget);var blocks=$(modal.data('initjs-targets'));blocks.each(function(){var block=$(this);popManager.closeMessageFeedback(block);})});}};})(jQuery);popJSLibraryManager.register(popModals,['modalForm']);;(function($){popGA={documentInitialized:function(){var t=this;var _gaq=_gaq||[];_gaq.push(['_setAccount',M.GOOGLEANALYTICS]);_gaq.push(['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();},replaceState:function(args){var t=this;_gaq.push(['_trackPageview']);},};})(jQuery);popJSLibraryManager.register(popGA,['documentInitialized','replaceState']);;(function($){popPerfectScrollbar={scrollbarHorizontal:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;jQuery(document).ready(function($){targets.perfectScrollbar({suppressScrollY:true});});},scrollbarVertical:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;jQuery(document).ready(function($){targets.perfectScrollbar({suppressScrollX:true});});},doScroll:function(scrollbar,x,animate){var t=this;if(animate){scrollbar.animate({scrollTop:x});}
else{scrollbar.scrollTop(x);}
scrollbar.perfectScrollbar('update');},scrollToElem:function(elem,position,animate){var t=this;var scrollbar=elem.closest('.perfect-scrollbar').addBack('.perfect-scrollbar');if(scrollbar.length){var x=0;if(position){var offsetReference=scrollbar.children('.perfect-scrollbar-offsetreference');if(!offsetReference.length){offsetReference=elem;}
x=position.offset().top-offsetReference.offset().top;}
t.doScroll(scrollbar,x,animate);return true;}
return false;},getPosition:function(elem){var t=this;var scrollbar=elem.closest('.perfect-scrollbar').addBack('.perfect-scrollbar');if(scrollbar.length){var offsetReference=scrollbar.children('.perfect-scrollbar-offsetreference');if(offsetReference.length){return offsetReference.position().top*-1;}}
return 0;},scrollTop:function(elem,top,animate){var t=this;top=top||0;var scrollbar=elem.closest('.perfect-scrollbar').addBack('.perfect-scrollbar');if(scrollbar.length){t.doScroll(scrollbar,top,animate);return true;}
return false;},};})(jQuery);popJSLibraryManager.register(popPerfectScrollbar,['scrollbarHorizontal','scrollbarVertical']);;(function($){popFunctions={expandJSKeys:function(args){var t=this;var context=args.context;if(context[M.JS_FONTAWESOME]){context.fontawesome=context[M.JS_FONTAWESOME];}
if(context[M.JS_DESCRIPTION]){context.description=context[M.JS_DESCRIPTION];}},beep:function(args){beep();},showmore:function(args){var t=this;var targets=args.targets;targets.find(".pop-showmore-more").click(function(e){e.preventDefault();var link=$(this);var content=link.closest('.pop-content');content.find(".pop-showmore-more").addClass('hidden');content.find(".pop-showmore-less").removeClass('hidden');content.find(".pop-showmore-more-full").removeClass('hidden');});targets.find(".pop-showmore-less").click(function(e){e.preventDefault();var link=$(this);var content=link.closest('.pop-content');content.find(".pop-showmore-less").addClass('hidden');content.find(".pop-showmore-more").removeClass('hidden');content.find(".pop-showmore-more-full").addClass('hidden');});},hideEmpty:function(args){var t=this;var targets=args.targets;targets.closest('.pop-hide-empty').addClass('hidden');},imageResponsive:function(args){var t=this;var targets=args.targets;targets.find('div.pop-content').addBack('div.pop-content').find('img, .wp-caption').addClass('img-responsive');},printWindow:function(args){var t=this;var action=getParam(M.URLPARAM_ACTION,window.location.href);if(action==M.URLPARAM_ACTION_PRINT){jQuery(document).ready(function($){window.print();});}},copyHeader:function(args){var t=this;var targets=args.targets,link=args.relatedTarget;if(link){link=popManager.getOriginalLink(link);var header=link.data('header');if(header){targets.find('.pop-header').removeClass('hidden').find('.pop-box').html(header);}}},fillURLParamInput:function(args){var t=this;var block=args.block,targets=args.targets;targets.each(function(){var input=$(this);var val=t.getURLParamInputValue(block,input);input.val(val);});},fillAddonInput:function(args){var t=this;var targets=args.targets,link=args.relatedTarget;if(link){targets.each(function(){var input=$(this);t.fillInput(input,link);});}},fillModalInput:function(args){var t=this;var targets=args.targets;targets.each(function(){var input=$(this);var modal=input.closest('.modal');modal.on('show.bs.modal',function(e){var link=$(e.relatedTarget);t.fillInput(input,link);});});},fillAddonURLInput:function(args){var t=this;var targets=args.targets,link=args.relatedTarget;if(link){targets.each(function(){var input=$(this);t.fillURLInput(input,link);});}},fillModalURLInput:function(args){var t=this;var targets=args.targets;targets.each(function(){var input=$(this);var modal=input.closest('.modal');modal.on('show.bs.modal',function(e){var link=$(e.relatedTarget);t.fillURLInput(input,link);});});},switchTargetClass:function(args){var t=this;var targets=args.targets;targets.click(function(e){var button=$(this);if(button.is('a[href="#"]')){e.preventDefault();}
var target=$(button.data('target'))||$('body');var mode=button.data('mode')||'add';var classs=button.data('class');if(mode=='add'){target.addClass(classs);}
else if(mode=='remove'){target.removeClass(classs);}
else if(mode=='toggle'){target.toggleClass(classs);}});},doNothing:function(args){var t=this;var targets=args.targets;targets.click(function(e){e.preventDefault();});},fetchMore:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;block.on('beforeFetch',function(e,options){if(!options['skip-status']){targets.button('loading');}});block.on('fetchCompleted',function(e){var blockParams=popManager.getBlockParams(pageSection,block);if(blockParams[M.URLPARAM_STOPFETCHING]){targets.addClass('hidden');}
else{targets.removeClass('hidden');targets.button('reset');}});targets.click(function(e){e.preventDefault();popManager.fetchBlock(pageSection,block,{operation:M.URLPARAM_OPERATION_APPEND});});},fetchMoreDisable:function(args){var t=this;var block=args.block,targets=args.targets;block.on('beforeFetch',function(e,options){if(!options['skip-status']){targets.addClass('disabled').attr('disabled','disabled');}});block.on('fetchCompleted',function(e){targets.removeClass('disabled').attr('disabled',false);});},saveLastClicked:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){var clicked=$(this);block.find('[data-action="retry"]').data('lastclicked','#'+clicked.attr('id')).removeClass('hidden');});},retrySendRequest:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();var retryBtn=$(this);if(retryBtn.data('lastclicked')){$(retryBtn.data('lastclicked')).trigger('click');}})},highlight:function(args){var t=this;var targets=args.targets;targets.each(function(){var target=$(this);var pageSection=popManager.getPageSection(target);popManager.scrollToElem(pageSection,target,true);});},embedCode:function(args){var t=this;var targets=args.targets;targets.each(function(){var input=$(this);var modal=input.closest('.modal');modal.on('show.bs.modal',function(e){var link=$(e.relatedTarget);var url=t.getUrl(link,true);url=popManager.getEmbedUrl(url);t.execReplaceCode(input,url);});});},modalReloadEmbedPreview:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var iframe=$(this);var block=popManager.getBlock(iframe);var modal=block.closest('.modal');modal.on('show.bs.modal',function(e){var link=$(e.relatedTarget);var url=t.getUrl(link,true);url=popManager.getEmbedUrl(url);t.embedPreview(pageSection,block,iframe,url);});});},reloadEmbedPreview:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.each(function(){var connector=$(this);var input=$(connector.data('input-target'));input.change(function(){var input=$(this);t.embedPreviewFromInput(pageSection,block,connector);});t.embedPreviewFromInput(pageSection,block,connector);});},replaceCode:function(args){var t=this;var targets=args.targets;targets.each(function(){var input=$(this);var modal=input.closest('.modal');modal.on('show.bs.modal',function(e){var link=$(e.relatedTarget);t.execReplaceCode(input,t.getUrl(link));});});},socialmedia:function(args){var t=this;var targets=args.targets;targets.one('mouseenter',function(){var socialmedia=$(this);socialmedia.children('a.socialmedia-item').each(function(){var item=$(this);var provider=item.data('provider');if(provider){var settings=M.SOCIALMEDIA[provider];if(settings){$.ajax({type:'GET',dataType:settings.dataType,url:settings['counter-url'].replace('%s',item.data('url')),success:function(json){if(!json.hasOwnProperty(settings.property))
return;var count=json[settings.property];if(count==0)return;item.children('.pop-counter').html(count);}});}}});});},mediaplayer:function(args){var t=this;var targets=args.targets;targets.mediaelementplayer();},reset:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.click(function(e){e.preventDefault();var button=$(this);var block=popManager.getBlock(button);popManager.reset(pageSection,block);popManager.closeMessageFeedback(block);});},browserUrl:function(args){var t=this;var targets=args.targets;targets.closest('form').on('beforeSubmit',function(){var url=window.location.href;targets.val(url);})},smallScreenHideCollapse:function(args){var t=this;var targets=args.targets;if($(window).width()<768){var targets=args.targets;targets.collapse('hide');}},cookies:function(args){var t=this;var targets=args.targets;targets.each(function(){var cookie=$(this);if(!($.cookie(cookie.data('cookieid')))){cookie.removeClass('hidden');}
cookie.children("button.close").click(function(e){e.preventDefault();var cookie=$(this).parent('.cookie');$.cookie(cookie.data('cookieid'),"dismissed",{expires:90,path:"/"});});});},cookieToggleClass:function(args){var t=this;var pageSection=args.pageSection,targets=args.targets;targets.each(function(){var container=$(this);var cookieid=container.data('cookieid');t.cookieToggleClassInitial(pageSection,container);if(container.data('deletecookiebtn')){var selector=container.data('deletecookiebtn');var btn=(selector=='self'?container:$(selector));btn.click(function(e){$.cookie(cookieid,null,{expires:-1,path:"/"});});}
if(container.data('setcookiebtn')){var selector=container.data('setcookiebtn');var btn=(selector=='self'?container:$(selector));btn.click(function(e){$.cookie(cookieid,"dismissed",{expires:180,path:"/"});});}
if(container.data('togglecookiebtn')){var selector=container.data('togglecookiebtn');var btn=(selector=='self'?container:$(selector));btn.click(function(e){if($.cookie(cookieid)){$.cookie(cookieid,null,{expires:-1,path:"/"});}
else{$.cookie(cookieid,"dismissed",{expires:180,path:"/"});}});}});},sortable:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.sortable({cursor:"move"});},onActionThenClick:function(args){var t=this;var targets=args.targets;targets.each(function(){var clickable=$(this);var trigger=$(clickable.data('triggertarget'));var action=clickable.data('trigger-action')||'click';if(clickable.data('triggertarget-internal')){trigger=trigger.find(clickable.data('triggertarget-internal'));}
trigger.on(action,function(e){clickable.trigger('click');});});},cookieToggleClassInitial:function(pageSection,container){var t=this;var cookieid=container.data('cookieid');if(!$.cookie(cookieid)){var target=$(container.data('cookietarget'));var collapse=container.data('cookiecollapse');if(collapse){jQuery(document).ready(function($){target.collapse(collapse);});}
var classs=container.data('cookieclass');if(classs){target.addClass(classs);}}},embedPreviewFromInput:function(pageSection,block,connector){var t=this;var input=$(connector.data('input-target'));var url=input.val();if(url&&isUrlValid(url)){var iframe=$(connector.data('iframe-target'));var merged=t.embedPreview(pageSection,block,iframe,url);connector.data('iframe-target','#'+merged.targetContainer.attr('id'));}},getURLParamInputValue:function(block,input){var t=this;var val,urlparam=input.data('urlparam');if(urlparam){var url=block.data('paramsscope-url');val=getParam(urlparam,url);}
return val||'';},embedPreview:function(pageSection,block,iframe,url){var t=this;var options={operation:M.URLPARAM_OPERATION_REPLACEINLINE,extendContext:{src:url},'merge-target':'#'+iframe.attr('id')}
var template=iframe.data('templateid');var merged=popManager.mergeTargetTemplate(pageSection,block,template,options);popManager.runJSMethods(pageSection,block,template,'full');return merged;},fillInput:function(input,link){var t=this;link=popManager.getOriginalLink(link);var val,attr=input.data('attr');if(attr){val=link.data(attr);}
val=val||'';input.val(val);},fillURLInput:function(input,link){var t=this;link=popManager.getOriginalLink(link);var url=t.getUrl(link);input.val(url);},getUrl:function(link,use_pageurl){var t=this;link=popManager.getOriginalLink(link);var url=link.data('target-url');if(!url){var blockTarget=$(link.data('blocktarget'));var pageSection=popManager.getPageSection(blockTarget);url=popManager.getBlockFilteringUrl(pageSection,blockTarget,use_pageurl);}
return url;},execReplaceCode:function(input,url){var t=this;var placeholder=input.data('code-placeholder');var code=placeholder.format(url);input.val(code);},};})(jQuery);popJSLibraryManager.register(popFunctions,['expandJSKeys','showmore','hideEmpty','imageResponsive','printWindow','copyHeader','fillURLParamInput','fillAddonInput','fillModalInput','fillAddonURLInput','fillModalURLInput','switchTargetClass','doNothing','fetchMore','fetchMoreDisable','saveLastClicked','retrySendRequest','highlight','replaceCode','modalReloadEmbedPreview','reloadEmbedPreview','embedCode','socialmedia','mediaplayer','reset','browserUrl','smallScreenHideCollapse','cookies','cookieToggleClass','sortable','onActionThenClick','beep']);;(function($){popBlockFunctions={hideIfEmptyBlock:function(args){var t=this;var pageSection=args.pageSection,block=args.block;if(popManager.hideIfEmpty(pageSection,block)){block.addClass('hidden');}
else{block.removeClass('hidden');}}};})(jQuery);popJSLibraryManager.register(popBlockFunctions,['hideIfEmptyBlock']);;(function($){popControls={controlPrint:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();var control=$(this);var url=t.getBlockFilteringUrl(pageSection,control,true);url=popManager.getPrintUrl(url);popSystem.openPrint(url);});},controlSocialMedia:function(args){var t=this;var pageSection=args.pageSection,block=args.block,targets=args.targets;targets.click(function(e){e.preventDefault();var control=$(this);var url=t.getBlockFilteringUrl(pageSection,control,true);var provider=control.data('provider');var settings=M.SOCIALMEDIA[provider];var shareUrl=settings['share-url'].replace(new RegExp('%url%','g'),encodeURIComponent(url)).replace(new RegExp('%title%','g'),encodeURIComponent(popManager.documentTitle));popSystem.openSocialMedia(shareUrl);});},getBlockFilteringUrl:function(pageSection,control,use_pageurl){var t=this;var targetBlock=$(control.data('blocktarget'));return popManager.getBlockFilteringUrl(pageSection,targetBlock,use_pageurl);},};})(jQuery);popJSLibraryManager.register(popControls,['controlPrint','controlSocialMedia']);
;/*
 jquery.fullscreen 1.1.5
 https://github.com/kayahr/jquery-fullscreen-plugin
 Copyright (C) 2012-2013 Klaus Reimer <k@ailis.de>
 Licensed under the MIT license
 (See http://www.opensource.org/licenses/mit-license)
*/
function d(c){var b,a;if(!this.length)return this;b=this[0];b.ownerDocument?a=b.ownerDocument:(a=b,b=a.documentElement);if(null==c){if(!a.exitFullscreen&&!a.webkitExitFullscreen&&!a.webkitCancelFullScreen&&!a.msExitFullscreen&&!a.mozCancelFullScreen)return null;c=!!a.fullscreenElement||!!a.msFullscreenElement||!!a.webkitIsFullScreen||!!a.mozFullScreen;return!c?c:a.fullscreenElement||a.webkitFullscreenElement||a.webkitCurrentFullScreenElement||a.msFullscreenElement||a.mozFullScreenElement||c}c?(c=
b.requestFullscreen||b.webkitRequestFullscreen||b.webkitRequestFullScreen||b.msRequestFullscreen||b.mozRequestFullScreen)&&c.call(b):(c=a.exitFullscreen||a.webkitExitFullscreen||a.webkitCancelFullScreen||a.msExitFullscreen||a.mozCancelFullScreen)&&c.call(a);return this}jQuery.fn.fullScreen=d;jQuery.fn.toggleFullScreen=function(){return d.call(this,!d.call(this))};var e,f,g;e=document;
e.webkitCancelFullScreen?(f="webkitfullscreenchange",g="webkitfullscreenerror"):e.msExitFullscreen?(f="MSFullscreenChange",g="MSFullscreenError"):e.mozCancelFullScreen?(f="mozfullscreenchange",g="mozfullscreenerror"):(f="fullscreenchange",g="fullscreenerror");jQuery(document).bind(f,function(){jQuery(document).trigger(new jQuery.Event("fullscreenchange"))});jQuery(document).bind(g,function(){jQuery(document).trigger(new jQuery.Event("fullscreenerror"))});
;!function($){"use strict";if(typeof ko!=='undefined'&&ko.bindingHandlers&&!ko.bindingHandlers.multiselect){ko.bindingHandlers.multiselect={after:['options','value','selectedOptions'],init:function(element,valueAccessor,allBindings,viewModel,bindingContext){var $element=$(element);var config=ko.toJS(valueAccessor());$element.multiselect(config);if(allBindings.has('options')){var options=allBindings.get('options');if(ko.isObservable(options)){ko.computed({read:function(){options();setTimeout(function(){var ms=$element.data('multiselect');if(ms)
ms.updateOriginalOptions();$element.multiselect('rebuild');},1);},disposeWhenNodeIsRemoved:element});}}
if(allBindings.has('value')){var value=allBindings.get('value');if(ko.isObservable(value)){ko.computed({read:function(){value();setTimeout(function(){$element.multiselect('refresh');},1);},disposeWhenNodeIsRemoved:element}).extend({rateLimit:100,notifyWhenChangesStop:true});}}
if(allBindings.has('selectedOptions')){var selectedOptions=allBindings.get('selectedOptions');if(ko.isObservable(selectedOptions)){ko.computed({read:function(){selectedOptions();setTimeout(function(){$element.multiselect('refresh');},1);},disposeWhenNodeIsRemoved:element}).extend({rateLimit:100,notifyWhenChangesStop:true});}}
ko.utils.domNodeDisposal.addDisposeCallback(element,function(){$element.multiselect('destroy');});},update:function(element,valueAccessor,allBindings,viewModel,bindingContext){var $element=$(element);var config=ko.toJS(valueAccessor());$element.multiselect('setOptions',config);$element.multiselect('rebuild');}};}
function forEach(array,callback){for(var index=0;index<array.length;++index){callback(array[index],index);}}
function Multiselect(select,options){this.$select=$(select);if(this.$select.attr("data-placeholder")){options.nonSelectedText=this.$select.data("placeholder");}
this.options=this.mergeOptions($.extend({},options,this.$select.data()));this.originalOptions=this.$select.clone()[0].options;this.query='';this.searchTimeout=null;this.lastToggledInput=null
this.options.multiple=this.$select.attr('multiple')==="multiple";this.options.onChange=$.proxy(this.options.onChange,this);this.options.onDropdownShow=$.proxy(this.options.onDropdownShow,this);this.options.onDropdownHide=$.proxy(this.options.onDropdownHide,this);this.options.onDropdownShown=$.proxy(this.options.onDropdownShown,this);this.options.onDropdownHidden=$.proxy(this.options.onDropdownHidden,this);this.buildContainer();this.buildButton();this.buildDropdown();this.buildSelectAll();this.buildDropdownOptions();this.buildFilter();this.updateButtonText();this.updateSelectAll();if(this.options.disableIfEmpty&&$('option',this.$select).length<=0){this.disable();}
this.$select.hide().after(this.$container);};Multiselect.prototype={defaults:{buttonText:function(options,select){if(options.length===0){return this.nonSelectedText;}
else if(this.allSelectedText&&options.length===$('option',$(select)).length&&$('option',$(select)).length!==1&&this.multiple){if(this.selectAllNumber){return this.allSelectedText+' ('+options.length+')';}
else{return this.allSelectedText;}}
else if(options.length>this.numberDisplayed){return options.length+' '+this.nSelectedText;}
else{var selected='';var delimiter=this.delimiterText;options.each(function(){var label=($(this).attr('label')!==undefined)?$(this).attr('label'):$(this).text();selected+=label+delimiter;});return selected.substr(0,selected.length-2);}},buttonTitle:function(options,select){if(options.length===0){return this.nonSelectedText;}
else{var selected='';var delimiter=this.delimiterText;options.each(function(){var label=($(this).attr('label')!==undefined)?$(this).attr('label'):$(this).text();selected+=label+delimiter;});return selected.substr(0,selected.length-2);}},optionLabel:function(element){return $(element).attr('label')||$(element).text();},onChange:function(option,checked){},onDropdownShow:function(event){},onDropdownHide:function(event){},onDropdownShown:function(event){},onDropdownHidden:function(event){},onSelectAll:function(){},enableHTML:false,buttonClass:'btn btn-default',inheritClass:false,buttonWidth:'auto',buttonContainer:'<div class="btn-group" />',dropRight:false,selectedClass:'active',maxHeight:false,checkboxName:false,includeSelectAllOption:false,includeSelectAllIfMoreThan:0,selectAllText:' Select all',selectAllValue:'multiselect-all',selectAllName:false,selectAllNumber:true,enableFiltering:false,enableCaseInsensitiveFiltering:false,enableClickableOptGroups:false,filterPlaceholder:'Search',filterBehavior:'text',includeFilterClearBtn:true,preventInputChangeEvent:false,nonSelectedText:'None selected',nSelectedText:'selected',allSelectedText:'All selected',numberDisplayed:3,disableIfEmpty:false,delimiterText:', ',templates:{button:'<button type="button" class="multiselect dropdown-toggle" data-toggle="dropdown"><span class="multiselect-selected-text"></span> <b class="caret"></b></button>',ul:'<ul class="multiselect-container dropdown-menu"></ul>',filter:'<li class="multiselect-item filter"><div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text"></div></li>',filterClearBtn:'<span class="input-group-btn"><button class="btn btn-default multiselect-clear-filter" type="button"><i class="glyphicon glyphicon-remove-circle"></i></button></span>',li:'<li><a tabindex="0"><label></label></a></li>',divider:'<li class="multiselect-item divider"></li>',liGroup:'<li class="multiselect-item multiselect-group"><label></label></li>'}},constructor:Multiselect,buildContainer:function(){this.$container=$(this.options.buttonContainer);this.$container.on('show.bs.dropdown',this.options.onDropdownShow);this.$container.on('hide.bs.dropdown',this.options.onDropdownHide);this.$container.on('shown.bs.dropdown',this.options.onDropdownShown);this.$container.on('hidden.bs.dropdown',this.options.onDropdownHidden);},buildButton:function(){this.$button=$(this.options.templates.button).addClass(this.options.buttonClass);if(this.$select.attr('class')&&this.options.inheritClass){this.$button.addClass(this.$select.attr('class'));}
if(this.$select.prop('disabled')){this.disable();}
else{this.enable();}
if(this.options.buttonWidth&&this.options.buttonWidth!=='auto'){this.$button.css({'width':this.options.buttonWidth,'overflow':'hidden','text-overflow':'ellipsis'});this.$container.css({'width':this.options.buttonWidth});}
var tabindex=this.$select.attr('tabindex');if(tabindex){this.$button.attr('tabindex',tabindex);}
this.$container.prepend(this.$button);},buildDropdown:function(){this.$ul=$(this.options.templates.ul);if(this.options.dropRight){this.$ul.addClass('pull-right');}
if(this.options.maxHeight){this.$ul.css({'max-height':this.options.maxHeight+'px','overflow-y':'auto','overflow-x':'hidden'});}
this.$container.append(this.$ul);},buildDropdownOptions:function(){this.$select.children().each($.proxy(function(index,element){var $element=$(element);var tag=$element.prop('tagName').toLowerCase();if($element.prop('value')===this.options.selectAllValue){return;}
if(tag==='optgroup'){this.createOptgroup(element);}
else if(tag==='option'){if($element.data('role')==='divider'){this.createDivider();}
else{this.createOptionValue(element);}}},this));$('li input',this.$ul).on('change',$.proxy(function(event){var $target=$(event.target);var checked=$target.prop('checked')||false;var isSelectAllOption=$target.val()===this.options.selectAllValue;if(this.options.selectedClass){if(checked){$target.closest('li').addClass(this.options.selectedClass);}
else{$target.closest('li').removeClass(this.options.selectedClass);}}
var value=$target.val();var $option=this.getOptionByValue(value);var $optionsNotThis=$('option',this.$select).not($option);var $checkboxesNotThis=$('input',this.$container).not($target);if(isSelectAllOption){if(checked){this.selectAll();}
else{this.deselectAll();}}
if(!isSelectAllOption){if(checked){$option.prop('selected',true);if(this.options.multiple){$option.prop('selected',true);}
else{if(this.options.selectedClass){$($checkboxesNotThis).closest('li').removeClass(this.options.selectedClass);}
$($checkboxesNotThis).prop('checked',false);$optionsNotThis.prop('selected',false);this.$button.click();}
if(this.options.selectedClass==="active"){$optionsNotThis.closest("a").css("outline","");}}
else{$option.prop('selected',false);}}
this.$select.change();this.updateButtonText();this.updateSelectAll();this.options.onChange($option,checked);if(this.options.preventInputChangeEvent){return false;}},this));$('li a',this.$ul).on('mousedown',function(e){if(e.shiftKey){return false;}});$('li a',this.$ul).on('touchstart click',$.proxy(function(event){event.stopPropagation();var $target=$(event.target);if(event.shiftKey&&this.options.multiple){if($target.is("label")){event.preventDefault();$target=$target.find("input");$target.prop("checked",!$target.prop("checked"));}
var checked=$target.prop('checked')||false;if(this.lastToggledInput!==null&&this.lastToggledInput!==$target){var from=$target.closest("li").index();var to=this.lastToggledInput.closest("li").index();if(from>to){var tmp=to;to=from;from=tmp;}
++to;var range=this.$ul.find("li").slice(from,to).find("input");range.prop('checked',checked);if(this.options.selectedClass){range.closest('li').toggleClass(this.options.selectedClass,checked);}
for(var i=0,j=range.length;i<j;i++){var $checkbox=$(range[i]);var $option=this.getOptionByValue($checkbox.val());$option.prop('selected',checked);}}
$target.trigger("change");}
if($target.is("input")&&!$target.closest("li").is(".multiselect-item")){this.lastToggledInput=$target;}
$target.blur();},this));this.$container.off('keydown.multiselect').on('keydown.multiselect',$.proxy(function(event){if($('input[type="text"]',this.$container).is(':focus')){return;}
if(event.keyCode===9&&this.$container.hasClass('open')){this.$button.click();}
else{var $items=$(this.$container).find("li:not(.divider):not(.disabled) a").filter(":visible");if(!$items.length){return;}
var index=$items.index($items.filter(':focus'));if(event.keyCode===38&&index>0){index--;}
else if(event.keyCode===40&&index<$items.length-1){index++;}
else if(!~index){index=0;}
var $current=$items.eq(index);$current.focus();if(event.keyCode===32||event.keyCode===13){var $checkbox=$current.find('input');$checkbox.prop("checked",!$checkbox.prop("checked"));$checkbox.change();}
event.stopPropagation();event.preventDefault();}},this));if(this.options.enableClickableOptGroups&&this.options.multiple){$('li.multiselect-group',this.$ul).on('click',$.proxy(function(event){event.stopPropagation();var group=$(event.target).parent();var $options=group.nextUntil('li.multiselect-group');var $visibleOptions=$options.filter(":visible:not(.disabled)");var allChecked=true;var optionInputs=$visibleOptions.find('input');optionInputs.each(function(){allChecked=allChecked&&$(this).prop('checked');});optionInputs.prop('checked',!allChecked).trigger('change');},this));}},createOptionValue:function(element){var $element=$(element);if($element.is(':selected')){$element.prop('selected',true);}
var label=this.options.optionLabel(element);var value=$element.val();var inputType=this.options.multiple?"checkbox":"radio";var $li=$(this.options.templates.li);var $label=$('label',$li);$label.addClass(inputType);if(this.options.enableHTML){$label.html(" "+label);}
else{$label.text(" "+label);}
var $checkbox=$('<input/>').attr('type',inputType);if(this.options.checkboxName){$checkbox.attr('name',this.options.checkboxName);}
$label.prepend($checkbox);var selected=$element.prop('selected')||false;$checkbox.val(value);if(value===this.options.selectAllValue){$li.addClass("multiselect-item multiselect-all");$checkbox.parent().parent().addClass('multiselect-all');}
$label.attr('title',$element.attr('title'));this.$ul.append($li);if($element.is(':disabled')){$checkbox.attr('disabled','disabled').prop('disabled',true).closest('a').attr("tabindex","-1").closest('li').addClass('disabled');}
$checkbox.prop('checked',selected);if(selected&&this.options.selectedClass){$checkbox.closest('li').addClass(this.options.selectedClass);}},createDivider:function(element){var $divider=$(this.options.templates.divider);this.$ul.append($divider);},createOptgroup:function(group){var groupName=$(group).prop('label');var $li=$(this.options.templates.liGroup);if(this.options.enableHTML){$('label',$li).html(groupName);}
else{$('label',$li).text(groupName);}
if(this.options.enableClickableOptGroups){$li.addClass('multiselect-group-clickable');}
this.$ul.append($li);if($(group).is(':disabled')){$li.addClass('disabled');}
$('option',group).each($.proxy(function(index,element){this.createOptionValue(element);},this));},buildSelectAll:function(){if(typeof this.options.selectAllValue==='number'){this.options.selectAllValue=this.options.selectAllValue.toString();}
var alreadyHasSelectAll=this.hasSelectAll();if(!alreadyHasSelectAll&&this.options.includeSelectAllOption&&this.options.multiple&&$('option',this.$select).length>this.options.includeSelectAllIfMoreThan){if(this.options.includeSelectAllDivider){this.$ul.prepend($(this.options.templates.divider));}
var $li=$(this.options.templates.li);$('label',$li).addClass("checkbox");if(this.options.enableHTML){$('label',$li).html(" "+this.options.selectAllText);}
else{$('label',$li).text(" "+this.options.selectAllText);}
if(this.options.selectAllName){$('label',$li).prepend('<input type="checkbox" name="'+this.options.selectAllName+'" />');}
else{$('label',$li).prepend('<input type="checkbox" />');}
var $checkbox=$('input',$li);$checkbox.val(this.options.selectAllValue);$li.addClass("multiselect-item multiselect-all");$checkbox.parent().parent().addClass('multiselect-all');this.$ul.prepend($li);$checkbox.prop('checked',false);}},buildFilter:function(){if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var enableFilterLength=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find('option').length>=enableFilterLength){this.$filter=$(this.options.templates.filter);$('input',this.$filter).attr('placeholder',this.options.filterPlaceholder);if(this.options.includeFilterClearBtn){var clearBtn=$(this.options.templates.filterClearBtn);clearBtn.on('click',$.proxy(function(event){clearTimeout(this.searchTimeout);this.$filter.find('.multiselect-search').val('');$('li',this.$ul).show().removeClass("filter-hidden");this.updateSelectAll();},this));this.$filter.find('.input-group').append(clearBtn);}
this.$ul.prepend(this.$filter);this.$filter.val(this.query).on('click',function(event){event.stopPropagation();}).on('input keydown',$.proxy(function(event){if(event.which===13){event.preventDefault();}
clearTimeout(this.searchTimeout);this.searchTimeout=this.asyncFunction($.proxy(function(){if(this.query!==event.target.value){this.query=event.target.value;var currentGroup,currentGroupVisible;$.each($('li',this.$ul),$.proxy(function(index,element){var value=$('input',element).length>0?$('input',element).val():"";var text=$('label',element).text();var filterCandidate='';if((this.options.filterBehavior==='text')){filterCandidate=text;}
else if((this.options.filterBehavior==='value')){filterCandidate=value;}
else if(this.options.filterBehavior==='both'){filterCandidate=text+'\n'+value;}
if(value!==this.options.selectAllValue&&text){var showElement=false;if(this.options.enableCaseInsensitiveFiltering&&filterCandidate.toLowerCase().indexOf(this.query.toLowerCase())>-1){showElement=true;}
else if(filterCandidate.indexOf(this.query)>-1){showElement=true;}
$(element).toggle(showElement).toggleClass('filter-hidden',!showElement);if($(element).hasClass('multiselect-group')){currentGroup=element;currentGroupVisible=showElement;}
else{if(showElement){$(currentGroup).show().removeClass('filter-hidden');}
if(!showElement&&currentGroupVisible){$(element).show().removeClass('filter-hidden');}}}},this));}
this.updateSelectAll();},this),300,this);},this));}}},destroy:function(){this.$container.remove();this.$select.show();this.$select.data('multiselect',null);},refresh:function(){$('option',this.$select).each($.proxy(function(index,element){var $input=$('li input',this.$ul).filter(function(){return $(this).val()===$(element).val();});if($(element).is(':selected')){$input.prop('checked',true);if(this.options.selectedClass){$input.closest('li').addClass(this.options.selectedClass);}}
else{$input.prop('checked',false);if(this.options.selectedClass){$input.closest('li').removeClass(this.options.selectedClass);}}
if($(element).is(":disabled")){$input.attr('disabled','disabled').prop('disabled',true).closest('li').addClass('disabled');}
else{$input.prop('disabled',false).closest('li').removeClass('disabled');}},this));this.updateButtonText();this.updateSelectAll();},select:function(selectValues,triggerOnChange){if(!$.isArray(selectValues)){selectValues=[selectValues];}
for(var i=0;i<selectValues.length;i++){var value=selectValues[i];if(value===null||value===undefined){continue;}
var $option=this.getOptionByValue(value);var $checkbox=this.getInputByValue(value);if($option===undefined||$checkbox===undefined){continue;}
if(!this.options.multiple){this.deselectAll(false);}
if(this.options.selectedClass){$checkbox.closest('li').addClass(this.options.selectedClass);}
$checkbox.prop('checked',true);$option.prop('selected',true);if(triggerOnChange){this.options.onChange($option,true);}}
this.updateButtonText();this.updateSelectAll();},clearSelection:function(){this.deselectAll(false);this.updateButtonText();this.updateSelectAll();},deselect:function(deselectValues,triggerOnChange){if(!$.isArray(deselectValues)){deselectValues=[deselectValues];}
for(var i=0;i<deselectValues.length;i++){var value=deselectValues[i];if(value===null||value===undefined){continue;}
var $option=this.getOptionByValue(value);var $checkbox=this.getInputByValue(value);if($option===undefined||$checkbox===undefined){continue;}
if(this.options.selectedClass){$checkbox.closest('li').removeClass(this.options.selectedClass);}
$checkbox.prop('checked',false);$option.prop('selected',false);if(triggerOnChange){this.options.onChange($option,false);}}
this.updateButtonText();this.updateSelectAll();},selectAll:function(justVisible,triggerOnSelectAll){var justVisible=typeof justVisible==='undefined'?true:justVisible;var allCheckboxes=$("li input[type='checkbox']:enabled",this.$ul);var visibleCheckboxes=allCheckboxes.filter(":visible");var allCheckboxesCount=allCheckboxes.length;var visibleCheckboxesCount=visibleCheckboxes.length;if(justVisible){visibleCheckboxes.prop('checked',true);$("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").addClass(this.options.selectedClass);}
else{allCheckboxes.prop('checked',true);$("li:not(.divider):not(.disabled)",this.$ul).addClass(this.options.selectedClass);}
if(allCheckboxesCount===visibleCheckboxesCount||justVisible===false){$("option:enabled",this.$select).prop('selected',true);}
else{var values=visibleCheckboxes.map(function(){return $(this).val();}).get();$("option:enabled",this.$select).filter(function(index){return $.inArray($(this).val(),values)!==-1;}).prop('selected',true);}
if(triggerOnSelectAll){this.options.onSelectAll();}},deselectAll:function(justVisible){var justVisible=typeof justVisible==='undefined'?true:justVisible;if(justVisible){var visibleCheckboxes=$("li input[type='checkbox']:not(:disabled)",this.$ul).filter(":visible");visibleCheckboxes.prop('checked',false);var values=visibleCheckboxes.map(function(){return $(this).val();}).get();$("option:enabled",this.$select).filter(function(index){return $.inArray($(this).val(),values)!==-1;}).prop('selected',false);if(this.options.selectedClass){$("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").removeClass(this.options.selectedClass);}}
else{$("li input[type='checkbox']:enabled",this.$ul).prop('checked',false);$("option:enabled",this.$select).prop('selected',false);if(this.options.selectedClass){$("li:not(.divider):not(.disabled)",this.$ul).removeClass(this.options.selectedClass);}}},rebuild:function(){this.$ul.html('');this.options.multiple=this.$select.attr('multiple')==="multiple";this.buildSelectAll();this.buildDropdownOptions();this.buildFilter();this.updateButtonText();this.updateSelectAll();if(this.options.disableIfEmpty&&$('option',this.$select).length<=0){this.disable();}
else{this.enable();}
if(this.options.dropRight){this.$ul.addClass('pull-right');}},dataprovider:function(dataprovider){var groupCounter=0;var $select=this.$select.empty();$.each(dataprovider,function(index,option){var $tag;if($.isArray(option.children)){groupCounter++;$tag=$('<optgroup/>').attr({label:option.label||'Group '+groupCounter,disabled:!!option.disabled});forEach(option.children,function(subOption){$tag.append($('<option/>').attr({value:subOption.value,label:subOption.label||subOption.value,title:subOption.title,selected:!!subOption.selected,disabled:!!subOption.disabled}));});}
else{$tag=$('<option/>').attr({value:option.value,label:option.label||option.value,title:option.title,selected:!!option.selected,disabled:!!option.disabled});}
$select.append($tag);});this.rebuild();},enable:function(){this.$select.prop('disabled',false);this.$button.prop('disabled',false).removeClass('disabled');},disable:function(){this.$select.prop('disabled',true);this.$button.prop('disabled',true).addClass('disabled');},setOptions:function(options){this.options=this.mergeOptions(options);},mergeOptions:function(options){return $.extend(true,{},this.defaults,this.options,options);},hasSelectAll:function(){return $('li.multiselect-all',this.$ul).length>0;},updateSelectAll:function(){if(this.hasSelectAll()){var allBoxes=$("li:not(.multiselect-item):not(.filter-hidden) input:enabled",this.$ul);var allBoxesLength=allBoxes.length;var checkedBoxesLength=allBoxes.filter(":checked").length;var selectAllLi=$("li.multiselect-all",this.$ul);var selectAllInput=selectAllLi.find("input");if(checkedBoxesLength>0&&checkedBoxesLength===allBoxesLength){selectAllInput.prop("checked",true);selectAllLi.addClass(this.options.selectedClass);this.options.onSelectAll();}
else{selectAllInput.prop("checked",false);selectAllLi.removeClass(this.options.selectedClass);}}},updateButtonText:function(){var options=this.getSelected();if(this.options.enableHTML){$('.multiselect .multiselect-selected-text',this.$container).html(this.options.buttonText(options,this.$select));}
else{$('.multiselect .multiselect-selected-text',this.$container).text(this.options.buttonText(options,this.$select));}
$('.multiselect',this.$container).attr('title',this.options.buttonTitle(options,this.$select));},getSelected:function(){return $('option',this.$select).filter(":selected");},getOptionByValue:function(value){var options=$('option',this.$select);var valueToCompare=value.toString();for(var i=0;i<options.length;i=i+1){var option=options[i];if(option.value===valueToCompare){return $(option);}}},getInputByValue:function(value){var checkboxes=$('li input',this.$ul);var valueToCompare=value.toString();for(var i=0;i<checkboxes.length;i=i+1){var checkbox=checkboxes[i];if(checkbox.value===valueToCompare){return $(checkbox);}}},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options;},asyncFunction:function(callback,timeout,self){var args=Array.prototype.slice.call(arguments,3);return setTimeout(function(){callback.apply(self||window,args);},timeout);},setAllSelectedText:function(allSelectedText){this.options.allSelectedText=allSelectedText;this.updateButtonText();}};$.fn.multiselect=function(option,parameter,extraOptions){return this.each(function(){var data=$(this).data('multiselect');var options=typeof option==='object'&&option;if(!data){data=new Multiselect(this,options);$(this).data('multiselect',data);}
if(typeof option==='string'){data[option](parameter,extraOptions);if(option==='destroy'){$(this).data('multiselect',false);}}});};$.fn.multiselect.Constructor=Multiselect;$(function(){$("select[data-role=multiselect]").multiselect();});}(window.jQuery);
;!function(t,i,e,n){"use strict";t.fn.dynamicMaxHeight=function(i){function e(t,i){var e;e=t.hasClass(d)?i.data("replace-text"):i.attr("title"),i.text(e)}function n(t,i){t.find("."+c).css("max-height",i)}function a(t,i){i.css("display","inline-block")}var c="dynamic-height-wrap",d="dynamic-height-active",o="js-dynamic-show-hide";return this.each(function(i,s){var h=t(s),u=h.data("maxheight"),l=h.find("."+c).outerHeight(),r=h.find("."+o);h.attr("data-itemheight",l),l>u&&(n(h,u),h.toggleClass(d),a(h,r)),r.click(function(){h.hasClass(d)?n(h,l):n(h,u),e(h,r),h.toggleClass(d)})})}}(window.jQuery||window.$,document,window),"undefined"!=typeof module&&module.exports&&(module.exports=dynamicMaxHeight);