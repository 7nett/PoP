"use strict";function markResourceAsLoaded(e,o){popResourceLoader.markResourceAsLoaded(e,o)}!function(e){window.popResourceLoader={config:{},loading:[],"error-loading":[],"loading-urls":{},loaded:[],"loaded-in-body":[],"loaded-by-domain":{},preFetchPageSection:function(o){var r=this,a=o.url,t=o.options;if(M.USECODESPLITTING)if(r.configFilesLoaded(a,t))r.loadResourcesForURL(a);else{var n=r.loadURLConfigFile(a);e(document).one("loaded-url:"+escape(n),function(e){r.loadResourcesForURL(a)})}},areResourcesLoaded:function(e){var o=this;M.USECODESPLITTING&&(e.loaded=o.areResourcesLoadedForURL(e.fetchUrl))},includeResources:function(o,r,a){var t=this;if(!r)return"";var n=t.getConfigByDomain(o),i=[];return a&&(M.PRINTTAGSINBODY&&(i=e(r).not(t["loaded-in-body"]).get()),r=e(r).not(t.loaded).get()),t.loaded=t.loaded.concat(r),M.PRINTTAGSINBODY&&(t["loaded-in-body"]=t["loaded-in-body"].concat(i),r=i),r.map(function(e){var o=n.sources[e];n.types[e];return n.types[M.RESOURCELOADER.TYPES.CSS].indexOf(e)>=0?'<link rel="stylesheet" href="{0}">'.format(o):n.types[M.RESOURCELOADER.TYPES.JS].indexOf(e)>=0?'<script type="text/javascript" src="{0}"><\/script>'.format(o):""}).join("")},markResourceAsLoaded:function(e,o){var r=this,a=r["loading-urls"][e];"ok"==o?(r.loaded.push(a),r["loaded-in-body"].push(a)):"error"==o&&r["error-loading"].push(a),r.loading.splice(r.loading.indexOf(a),1),delete r["loading-urls"][e]},loadURLConfigFile:function(e){var o=this.getConfigFile(e);return load_script(o),o},configFilesLoaded:function(e,o){var r=this,a=r.getConfig(e);if(a.loaded)return!0;var t=r.getPropertiesForURL(e),n=t.hierarchy,i=t.path;if(["page","single"].indexOf(n)>=0&&a["loaded-paths"][n]&&a["loaded-paths"][n].indexOf(i)>=0)return!0;var d=r.getConfigFile(e);return a["loaded-files"].indexOf(d)>=0},getConfigFile:function(e){var o=this,r=o.getConfig(e),a=o.getPropertiesForURL(e),t=a.hierarchy,n=a.format;return r["configfile-urlplaceholder"].format(t,n)},getPropertiesForURL:function(e){var o=this,r=popUtils.getPath(e);return{hierarchy:o.getHierarchy(e),format:getParam(M.URLPARAM_FORMAT,e)||M.VALUES_DEFAULT,path:r}},getConfigByDomain:function(e){var o=this,r=o.config[e];return r||e==M.HOME_DOMAIN||(r=o.config[M.HOME_DOMAIN]),r||{}},getConfig:function(e){var o=this,r=getDomain(e);return o.getConfigByDomain(r)},getHierarchy:function(e){var o=this.getConfig(e),r=popUtils.getPath(e);return r?r.startsWith(o.paths.author)&&r!=o.paths.author?"author":r.startsWith(o.paths.tag)&&r!=o.paths.tag?"tag":-1===o.paths.single.indexOf(r)&&o.paths.single.some(function(e){return r.startsWith(e)&&r!=e})?"single":"page":"home"},getResourcesDB:function(e){var o=this,r=o.getConfig(e);if(!r||!r.resources)return{};var a=o.getHierarchy(e),t=popUtils.getPath(e),n=r.resources[a];"single"==a?n=n[r.paths.single.filter(function(e){return t.startsWith(e)&&t!=e})[0]]:"page"==a&&(n=n[t]);var i={url:e,path:t,config:r,resourcesDB:n};return popJSLibraryManager.execute("loadResourcesDB",i),(n=i.resourcesDB)||{}},getURLComponents:function(e){var o=[],r=getParam(M.URLPARAM_TARGET,e)||M.URLPARAM_TARGET_MAIN,a=getParam(M.URLPARAM_FORMAT,e)||M.VALUES_DEFAULT,t=getParam(M.URLPARAM_TAB,e)||"";return a&&o.push(M.CODESPLITTING.PREFIXES.FORMAT+a),t&&o.push(M.CODESPLITTING.PREFIXES.TAB+t),r&&o.push(M.CODESPLITTING.PREFIXES.TARGET+r),{params:o,target:r,format:a,tab:t,key:o.join(M.SEPARATOR_RESOURCELOADER)}},initLoadedByDomain:function(e){var o=this;o["loaded-by-domain"][e]||(o["loaded-by-domain"][e]={bundles:[],"bundle-groups":[]})},loadResourcesForURL:function(o){var r=this,a=r.getConfig(o),t=r.getResourcesDB(o),n=r.getURLComponents(o),i=a.keys[n.key];if(i&&t[i]){var d=getDomain(o);r.initLoadedByDomain(d);var s=t[i];e.each(s,function(o,t){if(-1==r["loaded-by-domain"][d]["bundle-groups"].indexOf(t)){var n=a["bundle-groups"][t]||[];n=e(n).not(r["loaded-by-domain"][d].bundles).get(),e.each(n,function(o,t){if(-1==r["loaded-by-domain"][d].bundles.indexOf(t)){var n=a.bundles[t];n=e(n).not(r.loaded).get(),n=e(n).not(r.loading).get(),e.each(n,function(e,o){r.loadResource(a,o)})}})}})}else n.target!=M.URLPARAM_TARGET_MAIN&&(o=removeQueryFields(o,[M.URLPARAM_TARGET]),r.loadResourcesForURL(o))},loadResource:function(e,o){var r=this;r.loading.push(o);var a=r["error-loading"].indexOf(o);a>=0&&r["error-loading"].splice(a,1);var t=e.sources[o];if(r["loading-urls"][t]=o,e.types[M.RESOURCELOADER.TYPES.JS].indexOf(o)>=0){var n=e["ordered-load-resources"].indexOf(o)>=0;load_script(t,markResourceAsLoaded,n)}else e.types[M.RESOURCELOADER.TYPES.CSS].indexOf(o)>=0&&load_style(t,markResourceAsLoaded)},areResourcesLoadedForURL:function(o){var r=this,a=r.getConfig(o),t=r.getResourcesDB(o),n=r.getURLComponents(o),i=a.keys[n.key];if(i&&t[i]){var d=getDomain(o);r.initLoadedByDomain(d);var s=t[i];s=e(s).not(r["loaded-by-domain"][d]["bundle-groups"]).get();var u=!0;return e.each(s,function(o,t){var n=a["bundle-groups"][t]||[];n=e(n).not(r["loaded-by-domain"][d].bundles).get();var i=!0;e.each(n,function(o,t){var n=a.bundles[t];n=e(n).not(r.loaded).get();var s=!0;e.each(n,function(e,o){if(r["error-loading"].indexOf(o)>=0&&r.loadResource(a,o),-1==r.loaded.indexOf(o)){s=!1;var t=a.sources[o];r["loading-urls"][t]||r.loadResource(a,o)}}),s?r["loaded-by-domain"][d].bundles.push(t):i=!1}),i?r["loaded-by-domain"][d]["bundle-groups"].push(t):u=!1}),u}return n.target==M.URLPARAM_TARGET_MAIN||(o=removeQueryFields(o,[M.URLPARAM_TARGET]),r.areResourcesLoadedForURL(o))}}}(jQuery),popJSLibraryManager.register(popResourceLoader,["preFetchPageSection","areResourcesLoaded"]);