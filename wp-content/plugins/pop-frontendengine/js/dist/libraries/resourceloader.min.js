"use strict";function markJSResourceAsLoaded(e,o){popResourceLoader.markJSResourceAsLoaded(e,o)}function markResourceAsLoaded(e,o){popResourceLoader.markResourceAsLoaded(e,o)}!function(e){window.popResourceLoader={config:{},loading:[],"error-loading":[],"loading-urls":{},"loading-resources":{},loaded:[],"loaded-in-body":[],"loaded-by-domain":{},preFetchPageSection:function(o){var r=this,a=o.url,n=o.options;if(M.USECODESPLITTING)if(r.configFilesLoaded(a,n))r.loadResourcesForURL(a);else{var t=r.loadURLConfigFile(a);e(document).one("loaded-url:"+escape(t),function(e){r.loadResourcesForURL(a)})}},areResourcesLoaded:function(e){var o=this;M.USECODESPLITTING&&(e.loaded=o.areResourcesLoadedForURL(e.fetchUrl))},loadScriptOrStyle:function(e,o){e==M.RESOURCELOADER.TYPES.CSS?load_style(o):e==M.RESOURCELOADER.TYPES.JS&&load_script(o)},onRemoveLoadResource:function(o,r,a){var n=this,t=e("#"+o);popManager.getPageSectionPage(t).one("destroy",function(){n.loadScriptOrStyle(r,a)}),t.one("replace",function(){n.loadScriptOrStyle(r,a)})},includeResources:function(o,r,a,n){var t=this;if(!a)return"";var i=t.getConfigByDomain(o),d=[];return n&&(d=e(a).not(t["loaded-in-body"]).get(),a=e(a).not(t.loaded).get()),t.loaded=t.loaded.concat(a),t["loaded-in-body"]=t["loaded-in-body"].concat(d),(a=d).map(function(e){var o=i.sources[e],a='<script type="text/javascript">jQuery(document).ready( function($) { popResourceLoader.onRemoveLoadResource("{0}", "{1}", "{2}"); });<\/script>';if(i.types[M.RESOURCELOADER.TYPES.CSS].indexOf(e)>=0)return(n=a.format(r,M.RESOURCELOADER.TYPES.CSS,o))+(t='<link rel="stylesheet" href="{0}">'.format(o));if(i.types[M.RESOURCELOADER.TYPES.JS].indexOf(e)>=0){var n=a.format(r,M.RESOURCELOADER.TYPES.JS,o),t='<script type="text/javascript" src="{0}"><\/script>'.format(o);return n+t}return""}).join("")},markJSResourceAsLoaded:function(e,o){var r=this;if("ok"==o){var a=r["loading-urls"][e];popCodeSplitJSLibraryManager.assignLibrariesToResource(a)}r.markResourceAsLoaded(e,o)},markResourceAsLoaded:function(e,o){var r=this,a=r["loading-urls"][e];"ok"==o?(r.loaded.push(a),r["loaded-in-body"].push(a)):"error"==o&&r["error-loading"].push(a),r.loading.splice(r.loading.indexOf(a),1),delete r["loading-urls"][e]},loadURLConfigFile:function(e){var o=this.getConfigFile(e);return load_script(o),o},configFilesLoaded:function(e,o){var r=this,a=r.getConfig(e);if(a.loaded)return!0;var n=r.getPropertiesForURL(e),t=n.hierarchy,i=n.path;if(["page","single"].indexOf(t)>=0&&a["loaded-paths"][t]&&a["loaded-paths"][t].indexOf(i)>=0)return!0;var d=r.getConfigFile(e);return a["loaded-files"].indexOf(d)>=0},getConfigFile:function(e){var o=this,r=o.getConfig(e),a=o.getPropertiesForURL(e),n=a.hierarchy,t=a.format;return r["configfile-urlplaceholder"].format(n,t)},getPropertiesForURL:function(e){var o=this,r=popUtils.getPath(e);return{hierarchy:o.getHierarchy(e),format:getParam(M.URLPARAM_FORMAT,e)||M.VALUES_DEFAULT,path:r}},getConfigByDomain:function(e){var o=this,r=o.config[e];return r||e==M.HOME_DOMAIN||(r=o.config[M.HOME_DOMAIN]),r||{}},getConfig:function(e){var o=this,r=getDomain(e);return o.getConfigByDomain(r)},getHierarchy:function(e){var o=this.getConfig(e),r=popUtils.getPath(e);return r?r.startsWith(o.paths.author)&&r!=o.paths.author?"author":r.startsWith(o.paths.tag)&&r!=o.paths.tag?"tag":-1===o.paths.single.indexOf(r)&&o.paths.single.some(function(e){return r.startsWith(e)&&r!=e})?"single":"page":"home"},getResourcesDB:function(e){var o=this,r=o.getConfig(e);if(!r||!r.resources)return{};var a=o.getHierarchy(e),n=popUtils.getPath(e),t=r.resources[a];if(!t)return{};"single"==a?t=t[r.paths.single.filter(function(e){return n.startsWith(e)&&n!=e})[0]]:"page"==a&&(t=t[n]);var i={url:e,path:n,config:r,resourcesDB:t};return popJSLibraryManager.execute("loadResourcesDB",i),(t=i.resourcesDB)||{}},getURLComponents:function(e){var o=[],r=getParam(M.URLPARAM_TARGET,e)||M.URLPARAM_TARGET_MAIN,a=getParam(M.URLPARAM_FORMAT,e)||M.VALUES_DEFAULT,n=getParam(M.URLPARAM_TAB,e)||"";return a&&o.push(M.CODESPLITTING.PREFIXES.FORMAT+a),n&&o.push(M.CODESPLITTING.PREFIXES.TAB+n),r&&o.push(M.CODESPLITTING.PREFIXES.TARGET+r),{params:o,target:r,format:a,tab:n,key:o.join(M.SEPARATOR_RESOURCELOADER)}},initLoadedByDomain:function(e){var o=this;o["loaded-by-domain"][e]||(o["loaded-by-domain"][e]={bundles:[],"bundle-groups":[]})},loadResourcesForURL:function(o){var r=this,a=r.getConfig(o),n=r.getResourcesDB(o),t=r.getURLComponents(o),i=a.keys[t.key];if(i&&n[i]){var d=getDomain(o);r.initLoadedByDomain(d);var s=n[i];e.each(s,function(n,t){if(-1==r["loaded-by-domain"][d]["bundle-groups"].indexOf(t)){var i=a["bundle-groups"][t]||[];i=e(i).not(r["loaded-by-domain"][d].bundles).get(),e.each(i,function(n,t){if(-1==r["loaded-by-domain"][d].bundles.indexOf(t)){var i=a.bundles[t];i=e(i).not(r.loaded).get(),i=e(i).not(r.loading).get(),e.each(i,function(e,n){r.loadResource(o,a,n)})}})}})}else t.target!=M.URLPARAM_TARGET_MAIN&&(o=removeQueryFields(o,[M.URLPARAM_TARGET]),r.loadResourcesForURL(o))},loadResource:function(e,o,r){var a=this;a["loading-resources"][e]=a["loading-resources"][e]||[],-1==a["loading-resources"][e].indexOf(r)&&a["loading-resources"][e].push(r),a.loading.push(r);var n=a["error-loading"].indexOf(r);n>=0&&a["error-loading"].splice(n,1);var t=o.sources[r];if(a["loading-urls"][t]=r,o.types[M.RESOURCELOADER.TYPES.JS].indexOf(r)>=0){var i=o["ordered-load-resources"].indexOf(r)>=0;load_script(t,markJSResourceAsLoaded,i)}else o.types[M.RESOURCELOADER.TYPES.CSS].indexOf(r)>=0&&load_style(t,markResourceAsLoaded)},areResourcesLoadedForURL:function(o){var r=this,a=r.getConfig(o),n=r.getResourcesDB(o),t=r.getURLComponents(o),i=a.keys[t.key];if(i&&n[i]){var d=getDomain(o);r.initLoadedByDomain(d);var s=n[i];s=e(s).not(r["loaded-by-domain"][d]["bundle-groups"]).get();var u=!0;if(e.each(s,function(n,t){var i=a["bundle-groups"][t]||[];i=e(i).not(r["loaded-by-domain"][d].bundles).get();var s=!0;e.each(i,function(n,t){var i=a.bundles[t];i=e(i).not(r.loaded).get();var u=!0;e.each(i,function(e,n){if(r["error-loading"].indexOf(n)>=0&&r.loadResource(o,a,n),-1==r.loaded.indexOf(n)){u=!1;var t=a.sources[n];r["loading-urls"][t]||r.loadResource(o,a,n)}}),u?r["loaded-by-domain"][d].bundles.push(t):s=!1}),s?r["loaded-by-domain"][d]["bundle-groups"].push(t):u=!1}),u){var c=r["loading-resources"][o];if(c&&c.length){delete r["loading-resources"][o];var l=[];if(e.each(c,function(e,o){l=l.concat(popCodeSplitJSLibraryManager.getLibraries(o))}),l.length){var g={domain:M.HOME_DOMAIN,codeSplitLibraries:l};popJSLibraryManager.execute("documentInitializedIndependent",g)}}}return u}return t.target==M.URLPARAM_TARGET_MAIN||(o=removeQueryFields(o,[M.URLPARAM_TARGET]),r.areResourcesLoadedForURL(o))}}}(jQuery),popJSLibraryManager.register(popResourceLoader,["preFetchPageSection","areResourcesLoaded"]);