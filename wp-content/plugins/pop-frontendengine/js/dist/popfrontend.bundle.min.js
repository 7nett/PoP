function getMultiLayoutKey(e,t){var a=M.MULTILAYOUT_KEYFIELDS[e]||[];if(!a.length)return"default";var n=[];return jQuery.each(a,function(e,a){n.push(t[a])}),n.join("-")}function unescapeHtml(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText||t.text||t.textContent}function add_query_arg(e,t,a){return a+=(a.split("?")[1]?"&":"?")+e+"="+t}function removeParams(e){return e.indexOf("?")>-1?e.substr(0,e.indexOf("?")):e}function getParams(e){if(e.indexOf("?")>-1){var t=e.substr(e.indexOf("?")+1);return t.indexOf("#")>-1&&(t=t.substr(0,t.indexOf("#"))),t}return""}function getParam(e,t){var a;a=t?getParams(t):window.location.search.substring(1);var n=splitUrlParams(a);return n[e]}function splitUrlParams(e){return"undefined"!=typeof urlParams[e]?urlParams[e]:(urlParams[e]=jQuery.extend({},splitParams(e)),urlParams[e])}function splitParams(e){for(var t,a={},n=function(e){return decodeURIComponent(e).replace(/\+/g," ")},r=decodeURI(e),i=/([^&=]+)=?([^&]*)/g;t=i.exec(r);)if("-1"==t[1].indexOf("["))a[n(t[1])]=n(t[2]);else{var o=t[1].indexOf("["),s=t[1].slice(o+1,t[1].indexOf("]",o)),c=n(t[1].slice(0,o));"object"!=typeof a[c]&&(a[n(c)]={}),s?a[n(c)][n(s)]=n(t[2]):Array.prototype.push.call(a[n(c)],n(t[2]))}return a}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function doScroll(e,t){t=t||!1;var a=e.offset().top-20;t?jQuery("html, body").animate({scrollTop:a}):window.scrollTo(0,a)}function removeMarker(e){return e.indexOf("#")>-1?e.substr(0,e.indexOf("#")):e}function counterNext(){return counter++,counter}function gd_clone(e){var t={};return jQuery.each(e,function(e,a){"array"===jQuery.type(a)?t[e]=jQuery.extend({},a):t[e]=a}),t}function windowResize(){var e=document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e),jQuery(document).ready(function(e){e(window).triggerHandler("resized")})}function isUrlValid(e){return/^(https?):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}function beep(){var e=new Audio("data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");e.play()}function showTopNav(){popPageSectionManager.open(popPageSectionManager.getTopNav())}function hideTopNav(){popPageSectionManager.close(popPageSectionManager.getTopNav())}Handlebars.registerHelper("breaklines",function(e){return e=Handlebars.Utils.escapeExpression(e),e=e.toString(),e=e.replace(/(\r\n|\n|\r)/gm,"<br>"),new Handlebars.SafeString(e)}),Handlebars.registerHelper("showmore",function(e,t){var a=t.hash.len||0;if(a>0&&e.length>a+100){var n="</p>",r=a,i='<a href="#" class="pop-showmore-more">'+M.STRING_MORE+"</a>",o='<a href="#" class="pop-showmore-less hidden">'+M.STRING_LESS+"</a>",s=!1,c=!0;if(e.length>r&&e.substr(a).indexOf(n)>-1&&(s=!0,c=!1,e=e.substr(0,a)+'<span class="pop-showmore-more-full hidden">'+e.substr(a,e.substr(a).indexOf(n))+"</span> "+i+e.substr(a+e.substr(a).indexOf(n)),r=a+e.substr(a).indexOf(n)+n.length),s||e.length>r){var u=e.substr(r),d=u.trim().length;if(s||d){var g=e.substr(0,r),l='<span class="pop-showmore-more-teaser">'+g+"</span>"+(d?'<span class="pop-showmore-more-full hidden">'+u+"</span> ":" ")+(c?i:"")+o;return new Handlebars.SafeString(l)}}}return e}),Handlebars.registerHelper("ondate",function(e,t){return new Handlebars.SafeString(M.ONDATE.format(e))}),Handlebars.registerHelper("img",function(e,t){var a=t.hash.url,n=t.hash.title||"",r=t.hash.alt||"",i=t.hash.class||"",o="";return a&&(o+='<a href="'+a+'" title="'+n+'">'),o+='<img src="'+e.src+'" width="'+e.width+'" height="'+e.height+'" alt="'+r+'" class="'+i+'">',a&&(o+="</a>"),new Handlebars.SafeString(o)}),Handlebars.registerHelper("addParam",function(e,t,a,n){return jQuery.isArray(a)||(a=[a]),jQuery.each(a,function(a,n){e=add_query_arg(t,n,e)}),e}),Handlebars.registerHelper("destroyUrl",function(e,t){return new Handlebars.SafeString(popManager.getDestroyUrl(e))}),Handlebars.registerHelper("statusLabel",function(e,t){var a='<span class="label '+M.STATUS.class[e]+" label-"+e+'">'+M.STATUS.text[e]+"</span>";return new Handlebars.SafeString(a)}),Handlebars.registerHelper("labelize",function(e,t,a){var n="",r="";if(e)for(var i=0;i<e.length;i++)r=M.LABELIZE_CLASSES[e[i]]?M.LABELIZE_CLASSES[e[i]]:"",n+='<span class="label '+t+" "+r+'">'+e[i]+"</span>\n";return new Handlebars.SafeString(n)}),Handlebars.registerHelper("infoButton",function(e,t,a){var n=a.hash.classs||"",r='<a class="'+n+'" data-toggle="collapse" href="#'+e+"-"+t+'" role="button"><span class="glyphicon glyphicon-info-sign"></span></a>';return new Handlebars.SafeString(r)}),Handlebars.registerHelper("infoCollapse",function(e,t,a){var n=a.fn(this),r='<div class="collapse" id="'+e+"-"+t+'">'+n+"</div>";return new Handlebars.SafeString(r)}),Handlebars.registerHelper("mod",function(e,t,a){if(arguments.length<3)throw new Error("Handlebars Helper equal needs 2 parameters");return offset=a.hash.offset||0,(e+offset)%t===0?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("compare",function(e,t,a){if(arguments.length<3)throw new Error("Handlerbars Helper 'compare' needs 2 parameters");operator=a.hash.operator||"==";var n={eq:function(e,t){return e==t||e.toString()==t.toString()},"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},typeof:function(e,t){return typeof e==t},in:function(e,t){return t.indexOf(e)>=0},notin:function(e,t){return t.indexOf(e)==-1}};if(!n[operator])throw new Error("Handlerbars Helper 'compare' doesn't know the operator "+operator);var r=n[operator](e,t);return r?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("get",function(e,t,a){return"undefined"==typeof e||"undefined"==typeof e[t]?"":e[t]}),Handlebars.registerHelper("ifget",function(e,t,a){if("undefined"==typeof e)return"";var n=!1;if(a.hash.method){var r=popJSLibraryManager.execute(a.hash.method,{input:e[t]});jQuery.each(r,function(e,t){if(t)return n=!0,-1})}else n=e[t];return n?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("withget",function(e,t,a){if("undefined"==typeof e||"undefined"==typeof e[t])return"";var n=e[t];return popManager.expandJSKeys(n),a.fn(n)}),Handlebars.registerHelper("interceptAttr",function(e){var t=e.hash.context||this,a=t[M.JS_INTERCEPT]||{};return new Handlebars.SafeString((a[M.JS_TYPE]?' data-intercept="'+a[M.JS_TYPE]+'"':"")+(a.settings?' data-intercept-settings="'+a[M.JS_SETTINGS]+'"':"")+(a[M.JS_TARGET]?' target="'+a[M.JS_TARGET]+'"':"")+(a[M.JS_SKIPSTATEUPDATE]?' data-intercept-skipstateupdate="true"':"")+' style="display: none;"')}),Handlebars.registerHelper("generateId",function(e){var t=e.hash.context||this,a=e.hash.pssId||t.pss.pssId,n=e.hash.targetId||t.bs.bsId,r=e.hash.template||t[M.JS_TEMPLATE],i=e.hash.fixed||t[M.JS_FIXEDID],o=e.hash.idUnique||t[M.JS_ISIDUNIQUE],s=e.hash.group,c=e.fn(this),u=popJSRuntimeManager.addTemplateId(a,n,r,c,s,i,o);return new Handlebars.SafeString('id="'+u+'" data-templateid="'+r+'"')}),Handlebars.registerHelper("lastGeneratedId",function(e){var t=e.hash.context||this,a=e.hash.pssId||t.pss.pssId,n=e.hash.targetId||t.bs.bsId,r=e.hash.template||t[M.JS_TEMPLATE],i=e.hash.group;return popJSRuntimeManager.getLastGeneratedId(a,n,r,i)}),Handlebars.registerHelper("applyLightTemplate",function(e,t){var a=t.hash.context||this,n=popManager.getHtml(e,a);return new Handlebars.SafeString(n)}),Handlebars.registerHelper("json",function(e){return JSON.stringify(e)}),Handlebars.registerHelper("enterModule",function(e,t){var a=t.hash.context||this,n=t.hash.template||a[M.JS_TEMPLATE],r=e.tls,i=e.pss,o=e.bs,s=e.itemObject,c=e.itemObjectDBKey,u="undefined"!=typeof t.hash.itemDBKey?t.hash.itemDBKey:e.itemDBKey,d="undefined"!=typeof t.hash.items?t.hash.items:e.items,g={itemObject:s,itemObjectDBKey:c,itemDBKey:u,items:d,tls:r,pss:i,bs:o},l=i.pssId,p=(i.psId,o.bsId);o.bId;jQuery.extend(a,popManager.getRuntimeConfiguration(l,p,n)),popManager.expandJSKeys(a);var f=t.hash.itemObjectId;"array"===jQuery.type(f)&&(f.length?f=f[0]:(f=null,s=null,g.itemObject=s)),t.hash.itemDBKey&&f?(u=t.hash.itemDBKey,s=popManager.getItemObject(u,f),g.itemObject=s,g.itemObjectDBKey=u,g.itemDBKey=u,g.items=[f]):t.hash.itemDBKey&&t.hash.items?(g.itemDBKey=t.hash.itemDBKey,g.items=t.hash.items):t.hash.subcomponent&&f?(u=o["db-keys"][M.JS_SUBCOMPONENTS][t.hash.subcomponent]["db-key"],s=popManager.getItemObject(u,f),g.itemObject=s,g.itemObjectDBKey=u,g.itemDBKey=u,g.items=[f]):t.hash.subcomponent&&t.hash.items?(u=o["db-keys"][M.JS_SUBCOMPONENTS][t.hash.subcomponent]["db-key"],g.itemDBKey=u,g.items=t.hash.items):t.hash.items?g.items=t.hash.items:t.hash.itemDBKey&&(g.itemDBKey=t.hash.itemDBKey,g.itemObject=null,g.itemObjectDBKey=null,g.items=null),g.items&&"array"!==jQuery.type(g.items)&&(g.items=[g.items]),t.hash["feedback-msg"]&&(g["feedback-msg"]=t.hash["feedback-msg"]);var S=[],A=[],h=[];a[M.JS_MODULEOPTIONS]&&(S=a[M.JS_MODULEOPTIONS][M.JS_OVERRIDEFROMITEMOBJECT]||[],A=a[M.JS_MODULEOPTIONS][M.JS_REPLACESTRFROMITEMOBJECT]||[]),a[M.JS_RUNTIMEMODULEOPTIONS]&&(h=a[M.JS_RUNTIMEMODULEOPTIONS][M.JS_REPLACESTRFROMITEMOBJECT]||[]),S.length&&popManager.overrideFromItemObject(s,g,S);var m=A.concat(h);m.length&&popManager.replaceFromItemObject(l,p,n,s,g,m);var v=t.hash.parentContext||{};if(v){g["parent-context"]=v;for(var T=v;T["parent-context"];)T=T["parent-context"];g["root-context"]=T}jQuery.extend(a,g);var I=popManager.getHtml(n,a);return t.hash.unsafe?I:new Handlebars.SafeString(I)}),Handlebars.registerHelper("withLayout",function(e,t,a,n,r){var i=popManager.getItemObject(e,t),o=getMultiLayoutKey(e,i),s=a[o];if(s||(s=a.default),!s)return"";var c=n[M.JS_MODULES][s];return jQuery.extend(c,{itemDBKey:e,itemObjectId:t}),popManager.expandJSKeys(c),r.fn(c)}),Handlebars.registerHelper("layoutLabel",function(e,t,a){var n=getMultiLayoutKey(e,t);return M.MULTILAYOUT_LABELS[n]||""}),Handlebars.registerHelper("withOptions",function(e,t){if("undefined"!=typeof e)return jQuery.extend(e,t.hash),popManager.expandJSKeys(e),t.fn(e)}),Handlebars.registerHelper("withBlock",function(e,t,a){if("undefined"!=typeof e&&"undefined"!=typeof e[M.JS_MODULES]&&"undefined"!=typeof e[M.JS_MODULES][t])return e=e[M.JS_MODULES][t],popManager.expandJSKeys(e),a.fn(e)}),Handlebars.registerHelper("withModule",function(e,t,a){if("undefined"!=typeof e&&"undefined"!=typeof e[M.JS_SETTINGSIDS]&&"undefined"!=typeof e[M.JS_SETTINGSIDS][t]){var n=e[M.JS_SETTINGSIDS][t];if("undefined"!=typeof e[M.JS_MODULES]&&"undefined"!=typeof e[M.JS_MODULES][n])return e=e[M.JS_MODULES][n],popManager.expandJSKeys(e),jQuery.extend(e,a.hash),a.fn(e)}}),Handlebars.registerHelper("withSublevel",function(e,t){var a=t.hash.context||this;return popManager.expandJSKeys(a),t.fn(a[e])}),Handlebars.registerHelper("withItemObject",function(e,t,a){var n=popManager.getItemObject(e,t);return a.fn(n)}),Handlebars.registerHelper("join",function(e,t){var a=t.hash.delimiter||",",n=n=t.hash.start||0,r=e?e.length:0,o=t.hash.end||r,s="";if(o>r&&(o=r),"function"==typeof t){for(i=n;i<o;i++)i>n&&(s+=a),s+="string"==typeof e[i]?e[i]:t(e[i]);return s}return[].concat(e).slice(n,o).join(a)});var removeQueryFields=function(e,t){if(!t.length)return e;var a=t.join("|"),n=e.split(new RegExp("[&?]("+a+")=[^&]*")),r=n.length-1;return n[0]+(r?n[r].slice(1):"")};String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,a){return"undefined"!=typeof e[a]?e[a]:t})}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var urlParams={},counter=0;Date.now||(Date.now=function(){return(new Date).getTime()}),function(e){popJSLibraryManager={libraries:[],methods:{},register:function(t,a,n,r){var i=this;i.libraries.push(t),e.each(a,function(e,a){i.methods[a]&&!r||(i.methods[a]=[]),n?i.methods[a].unshift(t):i.methods[a].push(t)})},getLibraries:function(e){var t=this;return t.methods[e]||[]},execute:function(t,a){var n=this,r={},i=n.methods[t];return i&&e.each(i,function(e,n){r["l"+e]=n[t](a)}),r}}}(jQuery),function(e){popJSRuntimeManager={"full-session-ids":{},"last-session-ids":{},initPageSectionVarPaths:function(e,t,a,n){e[t]||(e[t]={}),e[t][a]||(e[t][a]={}),e[t][a][n]||(e[t][a][n]=[])},initBlockVarPaths:function(e,t,a,n,r){r=r||M.JSMETHOD_GROUP_MAIN,e[t]||(e[t]={}),e[t][a]||(e[t][a]={}),e[t][a][n]||(e[t][a][n]={}),e[t][a][n][r]||(e[t][a][n][r]=[])},initVars:function(e,t,a,n){var r=this;r.initBlockVarPaths(r["full-session-ids"],e,t,a,n),r.initBlockVarPaths(r["last-session-ids"],e,t,a,n)},addGroup:function(e,t){return t&&(e+=M.ID_SEPARATOR+t),e},addPageSectionId:function(e,t,a,n){var r=this;return a=r.addGroup(a,n),r.addTargetId(e,e,t,n,a),a},addTemplateId:function(e,t,a,n,r,i,o){var s=this;return n=s.addGroup(n,r),o||(n+=popManager.getUniqueId()),i||(n+=M.ID_SEPARATOR+counterNext()),s.addTargetId(e,e,a,r,n),s.addTargetId(e,t,a,r,n),n},addTargetId:function(e,t,a,n,r){var i=this;return n=n||M.JSMETHOD_GROUP_MAIN,i.initVars(e,t,a,n),i["full-session-ids"][e][t][a][n].push(r),i["last-session-ids"][e][t][a][n].push(r),r},getLastGeneratedId:function(e,t,a,n){var r=this;n=n||M.JSMETHOD_GROUP_MAIN;var i=r["full-session-ids"][e][t][a][n];return i[i.length-1]},getPageSectionSessionIds:function(e,t){var a=this;return a.getTargetSessionIds(e,e,t)},getBlockSessionIds:function(e,t,a){var n=this;return n.getTargetSessionIds(e,t,a)},getTargetSessionIds:function(e,t,a){var n=this,r=popManager.getSettingsId(e),i=popManager.getSettingsId(t);return a=a||"last",n[a+"-session-ids"][r]?n[a+"-session-ids"][r][i]:null},deletePageSectionLastSessionIds:function(e){var t=this,a=popManager.getSettingsId(e);delete t["last-session-ids"][a][a]},deleteBlockLastSessionIds:function(e,t){var a=this,n=popManager.getSettingsId(e),r=popManager.getSettingsId(t);a["last-session-ids"][n]&&a["last-session-ids"][n][r]&&delete a["last-session-ids"][n][r]}}}(jQuery),function(e){popPageSectionManager={offcanvasToggle:function(t){var a=this,n=(t.pageSection,t.targets);n.click(function(t){t.preventDefault();var n=e(this),r=n.data("mode"),i=e(n.data("target")),o=n.data("toggle");"offcanvas-open"==o?a.open(i,r):"offcanvas-close"==o?a.close(i,r):"offcanvas-toggle"==o&&a.toggle(i,r)})},isHidden:function(e){var t=this,a=e.targets,n=a.closest(".offcanvas");return t.execIsHidden(n)},execIsHidden:function(e){var t=this;if(e.length){var a=t.getOffcanvasActiveClass(e);return!t.getGroup(e).hasClass(a)}return!1},getOffcanvasActiveClass:function(e,t){var a=e.data("offcanvas"),n="active-"+a;return"xs"==t&&(n+="-xs"),n},open:function(e,t){var a=this,n=a.getGroup(e),r=a.getOffcanvasActiveClass(e,t);n.addClass(r),a.triggerStatus(e,t,"opened")},close:function(e,t){var a=this,n=a.getGroup(e),r=a.getOffcanvasActiveClass(e,t);n.removeClass(r),a.triggerStatus(e,t,"closed")},toggle:function(e,t){var a=this,n=a.getGroup(e),r=a.getOffcanvasActiveClass(e,t);n.hasClass(r)?a.close(e,t):a.open(e,t)},triggerStatus:function(e,t,a){var n=this,r=n.getGroup(e);r.triggerHandler("on.bs.pagesection-group:pagesection-"+e.attr("id")+":"+a,[e,t])},getTopLevelSettingsId:function(){return M.TEMPLATE_TOPLEVEL_SETTINGS_ID},getPageSectionStatus:function(t){return e("#"+t.attr("id")+"-status")},getGroup:function(t){return t?t.closest(".pop-pagesection-group"):e("#"+M.TEMPLATE_PAGESECTIONGROUP_ID)},theater:function(e){var t=this,a=t.getGroup();t.transitionEndResize(),e?(a.addClass("theater"),a.triggerHandler("on.bs.pagesection:theater")):(a.removeClass("theater"),a.triggerHandler("off.bs.pagesection:theater"))},isTheater:function(){var e=this,t=e.getGroup();return t.hasClass("theater")},transitionEndResize:function(){var e=this,t=e.getGroup();t.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){windowResize()})},enableShowHideTopNav:function(){e(window).on("scroll:down",hideTopNav),e(window).on("scroll:up",showTopNav)},disableShowHideTopNav:function(){e(window).off("scroll:down",hideTopNav),e(window).off("scroll:up",showTopNav)},getTopNav:function(){var e=this,t=e.getGroup();return t.find(".offcanvas-topnav")},getOpenMode:function(e){return e.data("pagesection-openmode")||"automatic"}}}(jQuery),popJSLibraryManager.register(popPageSectionManager,["isHidden","offcanvasToggle"],!0),function(e){popBrowserHistory={loaded:!1,documentInitialized:function(t){var a=this;e(window).on("popstate",function(e){if(a.loaded){var t=a.removePushURLAtts(window.location.href),n={skipPushState:!0};popURLInterceptors.getInterceptors(t).length?popURLInterceptors.intercept(t,n):popManager.fetch(t,n)}else a.loaded=!0})},addPushURLAtts:function(t){var a=popManager.getTopLevelFeedback();return e.each(a[M.DATALOAD_PUSHURLATTS],function(e,a){t=add_query_arg(e,a,t)}),t},removePushURLAtts:function(t){var a=popManager.getTopLevelFeedback(),n=[];return e.each(a[M.DATALOAD_PUSHURLATTS],function(e,t){n.push(e)}),removeQueryFields(t,n)},pushState:function(e){var t=this;e=t.addPushURLAtts(e),e.startsWith(M.HOME_URL)||(e=add_query_arg(M.URLPARAM_URL,encodeURIComponent(e),M.EXTERNAL_URL)),history.pushState({url:e},"",e),t.loaded=!0},replaceState:function(e){var t=this;window.location.url!=e&&(e=t.addPushURLAtts(e),history.replaceState({url:e},"",e),t.loaded=!0)}}}(jQuery),popJSLibraryManager.register(popBrowserHistory,["documentInitialized"],!0),function(e){popURLInterceptors={fullurl:{},partialurl:{},pageSectionNewDOMsInitialized:function(t){var a=this,n=t.pageSection,r=t.newDOMs;r.find('[data-intercept="fullurl"]').addBack('[data-intercept="fullurl"]').each(function(){var t=e(this),r=t.attr("id"),i=a.getUrl(t),o=(a.getSettings(t),a.getTarget(n,t));a.fullurl[o]||(a.fullurl[o]={}),a.fullurl[o][i]||(a.fullurl[o][i]=[]),a.fullurl[o][i].push(r)}),r.find('[data-intercept="partialurl"]').addBack('[data-intercept="partialurl"]').each(function(){var t=e(this),r=t.attr("id"),i=a.getUrl(t),o=(a.getSettings(t),a.getTarget(n,t));a.partialurl[o]||(a.partialurl[o]={}),a.partialurl[o][r]=i})},destroyTarget:function(t){var a=this,n=t.pageSection,r=t.destroyTarget;r.find('[data-intercept="fullurl"]').each(function(){var t=e(this),r=t.attr("id"),i=a.getUrl(t),o=(a.getSettings(t),a.getTarget(n,t)),s=a.fullurl[o][i];s&&(s=s.filter(function(e,t){return r!=e}),s.length?a.fullurl[o][i]=s:delete a.fullurl[o][i])}),r.find('[data-intercept="partialurl"]').each(function(){var t=e(this),r=t.attr("id"),i=a.getTarget(n,t);delete a.partialurl[i][r]})},getSettings:function(e){var t=e.data("intercept-settings")||"";return t=t.split(M.SEPARATOR)},getTarget:function(e,t){return t.attr("target")||popManager.getFrameTarget(e)},getUrl:function(e){return e.data("intercept-url")},getFullUrlInterceptors:function(t,a){var n=this,r=[];a=a||{};var i=a.target||M.URLPARAM_TARGET_MAIN,o=n.fullurl;if(o[i])if(o[i][t])r.push(e("#"+o[i][t].join(", #")));else{var s=removeParams(t);if(t!=s&&o[i][s]){var c=e("#"+o[i][s].join(", #")).filter(".pop-interceptor");c.length&&r.push(c)}}return r},getPartialUrlInterceptor:function(t,a){var n=this,r=null;a=a||{};var i=a.target||M.URLPARAM_TARGET_MAIN,o=n.partialurl;if(i){var s=o[i];s&&e.each(s,function(a,n){if(t.startsWith(n))return r=e("#"+a),!1})}return r},getURLInterceptors:function(e,t){var a=this,n=a.getFullUrlInterceptors(e,t),r=a.getPartialUrlInterceptor(e,t);return r&&n.push(r),n},getInterceptors:function(e,t){var a=this,n=a.getURLInterceptors(e,t);if(n.length)return n;var r=removeMarker(e);return r!=e&&(n=a.getURLInterceptors(r,t)),n},intercept:function(t,a){var n=this;a=a||{};var r=n.getInterceptors(t,a);if(r.length){a.event&&a.event.stopImmediatePropagation(),e.each(r,function(e,r){var i=r.data("intercept-skipstateupdate")||a.skipstateupdate;if(!i){a.skipPushState||popBrowserHistory.pushState(t);var o=r.data("title");return o&&(n.documentTitle=unescapeHtml(o),document.title=popManager.documentTitle),-1}});var i=a["interceptor-atts"]||{};return e.each(r,function(r,o){e.each(i,function(e,t){o.data(e,t)});var s=a.relatedTarget;o.data("interceptedTarget",s);n.getSettings(o.parent());o.data("original-url",t),o.data("post-data",getParams(t)),o.trigger("click")}),!0}return!1}}}(jQuery),popJSLibraryManager.register(popURLInterceptors,["destroyTarget","pageSectionNewDOMsInitialized"],!0),function(e){popManager={mergingTemplatePromise:!1,memory:{settings:{},runtimesettings:{},dataset:{},feedback:{block:{},pagesection:{},toplevel:{}},params:{}},initialBlockMemory:{},urlPointers:{},replicableMemory:{},runtimeMemory:{general:{},url:{}},database:{},userdatabase:{},firstLoad:{},documentTitle:null,getMemory:function(){var e=this;return e.memory},getInitialBlockMemory:function(e){var t=this;if(e==M.INITIAL_URL)return t.initialBlockMemory[e];var a=t.urlPointers[e];return a?t.initialBlockMemory[a.url]:t.initialBlockMemory[e]||{}},addInitialBlockMemory:function(t){var a=this,n=t.feedback.toplevel[M.URLPARAM_URL];a.initialBlockMemory[n]||(a.initialBlockMemory[n]={dataset:{},feedback:{block:{}},params:{},runtimesettings:{configuration:{}}});var r=a.initialBlockMemory[n];e.each(t.settings.configuration,function(a,n){r.params[a]||(r.params[a]={},r.runtimesettings.configuration[a]={},r.dataset[a]={},r.feedback.block[a]={}),e.extend(r.params[a],t.params[a]),e.extend(r.runtimesettings.configuration[a],t.runtimesettings.configuration[a]),e.extend(r.dataset[a],t.dataset[a]),e.extend(r.feedback.block[a],t.feedback.block[a])})},getReplicableMemory:function(e,t){var a=this;t=t||M.URLPARAM_TARGET_MAIN;var n=a.urlPointers[e];return a.replicableMemory[n.url][n.target]},saveUrlPointers:function(t,a){var n=this;a=a||M.URLPARAM_TARGET_MAIN;var r=t.feedback.toplevel[M.URLPARAM_URL];e.each(t.feedback.pagesection,function(t,i){i["intercept-urls"]&&e.each(i["intercept-urls"],function(t,i){e.each(i,function(e,t){n.urlPointers[t]={url:r,target:a}})})}),e.each(t.feedback.block,function(t,i){e.each(i,function(t,i){i["intercept-urls"]&&e.each(i["intercept-urls"],function(t,i){e.each(i,function(e,t){n.urlPointers[t]={url:r,target:a}})})})})},addReplicableMemory:function(t,a){var n=this;a=a||M.URLPARAM_TARGET_MAIN;var r=!1;if(e.each(t.settings.configuration,function(e,t){if(t[M.JS_BLOCKSETTINGSIDS][M.JS_BLOCKUNITSREPLICABLE].length)return r=!0,-1}),r){var i=t.feedback.toplevel[M.URLPARAM_URL];n.replicableMemory[i]||(n.replicableMemory[i]={}),n.replicableMemory[i][a]={dataset:e.extend(!0,{},t.dataset),feedback:e.extend(!0,{},t.feedback),params:e.extend(!0,{},t.params)}}},getRuntimeMemory:function(e,t,a){var n=this;a=a||{};var r=n.getPageSectionPage(t),i=r.data("paramsscope");if(i==M.SETTINGS_PARAMSSCOPE_URL){var o=a.url||n.getTopLevelFeedback()[M.URLPARAM_URL];return n.runtimeMemory.url[o]||(n.runtimeMemory.url[o]={}),t.data("paramsscope-url",o),n.runtimeMemory.url[o]}return n.runtimeMemory.general},newRuntimeMemoryPage:function(e,t,a){var n=this;if(a=a||{},!a.url){var r=n.getTopLevelFeedback();a.url=r[M.URLPARAM_URL]}var i=n.getRuntimeMemory(e,t,a),o=n.getSettingsId(e),s=n.getSettingsId(t);return i[o]||(i[o]={}),i[o][s]={params:{},id:null},i[o][s]},deleteRuntimeMemoryPage:function(t,a,n){var r=this,i=r.getRuntimeMemory(t,a,n),o=r.getSettingsId(t),s=r.getSettingsId(a);i[o]&&(delete i[o][s],e.isEmptyObject(i[o])&&delete i[o])},getRuntimeMemoryPage:function(t,a,n){var r=this;n=n||{};var i,o;if(n.url)o=n.url;else if("object"==e.type(a)){var s=a;o=s.data("paramsscope-url")}i=o?r.runtimeMemory.url[o]:r.runtimeMemory.general;var c=r.getSettingsId(t),u=r.getSettingsId(a);if(!i[c]||!i[c][u]){var d="Mempage not available";throw o&&(d+=" for url "+o),new Error(d)}return i[c][u]},isFirstLoad:function(e){var t=this;return t.firstLoad[popManager.getSettingsId(e)]},init:function(){var t=this;if(e("#"+popPageSectionManager.getTopLevelSettingsId()).length){t.initDocument(),t.initTopLevelJson(),t.initLocalStorage(),popUserAccount.initialLogin();var a=t.getMemory(),n=[];e.each(a.settings.configuration,function(a,r){var i=r[M.JS_FRONTENDID],o=e("#"+i);o.attr("data-settings-id",a),o.addClass("pop-pagesection"),t.initPageSectionSettings(o,r),t.addPageSectionIds(o,r[M.JS_TEMPLATE]),t.initPageSection(o),n.push(o)}),e.each(n,function(e,a){t.renderPageSection(a)}),e("#body").removeClass("pop-loadingframe"),e.each(n,function(e,a){t.pageSectionInitialized(a)}),e("#body").removeClass("pop-loadingjs");var r=t.getTopLevelFeedback(),i=r[M.URLPARAM_URL];r[M.URLPARAM_SILENTDOCUMENT]||(popBrowserHistory.replaceState(i),t.updateDocument()),t.documentInitialized(),t.backgroundLoad(M.BACKGROUND_LOAD),t.backgroundLoad(r[M.URLPARAM_BACKGROUNDLOADURLS])}},expandJSKeys:function(e){e&&M.COMPACT_JS_KEYS&&(e[M.JS_MODULES]&&(e.modules=e[M.JS_MODULES]),e[M.JS_TEMPLATE]&&(e.template=e[M.JS_TEMPLATE]),e[M.JS_TEMPLATEIDS]&&(e["template-ids"]=e[M.JS_TEMPLATEIDS]),e[M.JS_SETTINGSID]&&(e["settings-id"]=e[M.JS_SETTINGSID]),e[M.JS_SETTINGSIDS]&&(e["settings-ids"]=e[M.JS_SETTINGSIDS],e[M.JS_SETTINGSIDS][M.JS_BLOCKUNITS]&&(e["settings-ids"].blockunits=e[M.JS_SETTINGSIDS][M.JS_BLOCKUNITS])),e[M.JS_INTERCEPT]&&(e.intercept=e[M.JS_INTERCEPT]),e[M.JS_BLOCKSETTINGSIDS]&&(e["block-settings-ids"]=e[M.JS_BLOCKSETTINGSIDS],e[M.JS_BLOCKSETTINGSIDS][M.JS_BLOCKUNITS]&&(e["block-settings-ids"].blockunits=e[M.JS_BLOCKSETTINGSIDS][M.JS_BLOCKUNITS]),e[M.JS_BLOCKSETTINGSIDS][M.JS_BLOCKUNITSREPLICABLE]&&(e["block-settings-ids"]["blockunits-replicable"]=e[M.JS_BLOCKSETTINGSIDS][M.JS_BLOCKUNITSREPLICABLE]),e[M.JS_BLOCKSETTINGSIDS][M.JS_BLOCKUNITSFRAME]&&(e["block-settings-ids"]["blockunits-frame"]=e[M.JS_BLOCKSETTINGSIDS][M.JS_BLOCKUNITSFRAME])),e[M.JS_REPLICATEBLOCKSETTINGSIDS]&&(e["replicate-blocksettingsids"]=e[M.JS_REPLICATEBLOCKSETTINGSIDS],e[M.JS_INTERCEPTSKIPSTATEUPDATE]&&(e["intercept-skipstateupdate"]=e[M.JS_INTERCEPTSKIPSTATEUPDATE]),e[M.JS_UNIQUEURLS]&&(e["unique-urls"]=e[M.JS_UNIQUEURLS]),e[M.JS_REPLICATETYPES]&&(e["replicate-types"]=e[M.JS_REPLICATETYPES])),e[M.JS_PARAMS]&&(e.params=e[M.JS_PARAMS]),e[M.JS_ITEMOBJECTPARAMS]&&(e["itemobject-params"]=e[M.JS_ITEMOBJECTPARAMS]),e[M.JS_PREVIOUSTEMPLATESIDS]&&(e["previoustemplates-ids"]=e[M.JS_PREVIOUSTEMPLATESIDS]),e[M.JS_BLOCKFEEDBACKPARAMS]&&(e["blockfeedback-params"]=e[M.JS_BLOCKFEEDBACKPARAMS]),e[M.JS_APPENDABLE]&&(e.appendable=e[M.JS_APPENDABLE]),e[M.JS_CLASS]&&(e.class=e[M.JS_CLASS]),e[M.JS_CLASSES]&&(e.classes=e[M.JS_CLASSES],e[M.JS_CLASSES][M.JS_APPENDABLE]&&(e.classes.appendable=e[M.JS_CLASSES][M.JS_APPENDABLE])),e[M.JS_TITLES]&&(e.titles=e[M.JS_TITLES]),popJSLibraryManager.execute("expandJSKeys",{context:e}))},addPageSectionIds:function(e,t){var a=this,n=a.getSettingsId(e),r=e.attr("id");popJSRuntimeManager.addPageSectionId(n,t,r);var i={pageSection:e,template:t};popJSLibraryManager.execute("addPageSectionIds",i)},initDocument:function(){var t=this;e(document).on("user:loggedout",function(e,a){t.clearUserDatabase()}),popJSLibraryManager.execute("initDocument"),e(document).triggerHandler("initialize.pop.document");
},documentInitialized:function(){popJSLibraryManager.execute("documentInitialized"),e(document).triggerHandler("initialized.pop.document")},backgroundLoad:function(t){var a=this,n={"loadingmsg-target":null,silentDocument:!0};e.each(t,function(t,r){e.each(r,function(r,i){a.fetch(t,e.extend({target:i},n))})})},initPageSection:function(t){var a=this;a.firstLoad[a.getSettingsId(t)]=!0,popJSLibraryManager.execute("initPageSection",{pageSection:t}),t.triggerHandler("initialize"),e(document).triggerHandler("initialize.pop.pagesection",[t])},pageSectionInitialized:function(e){var t=this;t.initPageSectionRuntimeMemory(e),popJSLibraryManager.execute("pageSectionInitialized",{pageSection:e}),e.triggerHandler("initialized"),e.triggerHandler("completed"),t.firstLoad[popManager.getSettingsId(e)]=!1},pageSectionNewDOMsInitialized:function(t,a,n){var r=this,i=a.filter(".pop-pagesection-page");if(i.length){n["fetch-params"]&&e.each(n["fetch-params"],function(e,t){i.data(e,t)});var o=popPageSectionManager.getOpenMode(t),s=r.isFirstLoad(t);("automatic"==o||s&&"initial"==o)&&popPageSectionManager.open(t)}var c={pageSection:t,newDOMs:a};r.extendArgs(c,n),popJSLibraryManager.execute("pageSectionNewDOMsBeforeInitialize",c),r.initPageSectionBranches(t,a,n),popJSLibraryManager.execute("pageSectionNewDOMsInitialized",c)},initPageSectionBranches:function(t,a,n){var r=this;r.runPageSectionJSMethods(t,n);var i=popManager.getPageSectionJsSettings(t),o=i["initjs-blockbranches"];if(o){var s=e(o.join(",")).not("."+M.JS_INITIALIZED);r.initBlockBranches(t,s,n)}popJSRuntimeManager.deletePageSectionLastSessionIds(t)},triggerDestroyTarget:function(e,t){var a=this;t=t||M.URLPARAM_TARGET_MAIN,popURLInterceptors.intercept(a.getDestroyUrl(e),{target:t})},destroyTarget:function(t,a){var n=this,r={pageSection:t,destroyTarget:a};popJSLibraryManager.execute("destroyTarget",r),a.triggerHandler("destroy");var i=a.find(".pop-block."+M.JS_INITIALIZED).addBack(".pop-block."+M.JS_INITIALIZED);i.each(function(){var a=e(this);n.deleteRuntimeMemoryPage(t,a,{url:a.data("paramsscope-url")})}),a.remove()},destroyPageSectionPage:function(e,t){var a=this,n=t||e;t.siblings(".pop-pagesection-page").length||(popPageSectionManager.close(e),popPageSectionManager.close(e,"xs")),a.destroyTarget(e,n)},pageSectionRendered:function(e,t,a){var n=this;n.pageSectionNewDOMsInitialized(e,t,a);var r={pageSection:e,newDOMs:t};n.extendArgs(r,a),popJSLibraryManager.execute("pageSectionRendered",r),e.triggerHandler("pageSectionRendered")},runScriptsBefore:function(e,t){var a={pageSection:e,newDOMs:t};popJSLibraryManager.execute("runScriptsBefore",a)},jsInitialized:function(e){return e.hasClass(M.JS_INITIALIZED)},jsLazy:function(e){return e.hasClass(M.CLASS_LAZYJS)},setJsInitialized:function(e){e.addClass(M.JS_INITIALIZED).removeClass(M.CLASS_LAZYJS)},initBlockBranches:function(t,a,n){var r=this;a.length&&a.each(function(){var a=e(this),i=!r.jsInitialized(a);if(n["force-init"]||(i=i&&!r.jsLazy(a)),i){r.setJsInitialized(a),r.initBlock(t,a,n);var o=popManager.getJsSettings(t,a),s=o["initjs-blockbranches"];s&&r.initBlockBranches(t,e(s.join(", ")).not("."+M.JS_INITIALIZED),n);var c=o["initjs-blockchildren"];if(c){var u=a;e.each(c,function(t,a){e.each(a,function(e,t){u=u.children(t).not("."+M.JS_INITIALIZED)})}),r.initBlockBranches(t,u,n)}}})},initBlock:function(t,a,n){var r=this;n=n||{},r.initBlockRuntimeMemory(t,a,e.extend({},n)),r.initializeBlock(t,a,n),r.runScriptsBefore(t,a),r.runBlockJSMethods(t,a,n),a.on("rendered",function(a,i){var o=e(this);r.runScriptsBefore(t,i),r.runBlockJSMethods(t,o,null,n)}),r.blockInitialized(t,a,n),r.loadBlockContent(t,a)},initializeBlock:function(e,t,a){var n=this,r={pageSection:e,block:t};n.extendArgs(r,a),popJSLibraryManager.execute("initBlock",r),t.triggerHandler("initialize")},extendArgs:function(t,a){a=a||{},a["js-args"]&&e.extend(t,a["js-args"])},blockInitialized:function(e,t,a){var n=this,r={pageSection:e,block:t};n.extendArgs(r,a),popJSLibraryManager.execute("blockInitialized",r),t.triggerHandler("js:initialized")},loadBlockContent:function(t,a){var n=this;if(!n.isContentLoaded(t,a)){n.setContentLoaded(t,a);var r={action:M.CBACTION_LOADCONTENT,"post-data":a.data("post-data")},i=n.getJsSettings(t,a);i["loadcontent-showdisabledlayer"]&&(r["show-disabled-layer"]=!0),e(document).ready(function(e){n.fetchBlock(t,a,r)})}},runPageSectionJSMethods:function(t,a){var n=this,r=popJSRuntimeManager.getPageSectionSessionIds(t);if(r){var i=[],o=popManager.getPageSectionJsMethods(t);e.each(o,function(o,s){i.indexOf(o)==-1&&(i.push(o),r[o]&&s&&e.each(s,function(i,s){var c=r[o][i];if(c){var u="#"+c.join(", #"),d=e(u);d.length&&e.each(s,function(e,r){var i={pageSection:t,targets:d};n.extendArgs(i,a),popJSLibraryManager.execute(r,i)})}}))})}},runBlockJSMethods:function(e,t,a){var n=this;n.runJSMethods(e,t,null,null,a),popJSRuntimeManager.deleteBlockLastSessionIds(e,t)},runJSMethods:function(e,t,a,n,r){var i=this,o=popJSRuntimeManager.getBlockSessionIds(e,t,n);if(o){var s=i.getTemplateJSMethods(e,t,a);i.runJSMethodsInner(e,t,s,o,[],r)}},runJSMethodsInner:function(t,a,n,r,i,o){var s=this;o=o||{};var c=n[M.JS_TEMPLATE],u=n[M.JS_METHODS];i.indexOf(c)==-1&&(i.push(c),r[c]&&u&&e.each(u,function(n,i){var u=r[c][n];if(u){var d="#"+u.join(", #"),g=e(d);g.length&&e.each(i,function(e,n){var r={pageSection:t,block:a,targets:g};s.extendArgs(r,o),popJSLibraryManager.execute(n,r)})}})),n[M.JS_NEXT]&&e.each(n[M.JS_NEXT],function(e,n){s.runJSMethodsInner(t,a,n,r,i,o)})},getTemplateJSMethods:function(e,t,a){var n=this,r=popManager.getBlockJsMethods(e,t);return a?n.getTemplateJSMethodsInner(e,t,a,r):r},getTemplateJSMethodsInner:function(t,a,n,r){var i=this;if(r[M.JS_TEMPLATE]==n)return r;var o;return r[M.JS_NEXT]&&e.each(r[M.JS_NEXT],function(e,r){if(o=i.getTemplateJSMethodsInner(t,a,n,r))return!1}),o},maybeRedirect:function(e){var t=this;if(e.redirect&&e.redirect.url){if(!e.redirect.fetch)return window.location=e.redirect.url,!0;t.click(e.redirect.url)}return!1},historyReplaceState:function(e,t){var a=this,n=e.data("historystate-url"),r=e.data("historystate-title");e.data("historystate-thumb");popBrowserHistory.replaceState(n),r&&(a.documentTitle=unescapeHtml(r),document.title=a.documentTitle)},hideIfEmpty:function(e,t){var a=popManager.getBlockFeedback(e,t);return a[M.URLPARAM_HIDEBLOCK]},isHidden:function(t){if(t.hasClass("hidden"))return!0;var a=t.attr("id");if(a&&!e("#"+a).length)return!0;var n=t.parents(".tab-pane"),r=n.filter(".active");if(n.length>r.length)return!0;var i=popJSLibraryManager.execute("isHidden",{targets:t}),o=!1;return e.each(i,function(e,t){if(t)return o=!0,-1}),o},isActive:function(t){var a=popJSLibraryManager.execute("isActive",{targets:t}),n=!0;return e.each(a,function(e,t){if(!t)return n=!1,-1}),n},isContentLoaded:function(e,t){var a=this,n=a.getBlockParams(e,t);return n[M.DATALOAD_CONTENTLOADED]||!1},setContentLoaded:function(e,t){var a=this,n=a.getBlockParams(e,t);n[M.DATALOAD_CONTENTLOADED]=!0},getSettingsTemplate:function(e){return e.data("templateid")?e:e.closest("data-templateid")},updateDocument:function(){var e=this,t=e.getTopLevelFeedback();e.documentTitle=unescapeHtml(t[M.URLPARAM_TITLE]),document.title=e.documentTitle},hideMessages:function(e){var t=popPageSectionManager.getPageSectionStatus(e),a=t.find(".pop-loading"),n=t.find(".pop-error");a.addClass("hidden"),n.addClass("hidden")},executeSetFilterBlockParams:function(t,a,n){var r=this,i=r.getBlockParams(t,a);i.filter=n.find("."+M.FILTER_INPUT).filter(function(){return e.trim(this.value)}).serialize(),i.filter&&(i.filter+="&"+n.find("."+M.FILTER_NAME_INPUT).serialize())},setFilterBlockParams:function(e,t,a){var n=this;n.jsInitialized(t)?n.executeSetFilterBlockParams(e,t,a):t.one("js:initialized",function(){n.executeSetFilterBlockParams(e,t,a)})},filter:function(e,t,a){var n=this;n.setFilterBlockParams(e,t,a),n.reload(e,t),n.blockScrollTop(e,t)},blockScrollTop:function(e,t){var a=this,n=t.closest(".modal");0==n.length?a.scrollToElem(e,t.children(".blocksection-status").first(),!0):n.animate({scrollTop:0},"fast")},setReloadBlockParams:function(e,t){var a=this,n=a.getBlockParams(e,t);n[M.DATALOAD_PARAMS]&&n[M.DATALOAD_PARAMS][M.URLPARAM_PAGED]&&(n[M.DATALOAD_PARAMS][M.URLPARAM_PAGED]=""),n[M.URLPARAM_STOPFETCHING]&&(n[M.URLPARAM_STOPFETCHING]=!1)},refetch:function(e,t,a){a=a||{},a.action=M.CBACTION_REFETCH,t.triggerHandler("beforeRefetch"),popManager.reload(e,t,a)},reset:function(e,t,a){var n=this;a=a||{},a["skip-restore"]||n.restoreInitialBlockMemory(e,t),n.processBlock(e,t,{operation:M.URLPARAM_OPERATION_REPLACE,action:M.CBACTION_RESET,reset:!0})},reload:function(e,t,a){var n=this;a=a||{},a.operation=M.URLPARAM_OPERATION_REPLACE,a.reload=!0,a["hide-latestcount"]=!0,n.setReloadBlockParams(e,t),t.triggerHandler("beforeReload"),n.fetchBlock(e,t,a)},loadLatest:function(t,a,n){var r=this;n=n||{};var i=r.getBlockParams(t,a);n.operation=M.URLPARAM_OPERATION_PREPEND,n["skip-stopfetching-check"]=!0,n["hide-latestcount"]=!0;var o={};o[M.URLPARAM_ACTION]=M.URLPARAM_ACTION_LATEST,o[M.URLPARAM_TIMESTAMP]=i[M.URLPARAM_TIMESTAMP],n["onetime-post-data"]=e.param(o),a.triggerHandler("beforeLoadLatest"),r.fetchBlock(t,a,n)},handleLoadingStatus:function(t,a,n){var r;if(n=n||{},"undefined"!=typeof n["loadingmsg-target"]){if(!n["loadingmsg-target"])return;r=e(n["loadingmsg-target"])}else{var i=popPageSectionManager.getPageSectionStatus(t);r=i.find(".pop-loading");var o=i.find(".pop-error");o.addClass("hidden")}var s=r.data("num")||0;"add"==a?s+=1:"remove"==a&&(s-=1),r.data("num",s),s?r.removeClass("hidden"):r.addClass("hidden"),s>=2?r.find(".pop-box").text("x"+s):r.find(".pop-box").text("")},fetch:function(e,t){var a=this;t=t||{};var n=a.getFetchTargetPageSection(t.target),r=a.getPageSectionParams(n);return r?void a.fetchPageSection(n,e,t):void(t["noparams-reload-url"]&&(window.location=e))},initLocalStorage:function(){if(M.USELOCALSTORAGE&&Modernizr.localstorage){var e=localStorage["PoP:version"];e&&e==M.VERSION||(Object.keys(localStorage).forEach(function(e){e.startsWith(M.HOME_URL)&&localStorage.removeItem(e)}),localStorage["PoP:version"]=M.VERSION)}},openTabs:function(){var t=this;if(M.KEEP_OPEN_TABS){var a={silentDocument:!0,"js-args":{inactivePane:!0,addOpenTab:!1}},n=window.location.href;n==M.HOME_URL&&(n=M.HOME_URL+"/"),n==M.HOME_URL+"/"&&M.HOMELOCALE_URL&&(n=M.HOMELOCALE_URL);var r=t.getOpenTabs();e.each(r,function(r,i){if(a.target=r,r==M.URLPARAM_TARGET_MAIN){var o=i.indexOf(n);o!==-1&&i.splice(o,1)}e.each(i,function(e,n){t.fetch(n,a)})})}},getOpenTabs:function(){var e=this;return M.KEEP_OPEN_TABS?e.getStoredData("PoP:openTabs")||{}:{}},addOpenTab:function(e,t){var a=this;if(!M.KEEP_OPEN_TABS)return!1;var n=a.getOpenTabs();return n[t]=n[t]||[],!(n[t].indexOf(e)>-1)&&(n[t].push(e),a.storeData("PoP:openTabs",n),!0)},removeOpenTab:function(e,t){var a=this;if(!M.KEEP_OPEN_TABS)return!1;var n=a.getOpenTabs();n[t]=n[t]||[];var r=n[t].indexOf(e);return r!==-1&&(n[t].splice(r,1),a.storeData("PoP:openTabs",n),!0)},replaceOpenTab:function(e,t,a){var n=this;M.KEEP_OPEN_TABS&&n.removeOpenTab(e,a)&&n.addOpenTab(t,a)},getStoredData:function(t){if(M.USELOCALSTORAGE&&Modernizr.localstorage){var a=localStorage[t];if(a){if(a=e.parseJSON(a),a.version==M.VERSION&&("undefined"==typeof a.expires||a.expires>Date.now()))return a.value;delete localStorage[t]}}return null},storeData:function(e,t,a){if(M.USELOCALSTORAGE&&Modernizr.localstorage){var n={version:M.VERSION,value:t};a&&(n.expires=Date.now()+a);try{localStorage[e]=JSON.stringify(n)}catch(e){}}},fetchPageSection:function(t,a,n){var r=this,i=r.getPageSectionParams(t);if(i&&!(i.loading.indexOf(a)>-1)){n=n||{};var o=r.getTarget(t),s=a;s.indexOf("#")>-1&&(s=s.substr(0,s.indexOf("#"))),s=add_query_arg(M.URLPARAM_TARGET,o,s),s=add_query_arg(M.URLPARAM_MODULE,M.URLPARAM_MODULE_SETTINGSDATA,s),s=add_query_arg(M.URLPARAM_OUTPUT,M.URLPARAM_OUTPUT_JSON,s);var c=r.getTopLevelFeedback(),u=e.extend({},c[M.DATALOAD_PARAMS],i[M.DATALOAD_PARAMS]);n.params&&e.extend(u,n.params);var d,g=e.param(u);d=s+"|"+g;var l=r.getStoredData(d);if(l)return r.processPageSectionResponse(t,l,n),void r.triggerURLFetched(a);var p=popPageSectionManager.getPageSectionStatus(t),f=p.find(".pop-error");n["disable-layer"]&&n["disable-layer"].children(".pop-disabledlayer").removeClass("hidden");var S=r.getCrossDomainOptions(s);e.ajax(e.extend(S,{dataType:"json",url:s,data:g,beforeSend:function(e,s){e.url=a,i.url[e.url]=a,i.target[e.url]=o,i["fetch-url"][e.url]=s.url,i.loading.push(a),r.handleLoadingStatus(t,"add",n)},complete:function(a){var o=i.url[a.url];if(delete i.url[a.url],delete i.target[a.url],delete i["fetch-url"][a.url],i.loading.splice(i.loading.indexOf(o),1),r.handleLoadingStatus(t,"remove",n),n["urlfetched-callbacks"]){var s="urlfetched:"+escape(o);e.each(n["urlfetched-callbacks"],function(t,a){e(document).one(s,a)})}r.triggerURLFetched(o),n["disable-layer"]&&n["disable-layer"].children(".pop-disabledlayer").addClass("hidden")},success:function(e,a,o){r.backgroundLoad(e.feedback.toplevel[M.URLPARAM_BACKGROUNDLOADURLS]),f.addClass("hidden");var s=i.url[o.url],c=e.feedback.toplevel[M.URLPARAM_URL],u=i.target[o.url];s!=c&&r.replaceOpenTab(s,c,u),n["fetch-params"]={url:s,target:u,"fetch-url":i["fetch-url"][o.url]},e.feedback.toplevel[M.URLPARAM_STORELOCAL]&&r.storeData(d,e),r.processPageSectionResponse(t,e,n)},error:function(e,a,n){var o=i.url[e.url];r.showError(t,r.getError(o,e,a,n)),t.triggerHandler("fetchFailed")}}))}},getCrossDomainOptions:function(t){var a={};return t.startsWith(M.HOME_URL)||e.each(M.ALLOWED_URLS,function(e,n){if(t.startsWith(n))return a.xhrFields={withCredentials:!0},a.crossDomain=!0,-1}),a},showError:function(e,t){var a=this,n=popPageSectionManager.getPageSectionStatus(e),r=n.find(".pop-error");r.children("div.pop-box").html(t),r.removeClass("hidden"),a.scrollTop(r)},triggerURLFetched:function(t){e(document).triggerHandler("urlfetched:"+escape(t)),e(document).triggerHandler("urlfetched",[t])},processPageSectionResponse:function(t,a,n){var r=this,i=r.getTarget(t);r.saveUrlPointers(a,i),r.addReplicableMemory(a,i),r.addInitialBlockMemory(a),r.integrateDatabases(a);var o=e.Deferred(),s=r.mergingTemplatePromise;r.mergingTemplatePromise=o.promise(),s?s.done(function(){r.processPageSection(t,a,n)}):r.processPageSection(t,a,n),o.resolve()},maybeUpdateDocument:function(e,t){var a=this;if(t=t||{},!t.silentDocument){var n=a.getFetchPageSectionSettings(e);if(n.updateDocument){if(!t.skipPushState){var r=a.getTopLevelFeedback();popBrowserHistory.pushState(r[M.URLPARAM_URL])}a.updateDocument()}}},processPageSection:function(t,a,n){var r=this,i=r.getTarget(t);r.integrateTopLevelFeedback(a);var o=r.getTopLevelFeedback(),s=o[M.URLPARAM_ERROR];s&&r.showError(t,s);var c=o[M.URLPARAM_URL];n.reloadurl&&r.triggerDestroyTarget(c,i),o[M.URLPARAM_SILENTDOCUMENT]&&(n.silentDocument=!0),r.maybeUpdateDocument(t,n),n.maybeRedirect&&r.maybeRedirect(o)||(r.integratePageSection(a),e.each(a.settings.configuration,function(t,a){var i=a[M.JS_FRONTENDID],o=e("#"+i);r.renderPageSection(o,n),o.triggerHandler("fetched",[n,c]),o.triggerHandler("completed")}))},scrollToElem:function(e,t,a){popPerfectScrollbar.scrollToElem(e,t,a)},scrollTop:function(e,t,a){popPerfectScrollbar.scrollTop(e,t,a)||popBootstrap.scrollTop(e)},getPosition:function(e){return popPerfectScrollbar.getPosition(e)},getSettingsId:function(t){if("object"==e.type(t)){var a=t;return a.attr("data-settings-id")}return t},getError:function(e,t,a,n){return 0===t.status?M.ERROR_OFFLINE.format(e):404==t.status?M.ERROR_404:M.ERROR_MSG.format(e)},closeMessageFeedback:function(t){e(document).ready(function(e){t.find(".pop-messagefeedback").removeClass("fade").alert("close")})},closeMessageFeedbacks:function(t){e(document).ready(function(e){t.find(".pop-messagefeedback").removeClass("fade").alert("close")})},processBlock:function(e,t,a){var n=this,r=n.getSettingsId(e),i=n.getSettingsId(t),o=n.getMemory();a.extendContext={items:o.dataset[r][i]},n.renderTarget(e,t,a)},fetchBlock:function(e,t,a){var n=this;if(a=a||{},!a["skip-stopfetching-check"]){var r=n.getBlockParams(e,t);if(r[M.URLPARAM_STOPFETCHING])return}n.executeFetchBlock(e,t,a)},getBlockPostData:function(t,a,n){var r=this;n=n||{};var i=n.paramsGroup||"all",o=r.getBlockParams(t,a),s={};"all"==i&&e.extend(s,o[M.DATALOAD_PARAMS]);var c=o[M.DATALOAD_VISIBLEPARAMS];c&&e.extend(s,c),e.each(s,function(e,t){t||delete s[e]});var u=e.param(s);return o.filter&&(u&&(u+="&"),u+=o.filter),u},handleBlockError:function(t,a,n){var r=this,i=[".errormsg.status-"+a.status,".errormsg.general"];e.each(i,function(e,a){var n=t.find(a);if(n.length)return n.removeClass("hidden").siblings(".errormsg").addClass("hidden"),!1}),n["skip-status"]||(t.removeClass("hidden"),r.scrollTop(t))},executeFetchBlock:function(t,a,n){var r=this;n=n||{};var i=r.getQueryUrl(t,a);if(i){var o=r.getBlockParams(t,a);n["post-data"]&&(o["post-data"]=n["post-data"]);var s=r.getTopLevelFeedback(),c=r.getPageSectionFeedback(t),u=r.getBlockFeedback(t,a),d=e.extend({},s[M.DATALOAD_PARAMS],c[M.DATALOAD_PARAMS],u[M.DATALOAD_PARAMS]),g=e.param(d);o["post-data"]&&(g&&(g+="&"),g+=o["post-data"]),n["onetime-post-data"]&&(g&&(g+="&"),g+=n["onetime-post-data"]);var l=r.getBlockPostData(t,a);g&&l&&(g+="&"),g+=l;var p=r.getTarget(t);i=add_query_arg(M.URLPARAM_TARGET,p,i),i=add_query_arg(M.URLPARAM_MODULE,M.URLPARAM_MODULE_DATA,i),i=add_query_arg(M.URLPARAM_OUTPUT,M.URLPARAM_OUTPUT_JSON,i);var f=i+g;if(!(o.loading.indexOf(f)>-1)){var S=a.find(".pop-loading"),A=a.find(".pop-error");n["skip-status"]||(S.removeClass("hidden"),A.addClass("hidden"),r.closeMessageFeedback(a)),r.triggerEvent(t,a,"beforeFetch",[n]);var h=n.type||"GET";n["show-disabled-layer"]&&a.children(".pop-disabledlayer").removeClass("hidden");var m=r.getCrossDomainOptions(i);e.ajax(e.extend(m,{dataType:"json",url:i,data:g,type:h,beforeSend:function(e,t){e.url=t.url,o.url[e.url]=f,o.loading.push(f),o.operation[f]=n.operation,o.action[f]=n.action,o["paramsscope-url"][f]=a.data("paramsscope-url"),n.reload&&o.reload.push(f)},success:function(i,s,c){r.backgroundLoad(i.feedback.toplevel[M.URLPARAM_BACKGROUNDLOADURLS]),n["hide-latestcount"]&&a.children(".blocksection-latestcount").find(".pop-latestcount").addClass("hidden").find(".pop-count").text("0");var u=r.mergingTemplatePromise,d=e.Deferred(),g=d.promise();r.mergingTemplatePromise=g,u?u.done(function(){r.executeFetchBlockSuccess(t,a,o,i,c)}):r.executeFetchBlockSuccess(t,a,o,i,c),d.resolve()},error:function(e,i,o){r.handleBlockError(A,e,n),r.triggerEvent(t,a,"fetchFailed")},complete:function(i){var s={},c=o.url[i.url];delete o.url[i.url],o.loading.splice(o.loading.indexOf(c),1),delete o.operation[c],delete o.action[c],delete o["paramsscope-url"][c];var u=o.reload.indexOf(c);u>-1&&(s.reload=!0,o.reload.splice(u,1));var d=r.mergingTemplatePromise,g=e.Deferred(),l=g.promise();r.mergingTemplatePromise=l,d?d.done(function(){r.fetchBlockComplete(t,a,o,s,n)}):r.fetchBlockComplete(t,a,o,s,n),g.resolve()}}))}}},fetchBlockComplete:function(t,a,n,r,i){var o=this;if(a.children(".pop-disabledlayer").addClass("hidden"),i["datasetcount-target"]&&o.displayDatasetCount(t,a,e(i["datasetcount-target"]),i["datasetcount-updatetitle"]),!n.loading.length){var s=a.find(".pop-loading");s.addClass("hidden")}var c=o.getBlockParams(t,a);c[M.URLPARAM_STOPFETCHING]?a.addClass("pop-stopfetching"):a.removeClass("pop-stopfetching"),o.triggerEvent(t,a,"fetchCompleted",[r])},displayDatasetCount:function(e,t,a,n){var r=this,i=r.getBlockDataset(e,t);if(i.length){var o=a.data("datasetcount-mode")||"add",s=i.length;"add"==o&&(s+=a.text()?parseInt(a.text()):0),s&&(a.removeClass("hidden").text(s),n&&(document.title="("+s+") "+r.documentTitle))}},executeFetchBlockSuccess:function(t,a,n,r,i){var o=this,s=n.url[i.url],c=n.action[s],u={url:n["paramsscope-url"][s]},d={operation:n.operation[s],action:n.action[s]},g=o.getMemory(),l=[M.CBACTION_LOADCONTENT,M.CBACTION_REFETCH,M.CBACTION_RESET],p=l.indexOf(c)>-1;if(p){var f=o.getInitialBlockMemory(u.url);e.each(r.params,function(t,a){e.each(a,function(e,a){g.runtimesettings.configuration[t][e]=f.runtimesettings.configuration[t][e]})})}o.integrateTopLevelFeedback(r),o.integrateDatabases(r),e.each(r.params,function(t,a){var n=e("#"+g.settings.configuration[t].id);g.feedback.block[t]||(g.feedback.block[t]={}),e.extend(g.feedback.block[t],r.feedback.block[t]),g.dataset[t]||(g.dataset[t]={}),e.extend(g.dataset[t],r.dataset[t]),g.params[t]||(g.params[t]={}),e.extend(g.params[t]),e.each(a,function(a,i){try{var s=e("#"+o.getBlockId(t,a,u));e.extend(o.getBlockParams(n,s,u),i);var g=[M.CBACTION_LOADCONTENT,M.CBACTION_REFETCH];if(g.indexOf(c)>-1){var l=o.getJsSettings(n,s);if(l["processblock-ifhasdata"]&&!r.dataset[t][a].length)return}o.processBlock(n,s,d)}catch(e){}})}),a.triggerHandler("fetched",[r,c])},triggerEvent:function(e,t,a,n){t.triggerHandler(a,n)},integrateTopLevelFeedback:function(t){var a=this,n=a.getMemory().feedback.toplevel;e.each(t.feedback.toplevel,function(t,a){"array"==e.type(a)&&0==a.length||("object"==e.type(a)?(n[t]||(n[t]={}),e.extend(n[t],a)):n[t]=a)})},clearUserDatabase:function(){var e=this;e.userdatabase={}},integrateDatabase:function(t,a){e.each(a,function(a,n){t[a]=t[a]||{},"array"!=e.type(n)&&e.each(n,function(n,r){t[a][n]||(t[a][n]={}),e.extend(t[a][n],r)})})},integrateDatabases:function(e){var t=this;t.integrateDatabase(t.database,e.database),t.integrateDatabase(t.userdatabase,e.userdatabase)},getMergeTargetContainer:function(t){return t.data("merge-container")?e(t.data("merge-container")):t},getMergeTarget:function(t,a,n){var r=this;n=n||{};var i=".pop-merge."+a,o=n["merge-target"]?e(n["merge-target"]):t.find(i).addBack(i);return r.getMergeTargetContainer(o)},generateUniqueId:function(){var e=this,t=Date.now(),a=e.getTopLevelFeedback();return a[M.UNIQUEID]=t,t},getUniqueId:function(){var e=this,t=e.getTopLevelFeedback();return t[M.UNIQUEID]},addUniqueId:function(e){var t=this,a=t.getUniqueId();return e+"#"+a},mergeTargetTemplate:function(e,t,a,n){var r=this;n=n||{};var i=[M.CBACTION_LOADCONTENT,M.CBACTION_REFETCH,M.CBACTION_RESET],o=i.indexOf(n.action)>-1;o&&r.generateUniqueId();var s=r.getTemplateHtml(e,t,a,n),c=r.getMergeTarget(t,a,n),u=n.operation||M.URLPARAM_OPERATION_REPLACE;u==M.URLPARAM_OPERATION_REPLACE&&(t.triggerHandler("replace",[n.action]),o&&t.triggerHandler("rerender",[n.action]),c.empty());var d=r.mergeHtml(s,c,u);return t.triggerHandler("merged",[d.newDOMs]),d},mergeHtml:function(t,a,n){var r=this,i=e(t);return n==M.URLPARAM_OPERATION_PREPEND?a.prepend(i):n==M.URLPARAM_OPERATION_REPLACEINLINE?(a.replaceWith(i),a=i):a.append(i),r.triggerHTMLMerged(),{targetContainer:a,newDOMs:i}},triggerHTMLMerged:function(){e(document).triggerHandler("template:merged")},renderPageSection:function(t,a){var n=this;a=a||{},e.extend(a,n.getFetchPageSectionSettings(t));var r=n.renderTarget(t,t,a);r.length&&n.pageSectionRendered(t,r,a)},renderTarget:function(t,a,n){var r=this;n=n||{},a.triggerHandler("beforeMerge",[n]);var i=r.getTemplatesCbs(t,a,n.action),o=e(),s=e();return e.each(i,function(e,i){var c=r.mergeTargetTemplate(t,a,i,n);o=o.add(c.targetContainer),s=s.add(c.newDOMs)}),r.triggerRendered(a,s,o),s},triggerRendered:function(t,a,n){t.triggerHandler("rendered",[a,n]),e(document).triggerHandler("rendered",[t,a,n])},getPageSectionConfiguration:function(e){var t=this,a=t.getSettingsId(e);return t.getMemory().settings.configuration[a]},getTargetConfiguration:function(t,a,n){var r=this,i=r.getTemplatePath(t,a,n),o=r.getPageSectionConfiguration(t);return e.each(i,function(e,t){o=o[t]}),o},overrideFromItemObject:function(t,a,n){t&&e.each(n,function(e,n){a[n.key]=t[n.field]})},replaceFromItemObject:function(t,a,n,r,i,o){var s=this,c=s.getTopLevelFeedback(),u=s.getTargetConfiguration(t,a,n);e.each(o,function(t,a){var n=a["replace-where-field"],o=a["replace-where-path"],s=a["replace-from-field"]||n,d=a.replacements,g=u[s];e.each(d,function(e,t){var a=t["replace-str"];if(r){var n=t["replace-with-field"];if(n&&a!=r[n]){var i=r[n];t["encode-uri-component"]?i=encodeURIComponent(i):t["encode-uri"]&&(i=encodeURI(i)),g=g.replace(new RegExp(a,"g"),i)}}var o=t["replace-from-feedback"];o&&a!=c[o]&&(g=g.replace(new RegExp(a,"g"),c[o]))});var l=i;o&&e.each(o,function(e,t){l[t]={},l=l[t]}),l[n]=g})},getTemplateHtml:function(t,a,n,r,i,o){var s=this,c=s.getTargetConfiguration(t,a,n);r=r||{},targetContext=c;var u=s.getTemplatePath(t,a,n);if(u.length){var d=s.getBlock(a);s.initContextSettings(t,d,targetContext),s.extendContext(targetContext,i,o)}var g=r.extendContext;return g&&(targetContext=e.extend({},targetContext,g)),s.getHtml(n,targetContext)},extendContext:function(t,a,n,r){var i=this;if(r=r||{},e.extend(t,r),a&&(e.extend(t,{itemDBKey:a}),n)){var o=i.getItemObject(a,n);e.extend(t,{itemObject:o})}},initTopLevelJson:function(){var t=this,a=e("#"+popPageSectionManager.getTopLevelSettingsId()),n=e.parseJSON(a.html());t.database=n.database,t.userdatabase=n.userdatabase;var r=t.getMemory();r.settings=n.settings,r.runtimesettings=n.runtimesettings,r.dataset=n.dataset,r.feedback=n.feedback,r.params=n.params,e.each(r.dataset,function(t,a){"array"==e.type(a)&&(r.dataset[t]={})}),e.each(r.params,function(t,a){"array"==e.type(a)&&(r.params[t]={})}),e.each(r.feedback.pagesection,function(t,a){"array"==e.type(a)&&(r.feedback.pagesection[t]={})}),e.each(r.feedback.block,function(t,a){"array"==e.type(a)&&(r.feedback.block[t]={})}),t.saveUrlPointers(n),t.addReplicableMemory(n),t.addInitialBlockMemory(n)},getBlockDefaultParams:function(){return{url:[],loading:[],reload:[],operation:{},action:{},"paramsscope-url":{},"post-data":"",filter:""}},getPageSectionDefaultParams:function(){return{url:{},target:{},"fetch-url":{},loading:[]}},initPageSectionRuntimeMemory:function(e,t){var a=this,n=a.newRuntimeMemoryPage(e,e,t);a.getSettingsId(e);n.params=a.getPageSectionDefaultParams();var r={pageSection:e,runtimeMempage:n};popJSLibraryManager.execute("initPageSectionRuntimeMemory",r)},initBlockRuntimeMemory:function(t,a,n){var r=this,i=r.newRuntimeMemoryPage(t,a,n),o=r.getSettingsId(t),s=r.getSettingsId(a);i.params=e.extend(r.getBlockDefaultParams(),r.getMemory().params[o][s]),i["query-url"]=r.getRuntimeSettings(t,a,"query-url"),i.id=a.attr("id");var c={pageSection:t,block:a,runtimeMempage:i};popJSLibraryManager.execute("initBlockRuntimeMemory",c)},getViewport:function(e,t){var a=t.closest(".pop-viewport");return a.length?a:e},getDOMContainer:function(t,a){var n=this;return M.DOMCONTAINER_ID?e("#"+M.DOMCONTAINER_ID):n.getViewport(t,a)},getBlock:function(t){return t.hasClass("pop-block")?t:t.closest(".pop-block").length?t.closest(".pop-block"):t.closest("[data-block]").length?e(t.closest("[data-block]").data("block")):null},isBlockGroup:function(e){return e.hasClass("pop-blockgroup")},getBlockGroupActiveBlock:function(e){return e.find(".tab-pane.active .pop-block, .collapse.in .pop-block")},getBlockGroupBlocks:function(e){return e.find(".pop-block")},getTemplateSource:function(e){var t=this;return t.getMemory().settings["template-sources"][e]||e},initPageSectionSettings:function(t,a){var n=this,r=n.getTopLevelSettings();e.extend(a,{tls:r});var i=n.getPageSectionSettings(t),o=n.getSettingsId(t),s=a[M.JS_FRONTENDID];e.extend(a,{pss:i}),n.expandJSKeys(a),a[M.JS_MODULES]&&e.each(a[M.JS_MODULES],function(t,a){var c=a[M.JS_FRONTENDID],u=n.getBlockSettings(o,t,s,c);e.extend(a,{tls:r,pss:i,bs:u}),n.expandJSKeys(a)})},initContextSettings:function(t,a,n){var r=this,i=r.getTopLevelSettings();e.extend(n,{tls:i});var o=r.getPageSectionSettings(t);e.extend(n,{pss:o});var s=r.getSettingsId(t),c=t.attr("id"),u=r.getSettingsId(a),d=a.attr("id"),g=r.getBlockSettings(s,u,c,d);e.extend(n,{pss:o,bs:g}),r.expandJSKeys(n),n.itemDBKey||(n.itemDBKey=g["db-keys"]["db-key"])},integratePageSection:function(t){var a=this,n=a.getMemory();e.extend(n.settings["template-sources"],t.settings["template-sources"]),e.each(t.settings.configuration,function(r,i){e.extend(n.params[r],t.params[r]),e.extend(n.dataset[r],t.dataset[r]),e.extend(n.feedback.pagesection[r],t.feedback.pagesection[r]),e.extend(n.feedback.block[r],t.feedback.block[r]),e.extend(n.runtimesettings["query-url"][r],t.runtimesettings["query-url"][r]),e.extend(n.runtimesettings.configuration[r],t.runtimesettings.configuration[r]),e.extend(n.settings["js-settings"][r],t.settings["js-settings"][r]),e.extend(n.settings.jsmethods.pagesection[r],t.settings.jsmethods.pagesection[r]),e.extend(n.settings.jsmethods.block[r],t.settings.jsmethods.block[r]),e.extend(n.settings["templates-cbs"][r],t.settings["templates-cbs"][r]),e.extend(n.settings["templates-paths"][r],t.settings["templates-paths"][r]),e.extend(n.settings["db-keys"][r],t.settings["db-keys"][r]),n.settings.configuration[r]||(n.settings.configuration[r]={});var o=n.settings.configuration[r];e.each(i,function(t,a){"array"==e.type(a)?o[t]={}:"object"==e.type(a)?(o[t]||(o[t]={}),e.extend(o[t],a)):o[t]=a});var s=i[M.JS_FRONTENDID],c=e("#"+s);a.initPageSectionSettings(c,o)})},getTopLevelSettings:function(){var e=this;return{feedback:e.getTopLevelFeedback()}},getPageSectionSettings:function(e){var t=this,a=t.getSettingsId(e),n=e.attr("id"),r={feedback:t.getPageSectionFeedback(e),pssId:a,psId:n};return r},getBlockSettings:function(e,t,a,n){var r=this,i={"db-keys":r.getDatabaseKeys(e,t),dataset:r.getBlockDataset(e,t),feedback:r.getBlockFeedback(e,t),bsId:t,bId:n};return r.expandBlockSettingsJSKeys(i),i},expandBlockSettingsJSKeys:function(e){e&&M.COMPACT_JS_KEYS&&e["db-keys"]&&e["db-keys"][M.JS_SUBCOMPONENTS]&&(e["db-keys"].subcomponents=e["db-keys"][M.JS_SUBCOMPONENTS])},getBlockDataset:function(e,t){var a=this,n=a.getSettingsId(e),r=a.getSettingsId(t);return a.getMemory().dataset[n][r]},getBlockFeedback:function(e,t){var a=this,n=a.getSettingsId(e),r=a.getSettingsId(t);return a.getMemory().feedback.block[n][r]},getPageSectionFeedback:function(e){var t=this,a=t.getSettingsId(e);return t.getMemory().feedback.pagesection[a]},getTopLevelFeedback:function(){var e=this;return e.getMemory().feedback.toplevel},getSettings:function(e,t,a){var n=this,r=n.getSettingsId(e),i=n.getSettingsId(t),o=n.getMemory();return o.settings[a][r][i]},getRuntimeSettings:function(e,t,a){var n=this,r=n.getSettingsId(e),i=n.getSettingsId(t),o=n.getMemory();return o.runtimesettings[a][r][i]},getQueryUrl:function(e,t){var a=this;return a.getRuntimeMemoryPage(e,t)["query-url"]},getRuntimeConfiguration:function(e,t,a){var n=this;a=a||t;var r=n.getTemplateOrObjectSettingsId(a),i=n.getRuntimeSettings(e,t,"configuration");return i[r]||{}},getDatabaseKeys:function(e,t){var a=this;return a.getSettings(e,t,"db-keys")},getBlockFilteringUrl:function(e,t,a){var n=this,r=n.getQueryUrl(e,t);!r&&a&&(r=n.getTopLevelFeedback()[M.URLPARAM_URL]);var i=n.getBlockPostData(e,t,{paramsGroup:"visible"});return i&&(r+=r.indexOf("?")>-1?"&":"?",r+=i),r},click:function(t,a,n){a=a||"",n=n||e("body");var r='<a href="'+t+'" target="'+a+'" class="hidden"></a>',i=e(r).appendTo(n);i.trigger("click")},getUnembedUrl:function(t){var a=popJSLibraryManager.execute("getUnembedUrl",{url:t});return e.each(a,function(e,a){if(a)return t=a,-1}),t},getEmbedUrl:function(t){var a=popJSLibraryManager.execute("getEmbedUrl",{url:t});return e.each(a,function(e,a){if(a)return t=a,-1}),t},getPrintUrl:function(t){var a=popJSLibraryManager.execute("getPrintUrl",{url:t});return e.each(a,function(e,a){if(a)return t=a,-1}),t},getDestroyUrl:function(t){var a=M.HOME_URL;return e.each(M.ALLOWED_URLS,function(e,n){if(t.startsWith(n))return a=n,-1}),t.replace(a,a+"/destroy")},getTemplateOrObjectSettingsId:function(t){return"object"==e.type(t)?t.data("templateid"):t},getPageSectionJsSettings:function(e){var t=this;t.getSettingsId(e);return t.getSettings(e,e,"js-settings")||{}},getJsSettings:function(e,t,a){var n=this;a=a||t;var r=(n.getSettingsId(e),n.getSettingsId(t),n.getTemplateOrObjectSettingsId(a)),i=n.getSettings(e,t,"js-settings");return i[r]||{}},getPageSectionJsMethods:function(e){
var t=this,a=t.getSettingsId(e),n=t.getMemory();return n.settings.jsmethods.pagesection[a]||{}},getBlockJsMethods:function(e,t){var a=this,n=a.getSettingsId(e),r=a.getSettingsId(t),i=a.getMemory();return i.settings.jsmethods.block[n][r]||{}},restoreInitialBlockMemory:function(t,a,n){var r=this,i=r.getSettingsId(t),o=r.getSettingsId(a),s=a.data("paramsscope-url"),c=r.getInitialBlockMemory(s);r.getRuntimeMemoryPage(t,a,n).params=e.extend(r.getBlockDefaultParams(),c.params[i][o]),r.getMemory().runtimesettings.configuration[i][o]=e.extend({},c.runtimesettings.configuration[i][o]),r.getMemory().feedback.block[i][o]=e.extend({},c.feedback.block[i][o]);var u=c.dataset[i][o];u.length?e.extend(r.getMemory().dataset[i][o],u):r.getMemory().dataset[i][o]=[]},getBlockParams:function(e,t,a){var n=this;return n.getRuntimeMemoryPage(e,t,a).params},getPageSectionParams:function(e,t){var a=this;return a.getRuntimeMemoryPage(e,e,t).params},getTarget:function(t){var a=t.attr("id"),n=M.URLPARAM_TARGET_MAIN;return e.each(M.FETCHTARGET_SETTINGS,function(e,t){if(t==a)return n=e,-1}),n},targetExists:function(e){return M.FETCHTARGET_SETTINGS[e]},getFetchTargetPageSection:function(t){return t&&"_self"!=t&&M.FETCHTARGET_SETTINGS[t]||(t=M.URLPARAM_TARGET_MAIN),e("#"+M.FETCHTARGET_SETTINGS[t])},getFetchPageSectionSettings:function(e){var t=e.attr("id");return M.FETCHPAGESECTION_SETTINGS[t]||{}},getTemplatesCbs:function(t,a,n){var r=this;n=n||"main";var i=r.getSettings(t,a,"templates-cbs"),o=i.cbs,s=i.actions;if(e.isArray(s)&&!s.length)return o;var c=[];return e.each(o,function(e,t){(!s[t]||s[t].indexOf(n)>-1)&&c.push(t)}),c},getTemplatePath:function(e,t,a){var n=this,r=n.getSettings(e,t,"templates-paths");return r[a]},getScriptTemplate:function(e){var t=this,a=t.getTemplateSource(e);return Handlebars.templates[a]},getPageSectionGroup:function(e){return e.closest(".pop-pagesection-group").addBack(".pop-pagesection-group")},getPageSection:function(e){return e.closest(".pop-pagesection").addBack(".pop-pagesection")},getPageSectionPage:function(e){var t=this,a=e.closest(".pop-pagesection-page").addBack(".pop-pagesection-page");return a.length?a:t.getPageSection(e)},getBlockId:function(e,t,a){var n=this;return n.getRuntimeMemoryPage(e,t,a).id},getHtml:function(e,t){var a=this,n=a.getScriptTemplate(e);return"undefined"==typeof n?(console.error("No template for "+e),""):n(t)},getItemObject:function(t,a){var n=this,r={},i={};return n.userdatabase[t]&&n.userdatabase[t][a]&&(r=n.userdatabase[t][a]),n.database[t]&&n.database[t][a]&&(i=n.database[t][a]),e.extend({},r,i)},getFrameTarget:function(e){return e.data("frametarget")||M.URLPARAM_TARGET_MAIN},getClickFrameTarget:function(e){var t=this;return e.data("clickframetarget")||t.getFrameTarget(e)},getOriginalLink:function(e){var t=this,a=e.data("interceptedTarget");return a?t.getOriginalLink(a):e}}}(jQuery);