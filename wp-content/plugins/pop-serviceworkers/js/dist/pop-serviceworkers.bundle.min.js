!function(e){popServiceWorkers={pages:{},documentInitialized:function(a){var r=this;"serviceWorker"in navigator&&(navigator.serviceWorker.onmessage=function(a){var t=JSON.parse(a.data);if("refresh"===t.type&&r.pages[t.url]){var o=e("#"+r.pages[t.url]);o&&o.data("fetch-url")&&(r.showRefreshMessage(o),delete r.pages[t.url])}},navigator.serviceWorker.addEventListener("controllerchange",function(){var a=e("#"+M.IDS_APPSTATUS);a.prepend(M.SW_MESSAGES_WEBSITEUPDATED.format(window.location.href))}))},pageSectionNewDOMsBeforeInitialize:function(e){var a=this,r=e.pageSection,t=e.newDOMs,o=r.attr("id");if(M.SW_MAIN_PAGESECTIONS&&M.SW_MAIN_PAGESECTIONS.indexOf(o)>-1){var i=t.filter(".pop-pagesection-page");if(i.length){var n=i.data("fetch-url");n&&(a.pages[n]=i.attr("id"),i.one("destroy",function(){delete a.pages[n]}))}}},modifyFetchArgs:function(e){var a=e.options;a["js-args"]&&(anchor=a["js-args"].relatedTarget,anchor&&anchor.data("sw-networkfirst")&&(a.params=a.params||{},a.params[M.SW_URLPARAM_NETWORKFIRST]="true"))},modifyFetchBlockArgs:function(e){var a=e.options;e.url;a.reload&&(a["onetime-post-data"]=a["onetime-post-data"]?a["onetime-post-data"]+"&":"",a["onetime-post-data"]+=M.SW_URLPARAM_NETWORKFIRST+"=true")},fetchBrowserURL:function(a){e(document).on("initialized.pop.document",function(){var e={skipPushState:!0};popManager.fetch(window.location.href,e)})},resetTimestamp:function(e){var a=e.pageSection,r=e.block;if("serviceWorker"in navigator){var t=popManager.getBlockParams(a,r);t[M.URLPARAM_TIMESTAMP]=Math.floor(Date.now()/1e3)+60*M.GMT_OFFSET*60}},showRefreshMessage:function(e){var a=e.data("url"),r=e.data("target");e.prepend(M.SW_MESSAGES_PAGEUPDATED.format(a,r))}}}(jQuery),popJSLibraryManager.register(popServiceWorkers,["documentInitialized","pageSectionNewDOMsBeforeInitialize","modifyFetchArgs","modifyFetchBlockArgs","fetchBrowserURL","resetTimestamp"]);