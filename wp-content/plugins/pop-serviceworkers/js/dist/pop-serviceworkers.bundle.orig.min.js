(function($){popServiceWorkers={documentInitialized:function(args){var t=this;if('serviceWorker'in navigator){navigator.serviceWorker.onmessage=function(event){var message=JSON.parse(event.data);if(message.type==='refresh'){$(document).triggerHandler('popServiceWorkers:refreshed:'+message.url);}};}},pageSectionNewDOMsBeforeInitialize:function(args){var t=this;var pageSection=args.pageSection,newDOMs=args.newDOMs;var psId=pageSection.attr('id');if(M.SW_MAIN_PAGESECTIONS&&(M.SW_MAIN_PAGESECTIONS.indexOf(psId)>-1)){var pageSectionPage=newDOMs.filter('.pop-pagesection-page');if(pageSectionPage.length){var url=pageSectionPage.data('fetch-url');if(url){$(document).one('popServiceWorkers:refreshed:'+url,function(){if(pageSectionPage.data('fetch-url')){t.showRefreshMessage(pageSectionPage);}});}}}},modifyOptions:function(args){var t=this;var options=args.options,url=args.url,anchor=args.anchor;if(anchor.data('sw-networkfirst')){options.params=options.params||{};options.params[M.SW_URLPARAM_NETWORKFIRST]='true';}},fetchBrowserURL:function(args){var t=this;$(document).on('initialized.pop.document',function(){var options={skipPushState:true,};popManager.fetch(window.location.href,options);});},reopenTabs:function(args){var t=this;$(document).on('initialized.pop.document',function(){popManager.openTabs();});},showRefreshMessage:function(pageSectionPage){var t=this;var url=pageSectionPage.data('url');var target=pageSectionPage.data('target');pageSectionPage.prepend(M.SW_MESSAGE.format(url,target));},};})(jQuery);popJSLibraryManager.register(popServiceWorkers,['documentInitialized','pageSectionNewDOMsBeforeInitialize','modifyOptions','fetchBrowserURL','reopenTabs']);