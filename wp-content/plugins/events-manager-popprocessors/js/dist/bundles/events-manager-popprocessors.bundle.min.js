"use strict";Handlebars.registerHelper("locationsPageURL",function(e,r){return M.LOCATIONS_PAGE_URL[e]});
;"use strict";!function(t){window.popCreateLocation={createLocationModal:function(t){var a=this,e=t.pageSection,o=t.targets;a.execCreateLocationModal(e,o)},createLocationModalBlock:function(t){var a=this,e=t.pageSection,o=t.targets,r=t.relatedTarget;a.transferAttributes(o.closest(".modal"),r),a.execCreateLocationModal(e,o.closest(".modal"))},maybeCloseLocationModal:function(a){var e=a.pageSection,o=a.targets,r=popManager.getSettingsId(e);o.on("fetched",function(a,e){var o=t(this),n=popManager.getSettingsId(o);!0===e.feedback.block[r][n].result&&o.closest(".modal").modal("hide")})},transferAttributes:function(t,a){a=popManager.getOriginalLink(a),t.data("typeahead-target",a.data("typeahead-target"))},execCreateLocationModal:function(a,e){var o=this;e.addClass("pop-createlocation"),e.on("show.bs.modal",function(a){var e=t(this),r=t(a.relatedTarget);o.transferAttributes(e,r)})}}}(jQuery),popJSLibraryManager.register(popCreateLocation,["createLocationModal","createLocationModalBlock","maybeCloseLocationModal"]);
;"use strict";!function(e){window.popMap={initBlockRuntimeMemoryIndependent:function(e){var r=this,n=e.pageSection,t=e.block;e.runtimeMempage.map={},r.resetBlockRuntimeMemory(n,t)},map:function(r){var n=this,t=r.domain,a=r.pageSection,i=r.block,o=r.targets;i.one("rerender",function(e){n.destroy(a,i,o)}),e(document).ready(function(e){o.each(function(){var r=e(this);n.triggerShowMap(t,a,i,r)}),M.USE_PROGRESSIVEBOOTING&&!popManager.jsInitialized(i)&&i.one("initialize",function(){o.each(function(){var r=e(this);n.triggerAddMarkers(t,a,i,r)})})})},mapModal:function(r){var n=this,t=r.domain,a=r.pageSection;r.targets.on("shown.bs.modal",function(){var r=e(this);e.each(r.find(".pop-map"),function(){var r=e(this),i=popManager.getBlock(r);popManager.jsInitialized(i)&&n.triggerShowMap(t,a,i,r)})})},mapStandalone:function(r){var n=this,t=r.pageSection,a=r.block,i=r.targets;popPageSectionManager.getGroup(t).on("on.bs.pagesection:theater off.bs.pagesection:theater",function(r){i.each(function(){var r=e(this);popManager.isHidden(r)||n.refresh(t,a,r)})}),a.on("fetchDomainCompleted",function(r,o,s){popJSRuntimeManager.setBlockURL(a),i.each(function(){var r=e(this);n.triggerAddMarkers(s,t,a,r,o)})}),i.each(function(){var r=e(this);n.hoverBlockElems(t,a,r)})},getRuntimeMemoryPage:function(e,r){return popManager.getRuntimeMemoryPage(e,r).map},resetBlockRuntimeMemory:function(r,n){var t=this,a=t.getRuntimeMemoryPage(r,n),i=t.getEmtpyBlockRuntimeMemory();e.extend(a,i)},getEmtpyBlockRuntimeMemory:function(){return{markers:{},markersPos:{},markersOpen:{},maps:{}}},destroy:function(r,n,t){var a=this.getRuntimeMemoryPage(r,n);t.each(function(){var r=e(this).attr("id");delete a.maps[r]})},triggerShowMap:function(e,r,n,t){var a=this;popManager.isHidden(t)?a.pendingTriggerMap("showmap",e,r,n,t):a.execTriggerShowMap(e,r,n,t)},triggerAddMarkers:function(e,r,n,t,a){var i=this;if(a=a||{},popManager.isHidden(t))i.pendingTriggerMap("addmarkers",e,r,n,t,a);else{var o=a.reload&&a.isFirst;i.addMarkers(e,r,n,t,o)}},triggerFunction:function(e,r,n,t,a,i){var o=this;"showmap"==e?o.triggerShowMap(r,n,t,a):"addmarkers"==e&&o.triggerAddMarkers(r,n,t,a,i)},pendingTriggerMap:function(r,n,t,a,i,o){var s=this,g=popManager.getPageSectionPage(a);popPageSectionManager.execIsHidden(t)?popPageSectionManager.getGroup(t).one("on.bs.pagesection-group:pagesection-"+t.attr("id")+":opened",function(){(a=e("#"+a.attr("id"))).length&&s.triggerFunction(r,n,t,a,i,o)}):i.parents(".collapse").not(".in").length?i.parents(".collapse").not(".in").one("shown.bs.collapse",function(){s.triggerFunction(r,n,t,a,i,o)}):g.hasClass("tab-pane")&&!popManager.isActive(g)&&g.one("shown.bs.tabpane",function(){s.triggerFunction(r,n,t,a,i,o)})},execTriggerShowMap:function(e,r,n,t){this.addMarkers(e,r,n,t,t.data("markers-removecurrent")),windowResize()},refresh:function(e,r,n){var t=this.getGMap(e,r,n);t&&t.refresh()},hoverBlockElems:function(r,n,t){var a=this;n.on("mouseenter",".pop-openmapmarkers",function(){var i,o=e(this);if(o.hasClass("make-popover")){var s=o.attr("aria-describedby");s&&(i=e("#"+s).find("a.pop-modalmap-link"))}else i=o.find("a.pop-modalmap-link");a.openMapMarkers(r,n,t,i)})},openMapMarkers:function(e,r,n,t){var a=this;popManager.isHidden(n)||(a.closeMarkers(e,r,n),t.length&&a.openMarkers(e,r,n,t))},closeMarkers:function(r,n,t){var a=this,i=a.getGMap(r,n,t);if(i){var o=a.getMarkersInfo(r,n,t);i.hideInfoWindows(),e.each(o.markersOpen,function(e,r){var n=o.markersPos[r];i.markers[n]&&i.markers[n].setIcon("https://maps.google.com/mapfiles/ms/icons/red-dot.png")})}},getMarkerIdsFromLinkURLs:function(r){var n=[];return r.each(function(){var r=e(this),t=(r=popManager.getOriginalLink(r)).attr("href"),a=getParam(M.LOCATIONSID_FIELDNAME,t);a&&e.each(a,function(e,r){n.push(r)})}),n},openMarkers:function(r,n,t,a){var i=this,o=i.getMarkerIdsFromLinkURLs(a);if(o.length){o=o.filter(function(e,r){return o.indexOf(e)==r});var s=i.getGMap(r,n,t);if(s){var g=i.getMarkersInfo(r,n,t);if(e.each(o,function(e,r){var n=g.markersPos[r];s.markers[n]&&s.markers[n].setIcon("https://maps.google.com/mapfiles/ms/icons/green-dot.png")}),1==o.length){var m=g.markersPos[o[0]];s.markers[m]&&"undefined"!=typeof google&&google.maps.event.trigger(s.markers[m],"click")}else s.fitZoom();i.setMarkersOpen(r,n,t,o,!0)}}},initMarker:function(e,r,n,t){var a=this.getRuntimeMemoryPage(e,r),i=a.markers[n];if(i){if(i.title.split(" | ").indexOf(t.title)>-1)return;t.title=i.title+" | "+t.title,t.infoWindow.content=t.infoWindow.content+"<hr/>"+i.infoWindow.content,t.icon="https://maps.google.com/mapfiles/ms/icons/red-dot.png"}a.markers[n]=t},hasMarker:function(e,r,n){return this.getRuntimeMemoryPage(e,r).markers[n]},getGMap:function(e,r,n){var t=this;if("undefined"!=typeof google&&"undefined"!=typeof GMaps){var a=t.getRuntimeMemoryPage(e,r),i=n.attr("id"),o=a.maps[i];return o||(o=new GMaps({div:"#"+i,lat:M.LOCATIONSMAP_LAT,lng:M.LOCATIONSMAP_LNG,zoom:parseInt(M.LOCATIONSMAP_ZOOM)}),a.maps[i]=o),o}},getMarkersInfo:function(e,r,n){var t=this,a=n.data("markers-pagesection")||e,i=n.data("markers-block")||r,o=t.getEmtpyBlockRuntimeMemory();try{o=t.getRuntimeMemoryPage(a,i)}catch(e){console.log("Error: "+e.message)}var s=n.attr("id");return{markers:o.markers||{},markersPos:o.markersPos[s]||{},markersOpen:o.markersOpen[s]||[]}},setMarkersOpen:function(e,r,n,t,a){var i=this.getRuntimeMemoryPage(e,r),o=n.attr("id");!a&&i.markersOpen[o]||(i.markersOpen[o]=[]),t&&(i.markersOpen[o]=i.markersOpen[o].concat(t))},setMarkersPos:function(r,n,t,a,i){var o=this.getRuntimeMemoryPage(r,n),s=t.attr("id");!i&&o.markersPos[s]||(o.markersPos[s]={}),a&&e.extend(o.markersPos[s],a)},removeMarker:function(e,r,n,t){var a=this,i=a.getGMap(e,r,n);if(i){var o=a.getMarkersInfo(e,r,n).markersPos[t];i.markers[o]&&i.markers[o].setMap(null),a.zoom(e,r,n)}},zoom:function(e,r,n){var t=this.getGMap(e,r,n);if(t)if(t.markers.length>1)t.fitZoom();else if(1==t.markers.length){var a=t.markers[0].getPosition();t.setCenter(a.lat(),a.lng()),t.setZoom(parseInt(M.LOCATIONSMAP_1MARKER_ZOOM))}},addMarkers:function(r,n,t,a,i){var o=this,s=o.getGMap(n,t,a);if(s){i&&(s.removeMarkers(),o.setMarkersOpen(n,t,a,null,!0),o.setMarkersPos(n,t,a,null,!0));var g=a.data("marker-ids-"+removeScheme(r));if(g&&g.length){a.data("marker-ids-"+removeScheme(r),null);var m,p,c,d=o.getMarkersInfo(n,t,a),M={};e.each(g,function(e,r){if(m=d.markers[r]){var n={content:m.infoWindow.header+"<br/>"+m.infoWindow.content},t={lat:m.coordinates.lat,lng:m.coordinates.lng,title:m.title,infoWindow:n,icon:m.icon};"undefined"!=typeof google&&(t.animation=google.maps.Animation.DROP),p=s.addMarker(t),c=s.markers.length-1,M[r]=c}}),o.setMarkersPos(n,t,a,M);var l=a.data("open-onemarker-infowindow");1==g.length&&l&&(s.hideInfoWindows(),"undefined"!=typeof google&&google.maps.event.trigger(p,"click")),o.zoom(n,t,a)}}},geocode:function(e,r,n,t,a,i){var o=this.getGMap(e,r,n);o&&GMaps.geocode({address:t,callback:function(e,r){if("OK"==r){o.removeMarkers();var n=e[0].geometry.location;o.setCenter(n.lat(),n.lng()),o.addMarker({lat:n.lat(),lng:n.lng(),draggable:!0}),o.setZoom(parseInt(M.LOCATIONSMAP_1MARKER_ZOOM)),a.val(n.lat()),i.val(n.lng());var t=o.markers[0];"undefined"!=typeof google&&google.maps.event.addListener(t,"dragend",function(){var e=t.getPosition();a.val(e.lat()),i.val(e.lng())})}}})}}}(jQuery),function(e){window.popMapRuntime={initBlockRuntimeMemoryIndependent:function(e){var r=this,n=e.pageSection,t=e.block;e.runtimeMempage.mapRuntime={},r.resetBlockRuntimeMemory(n,t)},getRuntimeMemoryPage:function(e,r){return popManager.getRuntimeMemoryPage(e,r).mapRuntime},resetBlockRuntimeMemory:function(r,n){var t=this.getRuntimeMemoryPage(r,n),a={content:"",title:"",marker_ids:[]};e.extend(t,a)},drawMarkers:function(e,r,n,t){var a=this;popManager.jsInitialized(n)?a.execDrawMarkers(e,r,n,t):n.one("initialize",function(){a.execDrawMarkers(e,r,n,t)})},execDrawMarkers:function(e,r,n,t){var a=this.getRuntimeMemoryPage(r,n);t.data("marker-ids-"+removeScheme(e),a.marker_ids)},resetMarkerIds:function(e,r){var n=this;popManager.jsInitialized(r)?n.execResetMarkerIds(e,r):r.one("initialize",function(){n.execResetMarkerIds(e,r)})},execResetMarkerIds:function(e,r){this.getRuntimeMemoryPage(e,r).marker_ids=[]},setMarkerData:function(e,r,n,t){var a=this;popManager.jsInitialized(r)?a.execSetMarkerData(e,r,n,t):r.one("initialize",function(){a.execSetMarkerData(e,r,n,t)})},execSetMarkerData:function(e,r,n,t){var a=this.getRuntimeMemoryPage(e,r);a.title||(a.title=n),a.content||(a.content=t)},initMarker:function(e,r,n,t,a,i,o){var s=this;popManager.jsInitialized(r)?s.execInitMarker(e,r,n,t,a,i,o):r.one("initialize",function(){s.execInitMarker(e,r,n,t,a,i,o)})},execInitMarker:function(e,r,n,t,a,i,o){var s=this,g=s.getRuntimeMemoryPage(e,r);s.setMarkerData(e,r,i,o);var m=g.title,p={coordinates:{lat:t,lng:a},title:m,infoWindow:{header:"<strong>"+m+"</strong>",content:g.content},icon:"https://maps.google.com/mapfiles/ms/icons/red-dot.png"};g.marker_ids.push(n),popMap.initMarker(e,r,n,p),g.content="",g.title=""}}}(jQuery),popJSLibraryManager.register(popMap,["initBlockRuntimeMemoryIndependent","map","mapModal","mapStandalone"]),popJSLibraryManager.register(popMapRuntime,["initBlockRuntimeMemoryIndependent"]);
;"use strict";!function(e){window.popTypeaheadMap={typeaheadMap:function(a){var p=a.domain,t=a.pageSection,o=a.block;a.targets.each(function(){var a=e(this),r=a.find(".pop-typeahead"),n=a.find(".pop-map"),i=a.data("addmarker-template");r.on("selected",function(r,d){if(!popMap.hasMarker(t,o,d.id)){var M=popManager.getTargetConfiguration(p,t,o,i);e.extend(M,{itemObject:d}),popJSRuntimeManager.setBlockURL(o);var s=popManager.getTemplateHtml(p,t,o,i);popManager.mergeHtml(s,a),popManager.runJSMethods(p,t,o,i,"last"),popJSRuntimeManager.deleteBlockLastSessionIds(p,t,o,i)}n.data("marker-ids-"+removeScheme(p),[d.id]),popMap.addMarkers(p,t,o,n)}),r.on("close",function(e,a,p){popMap.removeMarker(t,o,n,p)})})}}}(jQuery),popJSLibraryManager.register(popTypeaheadMap,["typeaheadMap"]);
;"use strict";!function(a){window.popMapCollection={formMapLocationGeocode:function(o){var e=o.pageSection,t=o.block;o.targets.find("input.address-input").change(function(){var o=a(this).closest("div.pop-map-locationgeocode"),n=[];o.find("input.address-input").each(function(){var o=a(this);o.val()&&n.push(o.val())});var i=o.find("div.pop-map"),p=o.find("input.address-lat"),r=o.find("input.address-lng");popMap.geocode(e,t,i,n.join(", "),p,r)})},modalMap:function(o){var e=this,t=o.domain;o.targets.on("show.bs.modal",function(o){var n=a(this),i=a(o.relatedTarget);e.execModalMap(t,n,i)})},modalMapBlock:function(a){var o=this,e=a.domain,t=(a.pageSection,a.block,a.targets),n=a.relatedTarget,i=t.closest(".modal");o.execModalMap(e,i,n)},execModalMap:function(a,o,e){e=popManager.getOriginalLink(e);var t=popManager.getBlock(e),n=popManager.getPageSection(t),i=o.find(".pop-map");i.data("markers-pagesection",n),i.data("markers-block",t),i.data("markers-removecurrent",!0);var p=popMap.getMarkerIdsFromLinkURLs(e);i.data("marker-ids-"+removeScheme(a),p)}}}(jQuery),popJSLibraryManager.register(popMapCollection,["formMapLocationGeocode","modalMap","modalMapBlock"]);
;"use strict";!function(e){window.popFullCalendar={initBlockRuntimeMemoryIndependent:function(e){var t=this,n=e.pageSection,a=e.block;e.runtimeMempage.fullCalendar={},t.resetBlockRuntimeMemory(n,a)},calendar:function(t){var n=this,a=t.domain,r=t.pageSection,o=t.block,i=t.targets,d=popManager.getPageSectionPage(o);d.one("destroy",function(){i.fullCalendar("destroy")}),d.hasClass("tab-pane")&&!popManager.isActive(d)&&d.one("shown.bs.tabpane",function(){i.fullCalendar("render")}),o.on("beforeRender",function(t,a){var o=e(this);a.operation==M.URLPARAM_OPERATION_REPLACE&&n.resetBlockRuntimeMemory(r,o)}),o.on("addedEvents",function(){n.execCalendar(a,r,o,i,"update"),windowResize()}),n.execCalendar(a,r,o,i,"new")},getRuntimeMemoryPage:function(e,t){return popManager.getRuntimeMemoryPage(e,t).fullCalendar},resetBlockRuntimeMemory:function(t,n){var a=this.getRuntimeMemoryPage(t,n),r={eventsHtml:{},runJS:!1,events:[],loadedEventIds:{},loadedDates:{}};e.extend(a,r)},addEvents:function(e,t,n){var a=this;n.length&&(popManager.jsInitialized(t)?a.execAddEvents(e,t,n):t.one("initialize",function(){a.execAddEvents(e,t,n)}))},execAddEvents:function(t,n,a){var r=this,o=r.getRuntimeMemoryPage(t,n),i=[];e.each(a,function(e,a){r.isEventLoaded(t,n,a.domain,a.id)||(i.push(a),r.setEventLoaded(t,n,a.domain,a.id))}),e.merge(o.events,i),n.triggerHandler("addedEvents")},execCalendar:function(t,n,a,r,o){var i,d=this,l=d.getRuntimeMemoryPage(n,a),s=d.getDate(n,a);"new"==o&&(i={header:{left:"title",center:"",right:""},events:function(e,t,n,a){a(l.events)},defaultDate:s,fixedWeekCount:!1,height:"auto",contentHeight:"auto",dayNamesShort:M.DATERANGE_DAYSOFWEEK}),r.each(function(){var r=e(this);d.execFullCalendar(t,n,a,r,o,i)}),d.setDateLoaded(n,a,s)},execFullCalendar:function(t,n,a,r,o,i){var d=this;if("new"==o){var l=popManager.getJsSettings(t,n,a,r),s=l.options||{},u=e.extend({},i,s),c=l.layouts;u.eventRender=function(e,t){d.renderEvent(n,a,c,e,t)},u.eventAfterAllRender=function(e){d.renderEventAfterAll(n,a,c)},r.fullCalendar(u)}else"update"==o&&r.fullCalendar("refetchEvents")},setDateLoaded:function(e,t,n){this.getRuntimeMemoryPage(e,t).loadedDates[n.year()+"-"+(n.month()+1)]=!0},isDateLoaded:function(e,t,n){return!0===this.getRuntimeMemoryPage(e,t).loadedDates[n.year()+"-"+(n.month()+1)]},setEventLoaded:function(e,t,n,a){var r=this.getRuntimeMemoryPage(e,t);r.loadedEventIds[n]=r.loadedEventIds[n]||{},r.loadedEventIds[n][a]=!0},isEventLoaded:function(e,t,n,a){var r=this.getRuntimeMemoryPage(e,t);return r.loadedEventIds[n]&&!0===r.loadedEventIds[n][a]},getDate:function(e,t){var n=popManager.getBlockQueryState(e,t),a=parseInt(n[M.DATALOAD_VISIBLEPARAMS][M.URLPARAM_YEAR]),r=parseInt(n[M.DATALOAD_VISIBLEPARAMS][M.URLPARAM_MONTH]);return moment(a+"-"+r+"-01","YYYY-M-DD")},renderEvent:function(t,n,a,r,o){var i=this.getRuntimeMemoryPage(t,n),d=r.domain,l=r.id;i.eventsHtml[d]=i.eventsHtml[d]||{};var s=i.eventsHtml[d][l];if(s)i.runJS=!0;else{var u={},c=popManager.getDatabaseKeys(d,t,n)["db-key"];s="",popJSRuntimeManager.setBlockURL(n),e.each(a,function(e,a){s+=popManager.getTemplateHtml(d,t,n,a,u,c,l)}),i.eventsHtml[d][l]=s}o.html(s)},renderEventAfterAll:function(t,n,a){var r=this.getRuntimeMemoryPage(t,n);if(popManager.triggerHTMLMerged(),r.runJS){r.runJS=!1;var o=popManager.getQueryMultiDomainUrls(t,n);e.each(o,function(r,o){e.each(a,function(e,a){popManager.runJSMethods(r,t,n,a,"full")})})}},fetch:function(e,t,n){var a=this,r=a.getDate(e,t);n.fullCalendar("gotoDate",r),a.isDateLoaded(e,t,r)||popManager.fetchBlock(e,t,{operation:M.URLPARAM_OPERATION_APPEND})}}}(jQuery),function(e){window.popFullCalendarControls={controlCalendarPrev:function(t){var n=this,a=t.pageSection,r=t.block;t.targets.click(function(t){var o=e(this);n.execute(a,r,o,"prev")})},controlCalendarNext:function(t){var n=this,a=t.pageSection,r=t.block;t.targets.click(function(t){var o=e(this);n.execute(a,r,o,"next")})},setCalendarBlockParams:function(e,t,n){var a=popManager.getBlockQueryState(e,t);a[M.DATALOAD_VISIBLEPARAMS][M.URLPARAM_YEAR]=n.year(),a[M.DATALOAD_VISIBLEPARAMS][M.URLPARAM_MONTH]=n.month()+1},execute:function(t,n,a,r){var o=this,i=e(a.closest(".pop-calendar-controls").data("target")),d=i.fullCalendar("getDate");"next"==r?d.add(1,"months"):d=d.subtract(1,"months"),o.setCalendarBlockParams(t,n,d),popManager.closeMessageFeedback(n),popFullCalendar.fetch(t,n,i)}}}(jQuery),popJSLibraryManager.register(popFullCalendar,["initBlockRuntimeMemoryIndependent","calendar"]),popJSLibraryManager.register(popFullCalendarControls,["controlCalendarPrev","controlCalendarNext"]);