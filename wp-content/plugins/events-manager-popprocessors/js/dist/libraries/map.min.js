!function(e){popMap={initBlockRuntimeMemory:function(e){var r=this,t=e.pageSection,a=e.block;e.runtimeMempage.map={},r.resetBlockRuntimeMemory(t,a)},map:function(r){var t=this,a=r.domain,n=r.pageSection,o=r.block,i=r.targets;o.one("rerender",function(e){t.destroy(n,o,i)}),e(document).ready(function(e){i.each(function(){var r=e(this);t.triggerShowMap(a,n,o,r)})})},mapModal:function(r){var t=this,a=r.domain,n=r.pageSection;r.targets.on("shown.bs.modal",function(){var r=e(this);e.each(r.find(".pop-map"),function(){var r=e(this),o=popManager.getBlock(r);popManager.jsInitialized(o)&&t.triggerShowMap(a,n,o,r)})})},mapStandalone:function(r){var t=this,a=r.pageSection,n=r.block,o=r.targets;popPageSectionManager.getGroup(a).on("on.bs.pagesection:theater off.bs.pagesection:theater",function(r){o.each(function(){var r=e(this);popManager.isHidden(r)||t.refresh(a,n,r)})}),n.on("fetchDomainCompleted",function(r,i,s){popJSRuntimeManager.setBlockURL(n),o.each(function(){var r=e(this);t.triggerAddMarkers(s,a,n,r,i)})}),o.each(function(){var r=e(this);t.hoverBlockElems(a,n,r)})},getRuntimeMemoryPage:function(e,r){return popManager.getRuntimeMemoryPage(e,r).map},resetBlockRuntimeMemory:function(r,t){var a=this,n=a.getRuntimeMemoryPage(r,t),o=a.getEmtpyBlockRuntimeMemory();e.extend(n,o)},getEmtpyBlockRuntimeMemory:function(){return{markers:{},markersPos:{},markersOpen:{},maps:{}}},destroy:function(r,t,a){var n=this.getRuntimeMemoryPage(r,t);a.each(function(){var r=e(this).attr("id");delete n.maps[r]})},triggerShowMap:function(e,r,t,a){var n=this;popManager.isHidden(a)?n.pendingTriggerMap("showmap",e,r,t,a):n.execTriggerShowMap(e,r,t,a)},triggerAddMarkers:function(e,r,t,a,n){var o=this;if(popManager.isHidden(a))o.pendingTriggerMap("addmarkers",e,r,t,a,n);else{var i=n.reload&&n.isFirst;o.addMarkers(e,r,t,a,i)}},triggerFunction:function(e,r,t,a,n,o){var i=this;"showmap"==e?i.triggerShowMap(r,t,a,n):"addmarkers"==e&&i.triggerAddMarkers(r,t,a,n,o)},pendingTriggerMap:function(r,t,a,n,o,i){var s=this,m=popManager.getPageSectionPage(n);popPageSectionManager.execIsHidden(a)?popPageSectionManager.getGroup(a).one("on.bs.pagesection-group:pagesection-"+a.attr("id")+":opened",function(){(n=e("#"+n.attr("id"))).length&&s.triggerFunction(r,t,a,n,o,i)}):o.parents(".collapse").not(".in").length?o.parents(".collapse").not(".in").one("shown.bs.collapse",function(){s.triggerFunction(r,t,a,n,o,i)}):m.hasClass("tab-pane")&&!popManager.isActive(m)&&m.one("shown.bs.tabpane",function(){s.triggerFunction(r,t,a,n,o,i)})},execTriggerShowMap:function(e,r,t,a){this.addMarkers(e,r,t,a,a.data("markers-removecurrent")),windowResize()},refresh:function(e,r,t){var a=this.getGMap(e,r,t);a&&a.refresh()},hoverBlockElems:function(r,t,a){var n=this;t.on("mouseenter",".pop-openmapmarkers",function(){var o,i=e(this);if(i.hasClass("make-popover")){var s=i.attr("aria-describedby");s&&(o=e("#"+s).find("a.pop-modalmap-link"))}else o=i.find("a.pop-modalmap-link");n.openMapMarkers(r,t,a,o)})},openMapMarkers:function(e,r,t,a){var n=this;popManager.isHidden(t)||(n.closeMarkers(e,r,t),a.length&&n.openMarkers(e,r,t,a))},closeMarkers:function(r,t,a){var n=this,o=n.getGMap(r,t,a);if(o){var i=n.getMarkersInfo(r,t,a);o.hideInfoWindows(),e.each(i.markersOpen,function(e,r){markerPos=i.markersPos[r],o.markers[markerPos]&&o.markers[markerPos].setIcon("https://maps.google.com/mapfiles/ms/icons/red-dot.png")})}},getMarkerIdsFromLinkURLs:function(r){var t=[];return r.each(function(){var r=e(this),a=(r=popManager.getOriginalLink(r)).attr("href"),n=getParam(M.LOCATIONSID_FIELDNAME,a);n&&e.each(n,function(e,r){t.push(r)})}),t},openMarkers:function(r,t,a,n){var o=this,i=o.getMarkerIdsFromLinkURLs(n);if(i.length){i=i.filter(function(e,r){return i.indexOf(e)==r});var s=o.getGMap(r,t,a);if(s){var m=o.getMarkersInfo(r,t,a);e.each(i,function(e,r){markerPos=m.markersPos[r],s.markers[markerPos]&&s.markers[markerPos].setIcon("https://maps.google.com/mapfiles/ms/icons/green-dot.png")}),1==i.length?(markerPos=m.markersPos[i[0]],s.markers[markerPos]&&"undefined"!=typeof google&&google.maps.event.trigger(s.markers[markerPos],"click")):s.fitZoom(),o.setMarkersOpen(r,t,a,i,!0)}}},initMarker:function(e,r,t,a){var n=this.getRuntimeMemoryPage(e,r),o=n.markers[t];if(o){if(o.title.split(" | ").indexOf(a.title)>-1)return;a.title=o.title+" | "+a.title,a.infoWindow.content=a.infoWindow.content+"<hr/>"+o.infoWindow.content,a.icon="https://maps.google.com/mapfiles/ms/icons/red-dot.png"}n.markers[t]=a},hasMarker:function(e,r,t){return this.getRuntimeMemoryPage(e,r).markers[t]},getGMap:function(e,r,t){var a=this;if("undefined"!=typeof google&&"undefined"!=typeof GMaps){var n=a.getRuntimeMemoryPage(e,r),o=t.attr("id"),i=n.maps[o];return i||(i=n.maps[o]=new GMaps({div:"#"+o,lat:M.LOCATIONSMAP_LAT,lng:M.LOCATIONSMAP_LNG,zoom:parseInt(M.LOCATIONSMAP_ZOOM)})),i}},getMarkersInfo:function(e,r,t){var a=this,n=t.data("markers-pagesection")||e,o=t.data("markers-block")||r,i=a.getEmtpyBlockRuntimeMemory();try{i=a.getRuntimeMemoryPage(n,o)}catch(e){console.log("Error: "+e.message)}var s=t.attr("id");return{markers:i.markers||{},markersPos:i.markersPos[s]||{},markersOpen:i.markersOpen[s]||[]}},setMarkersOpen:function(e,r,t,a,n){var o=this.getRuntimeMemoryPage(e,r),i=t.attr("id");!n&&o.markersOpen[i]||(o.markersOpen[i]=[]),a&&(o.markersOpen[i]=o.markersOpen[i].concat(a))},setMarkersPos:function(r,t,a,n,o){var i=this.getRuntimeMemoryPage(r,t),s=a.attr("id");!o&&i.markersPos[s]||(i.markersPos[s]={}),n&&e.extend(i.markersPos[s],n)},removeMarker:function(e,r,t,a){var n=this,o=n.getGMap(e,r,t);if(o){var i=n.getMarkersInfo(e,r,t);markerPos=i.markersPos[a],o.markers[markerPos]&&o.markers[markerPos].setMap(null),n.zoom(e,r,t)}},zoom:function(e,r,t){var a=this.getGMap(e,r,t);if(a)if(a.markers.length>1)a.fitZoom();else if(1==a.markers.length){var n=a.markers[0].getPosition();a.setCenter(n.lat(),n.lng()),a.setZoom(parseInt(M.LOCATIONSMAP_1MARKER_ZOOM))}},addMarkers:function(r,t,a,n,o){var i=this,s=i.getGMap(t,a,n);if(s){o&&(s.removeMarkers(),i.setMarkersOpen(t,a,n,null,!0),i.setMarkersPos(t,a,n,null,!0));var m=n.data("marker-ids-"+removeScheme(r));if(m&&m.length){n.data("marker-ids-"+removeScheme(r),null);var g,p,c,M=i.getMarkersInfo(t,a,n),k={};e.each(m,function(e,r){if(g=M.markers[r]){var t={content:g.infoWindow.header+"<br/>"+g.infoWindow.content},a={lat:g.coordinates.lat,lng:g.coordinates.lng,title:g.title,infoWindow:t,icon:g.icon};"undefined"!=typeof google&&(a.animation=google.maps.Animation.DROP),p=s.addMarker(a),c=s.markers.length-1,k[r]=c}}),i.setMarkersPos(t,a,n,k);var d=n.data("open-onemarker-infowindow");1==m.length&&d&&(s.hideInfoWindows(),"undefined"!=typeof google&&google.maps.event.trigger(p,"click")),i.zoom(t,a,n)}}},geocode:function(e,r,t,a,n,o){var i=this.getGMap(e,r,t);i&&GMaps.geocode({address:a,callback:function(e,r){if("OK"==r){i.removeMarkers();var t=e[0].geometry.location;i.setCenter(t.lat(),t.lng()),i.addMarker({lat:t.lat(),lng:t.lng(),draggable:!0}),i.setZoom(parseInt(M.LOCATIONSMAP_1MARKER_ZOOM)),n.val(t.lat()),o.val(t.lng());var a=i.markers[0];"undefined"!=typeof google&&google.maps.event.addListener(a,"dragend",function(){var e=a.getPosition();n.val(e.lat()),o.val(e.lng())})}}})}}}(jQuery),function(e){popMapRuntime={initBlockRuntimeMemory:function(e){var r=this,t=e.pageSection,a=e.block;e.runtimeMempage.mapRuntime={},r.resetBlockRuntimeMemory(t,a)},getRuntimeMemoryPage:function(e,r){return popManager.getRuntimeMemoryPage(e,r).mapRuntime},resetBlockRuntimeMemory:function(r,t){var a=this.getRuntimeMemoryPage(r,t),n={content:"",title:"",marker_ids:[]};e.extend(a,n)},drawMarkers:function(e,r,t,a){var n=this;popManager.jsInitialized(t)?n.execDrawMarkers(e,r,t,a):t.one("initialize",function(){n.execDrawMarkers(e,r,t,a)})},execDrawMarkers:function(e,r,t,a){var n=this.getRuntimeMemoryPage(r,t);a.data("marker-ids-"+removeScheme(e),n.marker_ids)},resetMarkerIds:function(e,r){var t=this;popManager.jsInitialized(r)?t.execResetMarkerIds(e,r):r.one("initialize",function(){t.execResetMarkerIds(e,r)})},execResetMarkerIds:function(e,r){this.getRuntimeMemoryPage(e,r).marker_ids=[]},setMarkerData:function(e,r,t,a){var n=this;popManager.jsInitialized(r)?n.execSetMarkerData(e,r,t,a):r.one("initialize",function(){n.execSetMarkerData(e,r,t,a)})},execSetMarkerData:function(e,r,t,a){var n=this.getRuntimeMemoryPage(e,r);n.title||(n.title=t),n.content||(n.content=a)},initMarker:function(e,r,t,a,n,o,i){var s=this;popManager.jsInitialized(r)?s.execInitMarker(e,r,t,a,n,o,i):r.one("initialize",function(){s.execInitMarker(e,r,t,a,n,o,i)})},execInitMarker:function(e,r,t,a,n,o,i){var s=this,m=s.getRuntimeMemoryPage(e,r);s.setMarkerData(e,r,o,i);var g=m.title,p={coordinates:{lat:a,lng:n},title:g,infoWindow:{header:"<strong>"+g+"</strong>",content:m.content},icon:"https://maps.google.com/mapfiles/ms/icons/red-dot.png"};m.marker_ids.push(t),popMap.initMarker(e,r,t,p),m.content="",m.title=""}}}(jQuery),popJSLibraryManager.register(popMap,["initBlockRuntimeMemory","map","mapModal","mapStandalone"]),popJSLibraryManager.register(popMapRuntime,["initBlockRuntimeMemory"]);