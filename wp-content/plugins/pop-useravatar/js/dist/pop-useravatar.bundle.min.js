!function(e){popFileUpload={fileUpload:function(a){var l=a.pageSection,o=a.targets;o.each(function(){var a=this,o=e(this),p=o.data("action"),t=popManager.getBlock(o);o.fileupload({url:p,autoUpload:!0,maxNumberOfFiles:1,maxFileSize:2e6,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:function(a){var l=o.data("template-upload"),p=e(),d={o:a,locale:locale};popJSRuntimeManager.setBlockURL(t.data("toplevel-url"));var n=popManager.getHtml(l,d),i=e(n);return p=p.add(i)},downloadTemplate:function(a){var p=o.data("template-download"),d=e(),n=popManager.getTargetConfiguration(l,t,p);popManager.expandJSKeys(n);var i=e.extend({},n,{o:a,locale:locale});popJSRuntimeManager.setBlockURL(t.data("toplevel-url"));var r=popManager.getHtml(p,i),u=e(r);return e(document).triggerHandler("gd-fileupload:rendered",[u]),d=d.add(u)},completed:function(e,a){o.find(".pop-fileuploaded-hide").hide()},destroyed:function(e,a){o.find(".pop-fileuploaded-hide").show()}}),o.hasClass("pop-fileupload-loadfromserver")&&e.getJSON(p,function(l){l&&l.files&&l.files.length&&o.fileupload("option","done").call(a,e.Event("done"),{result:l})})})}}}(jQuery),popJSLibraryManager.register(popFileUpload,["fileUpload"]);